
$(function ()
{
    //Number Only
    number_only();

    //Charactor Only
    charactor_only();

    //Only Char,Numbers and Space
    alphanumeric();

    //DisableCutCopyPaste();
    DisableAutoComplete();
});

//function DisableCutCopyPaste()
//{
//    if (!window.jQuery)
//    {
//        var inputElements = document.getElementsByTagName('input');
//        for (var i = 0; i < inputElements.length; i++)
//        {
//            if (!inputElements[i].classList.contains('enablecutcopypaste'))
//            {
//                if (inputElements[i].type == 'text' || inputElements[i].type == 'password')
//                {
//                    inputElements[i].oncopy = function () { return false; };
//                    inputElements[i].oncut = function () { return false; };
//                    inputElements[i].onpaste = function () { return false; };
//                }
//            }
//        }
//    } else
//    {
//        $('input[type=text],input[type=password]').on("cut copy paste", function (e)
//        {
//            if (!$(this).hasClass('enablecutcopypaste'))
//            {
//                e.preventDefault();
//            }
//        });
//    }
//}

//function DisableAutoComplete()
//{
//    if (!window.jQuery)
//    {
//        var inputElements = document.getElementsByTagName('input');
//        for (var i = 0; i < inputElements.length; i++)
//        {
//            if (inputElements[i].type == 'text' || inputElements[i].type == 'password')
//            {
//                inputElements[i].autocomplete = "off";
//            }
//        }
//    } else
//    {
//        $('input[type=text],input[type=password]').attr("autocomplete", "off");
//    }
//}

function charactor_only()
{
    $('.charactor_only').on("input", function ()
    {
        var regexp = /[^a-zA-Z\' \b]/g;
        if ($(this).val().match(regexp))
        {
            $(this).val($(this).val().replace(regexp, ''));
        }
    });
    $(".charactor_only").css("text-transform", "uppercase");


}

function alphanumeric()
{
    $('.alphanumeric').on("input", function ()
    {
        var regexp = /^[0-9a-zA-Z\s]+$/g;
        if ($(this).val().match(regexp))
        {
            $(this).val($(this).val().replace(regexp, ''));
        }
    });
    $(".charactor_only").css("text-transform", "uppercase");


}

function number_only()
{
    $('.number_only,.jq-dte-day,.jq-dte-month,.jq-dte-year').on("input", function ()
    {
        var regexp = /[^0-9]/g;
        if ($(this).val().match(regexp))
        {
            $(this).val($(this).val().replace(regexp, ''));
        }
    });
}


$('#lnkCMSBranchSearch').click(function ()
{
    Agency_CMS_Exc_Get_State();


});

$('#ddlState').change(function ()
{
    Agency_Get_Exc_mapped_CMSBank_Lnk();
});

//$('#ddlEXCCMSBranch').change(function ()
//{
//    $('#hdnEXCCMSbankCode').val($('#ddlEXCCMSBranch').val()).change();
//    $('#txtEXCCMSbankName').val($('#ddlEXCCMSBranch :Selected').text());
//    $('#ModelCMSBranchClose').click();
//    $('#ddlState').val('select');
//    $('#ddlEXCCMSBranch').val('select');
//    $('#modellblErrormsg').text('');
//});

function Agency_CMS_Exc_Get_State()
{
    $('#modellblErrormsg').text('');
    ExtendedAjaxCall('CMS/Agency_CMS_Exc_Get_State', null, 'GET', function (result)
    {

        var html = '<option value="select">Select</option>'
        if (!$.isEmptyObject(result))
        {
            $.each(result, function (i, row)
            {
                html += "<option value='" + row['Code'] + "' >" + row['Desc'] + "</option>";
            });
        }

        $('#ddlState').html(html).change();
    }, null, null, false, false, ErrorFunction);
}

function Agency_Get_Exc_mapped_CMSBank_Lnk()
{
    $('#modellblErrormsg').text('');
    ExtendedAjaxCall('CMS/Agency_Get_Exc_mapped_CMSBank_Lnk/' + $('#ddlState').val(), null, 'GET', function (result)
    {
        //var html = '<option value="select">Select</option>'
        //if (!$.isEmptyObject(result))
        //{
        //    $.each(result, function (i, row)
        //    {
        //        html += "<option value='" + row['code'] + "' >" + row['desc'] + "</option>";
        //    });
        //}
        //$('#ddlEXCCMSBranch').html(html);

        var html = ''
        if (!$.isEmptyObject(result))
        {
            $.each(result, function (i, row)
            {
                html += '<tr>';
                html += '<td ><input type="radio" id="rdoCMS" onclick="rdoCMS_select(this)" name="CMS" value="' + row['code'] + '"  /> </td>';
                html += '<td >' + row['desc'] + '</td>';
                html += '<td >' + row['Address'] + '</td>';
                html += '</tr>';
            });
        }
        $('#tblCMSBranch tbody').html(html);
    }, null, null, false, false, ErrorFunction);
}

function rdoCMS_select(btn)
{

    var code = $(btn).val();
    var name = $($(btn).closest('tr').find('td')[1]).text();
    if ($("#ddlCMSBranch option[value='" + code + "']").length != 0)
    {
        // it exists!
        $('#ddlCMSBranch').val(code).change();
    }
    else
    {
        var html = '<option value="' + code + '">' + name + '</option>';
        $('#ddlCMSBranch').append(html).val(code).change();
    }
    //$('#ModelCMSBranchClose').click();
    $('#ModelCMSBranchSearch').modal('hide');
    $('#ddlState').val('select').change();
    $('#ddlEXCCMSBranch').val('select');
    $('#modellblErrormsg').text('');
};
//$(document).ready(function () {
//    //Bank Details autocomplete:
//    AutoCompleteBankDetails('txtSearchBank', 'txtMICRCode', 'txtNEFTCode', 'txtBankName', 'txtBranchName');//Repayment Bank Details
//    AutoCompleteBankDetails('txtInvDrawn_Bank_Search', 'txtInvBank_MICR', 'txtInvBank_NEFT', 'txtInvDrawn_Bank_Name', 'txtInvBank_Branch_Name');//Repayment Bank Details

//});

$('#txtInvDrawn_Bank_Search').autocomplete({
    minLength: 3,
    source: function (request, response) 
    {
        ExtendedAjaxCall("BankDetails/Get_BankDtls/" + $('#txtInvDrawn_Bank_Search').val(), null, 'GET', function (data)
        {
            try
            {
                if (!$.isEmptyObject(data))
                {
                    response($.map(data, function (item)
                    {
                        return {
                            label: item.LABEL,
                            value: item.LABEL,
                            micrcode: item.MICR_CODE,
                            bankname: item.BANK_NAME,
                            bankbranch: item.BANK_BRANCH,
                            neftcode: item.NEFT_CODE
                        }
                    }));
                }
                else
                {
                    response([{ label: 'No Record Found !!', value: '' }]);
                }
            } catch (e)
            {
                fnException(e);
            }
        }, function ()
        {
            $('#preloader').hide();
        }, null, true, false, ErrorFunction);

    },
    select: function (event, ui)
    {
        if (ui.item.value == '' || ui.item.value == 'No Record Found !!')
        {
            $('#hdnBank_MICR').val('');
            $('#hdnBank_NEFT').val('');
            $('#hdnDrawn_Bank_Name').val('');
            $('#hdnBank_Branch_Name').val('');
            $(this).val("");
            return false;
        } else
        {
            $('#txtInvDrawn_Bank_Search').val('');
            $('#hdnBank_MICR').val(ui.item.micrcode);
            $('#hdnBank_NEFT').val(ui.item.neftcode);
            $('#hdnDrawn_Bank_Name').val(ui.item.bankname);
            $('#hdnBank_Branch_Name').val(ui.item.bankbranch);
            $(this).val("");
        }
    },
    focus: function (event, ui)
    {
        event.preventDefault();
    }
});

$('#txtSearchBank').autocomplete({
    minLength: 3,
    source: function (request, response) 
    {
        ExtendedAjaxCall("BankDetails/Get_BankDtls/" + $('#txtSearchBank').val(), null, 'GET', function (data)
        {
            try
            {
                if (!$.isEmptyObject(data))
                {
                    response($.map(data, function (item)
                    {
                        return {
                            label: item.LABEL,
                            value: item.BANK_NAME,
                            micrcode: item.MICR_CODE,
                            bankname: item.BANK_NAME,
                            bankbranch: item.BANK_BRANCH,
                            neftcode: item.NEFT_CODE
                        }
                    }));
                }
                else
                {
                    response([{ label: 'No Record Found !!', value: '' }]);
                }
            } catch (e)
            {
                fnException(e);
            }
        }, function ()
        {
            $('#preloader').hide();
        }, null, true, false, ErrorFunction);

    },
    select: function (event, ui)
    {
        if (ui.item.value == '' || ui.item.value == 'No Record Found !!')
        {
            $('#txtMICRCode').val('');
            $('#txtNEFTCode').val('');
            $('#txtBankName').val('');
            $('#txtBranchName').val('');
            $('#txtBankAccountNo').val('');
            $('#txtConfirmBankAccountNo').val('');
            $(this).val("");
            return false;
        } else
        {
            $('#txtSearchBank').val('');
            $('#txtMICRCode').val(ui.item.micrcode);
            $('#txtNEFTCode').val(ui.item.neftcode);
            $('#txtBankName').val(ui.item.bankname);
            $('#txtBranchName').val(ui.item.bankbranch);
            $('#txtBankAccountNo').val('');
            $('#txtConfirmBankAccountNo').val('');
            $(this).val(""); 
            $('#DV_OR_ADD_NEW').show();
            
        }
    },
    focus: function (event, ui)
    {
        event.preventDefault();
    }
});






//globle object to store application data
var BTP_OBJECT = null;
//globle object to store application data
const BTP = function () {
    this.IND_NIND = 'IND'; //DepositorStatus
    this.appl_no = '';
    this.appl_dec_type = '';
    this.payment_mode = '';

    this.FH_DATA_SOURCE = 'FRESH';
    this.SH_DATA_SOURCE = 'FRESH';
    this.TH_DATA_SOURCE = 'FRESH';

    this.FH_CKYC_COMPLIANT = 'N';
    this.SH_CKYC_COMPLIANT = 'N';
    this.TH_CKYC_COMPLIANT = 'N';

    this.mode = 'A';//to disable alert popup on reset
    this.ApplicationType = 'F';

    //Diff between last FDR and currect date
    this.InvCountFolioYear = 4;
    this.SHCountFolioYear = 4;
    this.THCountFolioYear = 4;

    this.FrontOfficeSave = false;
    this.OtherDetailsSave = false;
    this.InvestmentDetailsSave = false;
    this.BankDetailsSave = false;
    this.FHDetailsSave = false;
    this.SHDetailsSave = false;
    this.THDetailsSave = false;
    this.NomDetailsSave = false;
    this.OVDSave = false;

    this.IsProvBank = false;

}
//diable F5 
//const disableF5 = function (e) {
//    if (e.target.type == 'text') {
//        if (e.which == 32 && e.target.selectionStart === 0)
//            return false;
//        return true;
//    }

//    if (e.target.type == 'textarea') {
//        if (e.which == 32 && e.target.selectionStart === 0)
//            return false;
//        return true;
//    }

//    if ((e.which || e.keyCode) == 116 || (e.which || e.keyCode) == 82) {
//        e.preventDefault();
//        alert('This operation is not allowed !!');
//    }
//}
function disableF5(e) {
    if (e.target.type == 'text') {
        if (e.which == 32 && e.target.selectionStart === 0)
            return false;
        return true;
    }

    if (e.target.type == 'textarea') {
        if (e.which == 32 && e.target.selectionStart === 0)
            return false;
        return true;
    }

    if ((e.which || e.keyCode) == 116 || (e.which || e.keyCode) == 82) {
        e.preventDefault();
        alert('This operation is not allowed !!');
    }
}

const BindDDLExtendedAjaxCall = function (dropDownId, sUrLWcfMethod, sParam, type, successCallBack, beforeSendCall, completeCall, IsAsync, IsTokenRequired, errorCallBack, dataType) {

    if ($.isEmptyObject(successCallBack)) {
        successCallBack = function (result) {

            try {
                var html = '<option value="select">Select</option>';
                if (!$.isEmptyObject(result) && result.length > 0) {
                    for (var i = 0; i < result.length; i++) {
                        html += '<option value="' + result[i].Code + '">' + result[i].Desc + '</option>';
                    }
                }

                $(dropDownId).empty().append(html);
                $('#preloader').hide();

            } catch (e) {
                $('#preloader').hide();
                fnException(e);
            }
        }
    }

    ExtendedAjaxCall(sUrLWcfMethod, sParam, type, successCallBack, beforeSendCall, completeCall, IsAsync, IsTokenRequired, errorCallBack, dataType);

}
const ErrorFunction = function (jqXHR, textStatus, err) {
    OnError(jqXHR, textStatus, err);

    if (jqXHR.status == 500) {
        jqXHR.abort();
        $('#dvErrorMsg').html("<p>An error occurred while processing your request. Please try again.</p>");
        $('#ModelError').modal('show');
    }

    if (jqXHR.status == 408) {
        jqXHR.abort();

        $('#dvErrorMsg').html("<p>Looks like the server is taking to long to respond. Please try again.</p>");
        $('#ModelError').modal('show');
    }

    return false;
}
//Dropdown bind (Code,Dec)
const BindDropdown1 = function (id, result) {
    try {
        var DDL = $('#' + id);
        var html = '<option value="select">Select</option>';

        if (!$.isEmptyObject(result) && result.length > 0) {

            for (var i = 0; i < result.length; i++) {
                html += '<option value="' + result[i].code + '">' + result[i].dec + '</option>';
            }
        }

        DDL.empty().append(html).change();

    } catch (e) {
        fnException(e);
    }
}
//Dropdown bind (Code,Name)
const BindDropdown2 = function (id, result) {
    try {

        var DDL = $('#' + id);
        var html = '<option value="select">Select</option>';

        if (!$.isEmptyObject(result) && result.length > 0) {
            for (var i = 0; i < result.length; i++) {
                html += '<option value="' + result[i].Code + '">' + result[i].Name + '</option>';
            }
        }

        DDL.empty().append(html).change();

    } catch (e) {
        fnException(e);
    }
}
const fnException = function (ex) {
    $('#preloader').hide();
    BtpMessagePopup('', 'error');
    throw ex;
}
//Default country India
const SetDefaultCountry = function (Id) {
    $('#' + Id).val('IN').change();
    return false;
}
//Error or Success modal popup
const BtpMessagePopup = function (message, type) {
    try {
        $('#preloader').hide();
        if (type.toUpperCase() == 'SUCCESS') {
            $('#dvSuccessMsg').html(message);
            $('#ModelSuccess').modal('show');
        }
        else if (type.toUpperCase() == 'ERROR') {
            message = $.isEmptyObject(message) || message.toUpperCase() == 'ERROR' ? '<p>Something went wrong..!</p>' : message;
            $('#dvErrorMsg').html(message);
            $('#ModelError').modal('show');
        }

    } catch (e) {
        console.error(e);
    }
}
//Minor check
const IsMinor = function (date) {
    try {

        if (!$.isEmptyObject(date)) {
            //var splinombirth = date.toString().split('-');
            //date = splinombirth[2] + '-' + splinombirth[1] + '-' + splinombirth[0];           
            return GetAge(date) < 18 ? true : false;
        }

    } catch (e) {
        fnException(e);
    }
}
const IsValidPAN = function (pan) {
    var regex = /[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
    return regex.test(pan.toUpperCase());
}
const IsValidMobile = function (mobile_no) {
    var regex = /^[6789]\d{9}$/;
    return regex.test(mobile_no);
}
const IsValidEmail = function (email) {
    var regex = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
    return regex.test(email);
}
const GetAge = function (date) {
    try {

        if (!$.isEmptyObject(date)) {
            var splitbirth = date.toString().split('-');
            var birthdate = new Date(Number(splitbirth[0]), (Number(splitbirth[1]) - 1), Number(splitbirth[2]));
            var currdate = new Date();
            var age = currdate.getFullYear() - birthdate.getFullYear();
            var age_month = currdate.getMonth() - birthdate.getMonth();
            var age_day = currdate.getDate() - birthdate.getDate();
            if (age_month < 0 || (age_month == 0 && age_day < 0)) {
                age = parseInt(age) - 1;
            }
            return age;
        }
    } catch (e) {
        fnException(e);
    }
}
const GetFormatedDate = function (date_str) {
    try {

        if (!$.isEmptyObject(date_str)) {
            var date = date_str.split(' ')[0].split('/');
            var dd = date[1];
            if (Number(dd) < 10) {
                dd = '0' + dd;
            }
            var mm = date[0];
            if (Number(mm) < 10) {
                mm = '0' + mm
            }
            return date[2] + '-' + mm + '-' + dd;
        }
        return null;

    } catch (e) {
        fnException(e);
    }
}
const convertNumberToWords = function (amount) {
    try {

        var words = new Array();
        words[0] = '';
        words[1] = 'One';
        words[2] = 'Two';
        words[3] = 'Three';
        words[4] = 'Four';
        words[5] = 'Five';
        words[6] = 'Six';
        words[7] = 'Seven';
        words[8] = 'Eight';
        words[9] = 'Nine';
        words[10] = 'Ten';
        words[11] = 'Eleven';
        words[12] = 'Twelve';
        words[13] = 'Thirteen';
        words[14] = 'Fourteen';
        words[15] = 'Fifteen';
        words[16] = 'Sixteen';
        words[17] = 'Seventeen';
        words[18] = 'Eighteen';
        words[19] = 'Nineteen';
        words[20] = 'Twenty';
        words[30] = 'Thirty';
        words[40] = 'Forty';
        words[50] = 'Fifty';
        words[60] = 'Sixty';
        words[70] = 'Seventy';
        words[80] = 'Eighty';
        words[90] = 'Ninety';
        amount = amount.toString();
        var atemp = amount.split(".");
        var number = atemp[0].split(",").join("");
        var n_length = number.length;
        var words_string = "";
        if (n_length <= 9) {
            var n_array = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
            var received_n_array = new Array();
            for (var i = 0; i < n_length; i++) {
                received_n_array[i] = number.substr(i, 1);
            }
            for (var i = 9 - n_length, j = 0; i < 9; i++ , j++) {
                n_array[i] = received_n_array[j];
            }
            for (var i = 0, j = 1; i < 9; i++ , j++) {
                if (i == 0 || i == 2 || i == 4 || i == 7) {
                    if (n_array[i] == 1) {
                        n_array[j] = 10 + parseInt(n_array[j]);
                        n_array[i] = 0;
                    }
                }
            }
            value = "";
            for (var i = 0; i < 9; i++) {
                if (i == 0 || i == 2 || i == 4 || i == 7) {
                    value = n_array[i] * 10;
                } else {
                    value = n_array[i];
                }
                if (value != 0) {
                    words_string += words[value] + " ";
                }
                if ((i == 1 && value != 0) || (i == 0 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Crores ";
                }
                if ((i == 3 && value != 0) || (i == 2 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Lakhs ";
                }
                if ((i == 5 && value != 0) || (i == 4 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Thousand ";
                }
                if (i == 6 && value != 0 && (n_array[i + 1] != 0 && n_array[i + 2] != 0)) {
                    words_string += "Hundred and ";
                } else if (i == 6 && value != 0) {
                    words_string += "Hundred ";
                }
            }
            words_string = words_string.split("  ").join(" ");
        }
        return words_string + " Rupees Only";

    } catch (e) {
        fnException(e);

    }
}
const ViewDocumentLog = function (DocumentLog) {
    try {

        ExtendedAjaxCall('DataEntry/ViewDocumentLogAsync', DocumentLog, 'POST', null, function (request) {
            //beforeSend function
        }, true, true, false, ErrorFunction);

    } catch (e) {
        $('#preloader').hide();
        console.error(e);
        BtpMessagePopup('', 'error');
    }
}
const CheckIsMinor = function (DOB) {
    if (!$.isEmptyObject(DOB)) {
        return GetAge(DOB) < 18 ? true : false;
    }
    return false;
}
const CheckIsMarried = function (status) {
    return status == '01' ? true : false;
}
//first holder ckyc validations
const FH_KYC_Validations = function () {
    try {
        let ddlInvtitle = $('#ddlInvtitle');
        let txtInvFirstName = $('#txtInvFirstName');
        let ddlGender = $('#DV_FH #ddlGender');
        let ddlOccupation = $('#DV_FH #ddlOccupation');
        let ddlAnnualIncome = $('#DV_FH #ddlAnnualIncome');
        let txtInvDOB = $('#txtInvDOB');
        let txtInvDOI = $('#txtInvDOI');
        let txtInvPan = $('#txtInvPan');
        let txtGuardianPAN = $('#DV_FH #txtGuardianPAN');
        let ddlGuardianTitle = $('#DV_FH #ddlGuardianTitle');

        //title  
        if (BTP_OBJECT.IND_NIND == 'IND') {
            if (ddlInvtitle.val() == 'select') {
                ddlInvtitle.prop('required', true).prop('disabled', false).addClass('DisabledControl');
            }
            else {
                ddlInvtitle.prop('required', true).prop('disabled', false).removeClass('DisabledControl');
            }
        }
        else
            ddlInvtitle.val("M/S").prop('required', true).prop('disabled', true).addClass('DisabledControl');

        //name
        if ($.isEmptyObject(txtInvFirstName.val())) {
            txtInvFirstName.prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#txtInvMiddleName,#txtInvLastName').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else
            $('#txtInvFirstName,#txtInvMiddleName,#txtInvLastName').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //gender
        if (ddlGender.val() == 'select') {
            ddlGender.prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            ddlGender.prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //dob
        if (BTP_OBJECT.IND_NIND == 'IND') {
            if ($.isEmptyObject(txtInvDOB.val())) {
                txtInvDOB.datetextentry('set_readonly', false);
                txtInvDOB.parent().addClass('InputBordeRed');
            }
            else {
                txtInvDOB.datetextentry('set_readonly', true);
                txtInvDOB.parent().removeClass('InputBordeRed');
            }
        }
        else {
            if ($.isEmptyObject(txtInvDOI.val())) {
                txtInvDOI.datetextentry('set_readonly', false);
                txtInvDOI.parent().addClass('InputBordeRed');
            }
            else {
                txtInvDOI.datetextentry('set_readonly', true);
                txtInvDOI.parent().removeClass('InputBordeRed');
            }
        }
        //else
        //{
        //    $('#txtInvDOB,#txtInvDOI').datetextentry('set_date', null).datetextentry('set_readonly', false);
        //}

        //pan
        if ($.isEmptyObject(txtInvPan.val()) && (!IsMinor(txtInvDOB.val()) || BTP_OBJECT.IND_NIND != 'IND'))
            txtInvPan.prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        else
            txtInvPan.prop('required', true).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        if (IsMinor(txtInvDOB.val()) && BTP_OBJECT.IND_NIND == 'IND') {
            //Guard pan 
            if ($.isEmptyObject(txtGuardianPAN.val())) {
                txtGuardianPAN.prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

                //Guard title 
                if ($.isEmptyObject(ddlGuardianTitle.val()))
                    ddlGuardianTitle.prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

                //Guard name 
                if ($.isEmptyObject($('#DV_FH #txtGuardianFName').val()))
                    $('#DV_FH #txtGuardianFName').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            }
            else
                txtGuardianPAN.prop('required', false).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //mobile/email validations
        if ($('#DV_FH #hdnMobilisationMode').val() == "W" || $('#DV_FH #hdnMobilisationMode').val() == "WEB") {
            //mobile
            if ($.isEmptyObject($('#txtMobile').val()))
                $('#txtMobile').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            else
                $('#txtMobile').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

            //email
            if ($.isEmptyObject($('#txtEmail').val()))
                $('#txtEmail').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            else
                $('#txtEmail').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        }
        else {
            $('#txtMobile').prop('disabled', false).removeClass('DisabledControl');
            $('#txtEmail').prop('disabled', false).removeClass('DisabledControl');
        }

        //either father/mother/spouse name is required
        if ($.isEmptyObject($('#DV_FH #txtFatherFName').val())
            && $.isEmptyObject($('#DV_FH #txtMotherFName').val())
            && $.isEmptyObject($('#DV_FH #txtSpouseFName').val())) {
            $('#DV_FH #ddlFatherTitle').val('MR').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_FH #ddlMotherTitle').val('MRS').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_FH #ddlSpouseTitle').val('select').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');
        }

        //ckyc no
        if ($.isEmptyObject($('#DV_FH #txtCKYCNumber').val()))
            $('#DV_FH #txtCKYCNumber').prop('disabled', false).removeClass('DisabledControl');
        else
            $('#DV_FH #txtCKYCNumber').prop('disabled', true).addClass('DisabledControl');

        //Occupation
        if (ddlOccupation.val() == 'select') {
            ddlOccupation.prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            ddlOccupation.prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //AnnualIncome
        if (ddlAnnualIncome.val() == 'select') {
            ddlAnnualIncome.prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            ddlAnnualIncome.prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent address1
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtAdd1').val())) {
            $('#DV_FH_P_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_FH_P_ADDR #txtAdd2,#DV_FH_P_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_FH_P_ADDR #ddlCountry').val() == 'select')
            $('#DV_FH_P_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent pincode
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtPin').val()))
            $('#DV_FH_P_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent city
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtCity').val()))
            $('#DV_FH_P_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent state/district
        if ($('#DV_FH_P_ADDR #ddlCountry').val() != 'IN') {
            if ($.isEmptyObject($('#DV_FH_P_ADDR #txtState').val()))
                $('#DV_FH_P_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_FH_P_ADDR #txtDistrict').val()))
                $('#DV_FH_P_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtAdd1').val())) {
            $('#DV_FH_M_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_FH_M_ADDR #txtAdd2,#DV_FH_M_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_FH_M_ADDR #ddlCountry').val() == 'select')
            $('#DV_FH_M_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing pincode
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtPin').val()))
            $('#DV_FH_M_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing city
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtCity').val()))
            $('#DV_FH_M_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        if ($('#DV_FH_M_ADDR #ddlCountry').val() != 'IN') {
            if ($.isEmptyObject($('#DV_FH_M_ADDR #txtState').val()))
                $('#DV_FH_M_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_FH_M_ADDR #txtDistrict').val()))
                $('#DV_FH_M_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

        //overseas address1
        if ($('#chkIdOverSeasAddress').prop('checked')) {
            if ($.isEmptyObject($('#txtOAdd1').val())) {
                $('#txtOAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
                $('#txtOAdd2,#txtOAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
            }

            //overseas country
            if ($('#ddlOCountry').val() == 'select')
                $('#ddlOCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            //overseas pincode
            if ($.isEmptyObject($('#txtOPin').val()))
                $('#txtOPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            //overseas city
            if ($.isEmptyObject($('#txtOCity').val()))
                $('#txtOCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#txtOState').val()))
                $('#txtOState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

    } catch (e) {
        fnException(e);
    }
}
//second holder ckyc validations
const SH_KYC_Validations = function () {
    try {
        //$('#DV_SH .HOLD_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        //$('#DV_SH .MORE_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //title  
        $('#DV_SH #ddlTitle').prop('required', true).prop('disabled', false).removeClass('DisabledControl');

        //name
        if ($.isEmptyObject($('#DV_SH #txtFName').val())) {
            $('#DV_SH #txtFName').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_SH #txtMName,#DV_SH #txtLName').val('').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else
            $('#DV_SH #txtFName,#DV_SH #txtMName,#DV_SH #txtLName').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //gender
        $('#DV_SH #ddlGender').prop('required', true).prop('disabled', false).removeClass('DisabledControl');

        //dob
        if ($.isEmptyObject($('#DV_SH #txtDOB').val())) {
            $('#DV_SH #txtDOB').datetextentry('set_readonly', false);
            $('#DV_SH #txtDOB').parent().addClass('InputBorderRed');
        }
        else {
            $('#DV_SH #txtDOB').datetextentry('set_readonly', true);
            $('#DV_SH #txtDOB').parent().removeClass('InputBorderRed');
        }

        //pan
        if ($.isEmptyObject($('#DV_SH #txtPAN').val()) && !IsMinor($('#DV_SH #txtDOB').val()))
            $('#DV_SH #txtPAN').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        else
            $('#DV_SH #txtPAN').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //Guard pan 
        if ($.isEmptyObject($('#DV_SH #txtGuardianPAN').val()) && IsMinor($('#DV_SH #txtDOB').val()))
            $('#DV_SH #txtGuardianPAN').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard title 
        if ($.isEmptyObject($('#DV_SH #ddlGuardianTitle').val()) && IsMinor($('#DV_SH #txtDOB').val()))
            $('#DV_SH #ddlGuardianTitle').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard name 
        if ($.isEmptyObject($('#DV_SH #txtGuardianFName').val()) && IsMinor($('#DV_SH #txtDOB').val()))
            $('#DV_SH #txtGuardianFName').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mobile
        if ($.isEmptyObject($('#DV_SH #txtMobileNo').val()))
            $('#DV_SH #txtMobileNo').prop('disabled', false).removeClass('DisabledControl');

        //email
        if ($.isEmptyObject($('#DV_SH #txtEmailId').val()))
            $('#DV_SH #txtEmailId').prop('disabled', false).removeClass('DisabledControl');

        //either father/mother/spouse name is required
        if ($.isEmptyObject($('#DV_SH #txtFatherFName').val())
            && $.isEmptyObject($('#DV_SH #txtMotherFName').val())
            && $.isEmptyObject($('#DV_SH #txtSpouseFName').val())) {
            $('#DV_SH #ddlFatherTitle').val('MR').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_SH #ddlMotherTitle').val('MRS').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_SH #ddlSpouseTitle').val('select').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');
        }

        //ckyc no
        if ($.isEmptyObject($('#DV_SH #txtCKYCNumber').val()))
            $('#DV_SH #txtCKYCNumber').prop('disabled', false).removeClass('DisabledControl');
        else
            $('#DV_SH #txtCKYCNumber').prop('disabled', true).addClass('DisabledControl');

        //Occupation
        if ($('#DV_SH #ddlOccupation').val() == 'select') {
            $('#DV_SH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            $('#DV_SH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //AnnualIncome
        if ($('#DV_SH #ddlAnnualIncome').val() == 'select') {
            $('#DV_SH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            $('#DV_SH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent address1
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtAdd1').val())) {
            $('#DV_SH_P_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_SH_P_ADDR #txtAdd2,#DV_SH_P_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_SH_P_ADDR #ddlCountry').val() == 'select')
            $('#DV_SH_P_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent pincode
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtPin').val()))
            $('#DV_SH_P_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent city
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtCity').val()))
            $('#DV_SH_P_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent state/district
        if ($('#DV_SH_P_ADDR #ddlCountry').val() != 'IN') {
            if ($.isEmptyObject($('#DV_SH_P_ADDR #txtState').val()))
                $('#DV_SH_P_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_SH_P_ADDR #txtDistrict').val()))
                $('#DV_SH_P_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtAdd1').val())) {
            $('#DV_SH_M_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_SH_M_ADDR #txtAdd2,#DV_SH_M_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_SH_M_ADDR #ddlCountry').val() == 'select')
            $('#DV_SH_M_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing pincode
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtPin').val()))
            $('#DV_SH_M_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing city
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtCity').val()))
            $('#DV_SH_M_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        if ($('#DV_SH_M_ADDR #ddlCountry').val() != 'IN') {
            if ($.isEmptyObject($('#DV_SH_M_ADDR #txtState').val()))
                $('#DV_SH_M_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_SH_M_ADDR #txtDistrict').val()))
                $('#DV_SH_M_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }


    } catch (e) {
        fnException(e);
    }
}
//third holder ckyc validations
const TH_KYC_Validations = function () {
    try {
        //$('#DV_TH .HOLD_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        //$('#DV_TH .MORE_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //title  
        $('#DV_TH #ddlTitle').prop('required', true).prop('disabled', false).removeClass('DisabledControl');

        //name
        if ($.isEmptyObject($('#DV_TH #txtFName').val())) {
            $('#DV_TH #txtFName').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_TH #txtMName,#DV_TH #txtLName').val('').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else
            $('#DV_TH #txtFName,#DV_TH #txtMName,#DV_TH #txtLName').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //gender
        $('#DV_TH #ddlGender').prop('required', true).prop('disabled', false).removeClass('DisabledControl');

        //dob
        if ($.isEmptyObject($('#DV_TH #txtDOB').val())) {
            $('#DV_TH #txtDOB').datetextentry('set_readonly', false);
            $('#DV_TH #txtDOB').parent().addClass('InputBorderRed');
        }
        else {
            $('#DV_TH #txtDOB').datetextentry('set_readonly', true);
            $('#DV_TH #txtDOB').parent().removeClass('InputBorderRed');
        }

        //pan
        if ($.isEmptyObject($('#DV_TH #txtPAN').val()) && !IsMinor($('#DV_TH #txtDOB').val()))
            $('#DV_TH #txtPAN').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        else
            $('#DV_TH #txtPAN').prop('required', true).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //Guard pan 
        if ($.isEmptyObject($('#DV_TH #txtGuardianPAN').val()) && IsMinor($('#DV_TH #txtDOB').val()))
            $('#DV_TH #txtGuardianPAN').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard title 
        if ($.isEmptyObject($('#DV_TH #ddlGuardianTitle').val()) && IsMinor($('#DV_TH #txtDOB').val()))
            $('#DV_TH #ddlGuardianTitle').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard name 
        if ($.isEmptyObject($('#DV_TH #txtGuardianFName').val()) && IsMinor($('#DV_TH #txtDOB').val()))
            $('#DV_TH #txtGuardianFName').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mobile
        if ($.isEmptyObject($('#DV_TH #txtMobileNo').val()))
            $('#DV_TH #txtMobileNo').prop('disabled', false).removeClass('DisabledControl');

        //email
        if ($.isEmptyObject($('#DV_TH #txtEmailId').val()))
            $('#DV_TH #txtEmailId').prop('disabled', false).removeClass('DisabledControl');

        //either father/mother/spouse name is required
        if ($.isEmptyObject($('#DV_TH #txtFatherFName').val())
            && $.isEmptyObject($('#DV_TH #txtMotherFName').val())
            && $.isEmptyObject($('#DV_TH #txtSpouseFName').val())) {
            $('#DV_TH #ddlFatherTitle').val('MR').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_TH #ddlMotherTitle').val('MRS').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_TH #ddlSpouseTitle').val('select').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');
        }

        //ckyc no
        if ($.isEmptyObject($('#DV_TH #txtCKYCNumber').val()))
            $('#DV_TH #txtCKYCNumber').prop('disabled', false).removeClass('DisabledControl');
        else
            $('#DV_TH #txtCKYCNumber').prop('disabled', true).addClass('DisabledControl');

        //Occupation
        if ($('#DV_TH #ddlOccupation').val() == 'select') {
            $('#DV_TH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            $('#DV_TH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //AnnualIncome
        if ($('#DV_TH #ddlAnnualIncome').val() == 'select') {
            $('#DV_TH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            $('#DV_TH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent address1
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtAdd1').val())) {
            $('#DV_TH_P_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_TH_P_ADDR #txtAdd2,#DV_TH_P_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_TH_P_ADDR #ddlCountry').val() == 'select')
            $('#DV_TH_P_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent pincode
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtPin').val()))
            $('#DV_TH_P_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent city
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtCity').val()))
            $('#DV_TH_P_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent state/district
        if ($('#DV_TH_P_ADDR #ddlCountry').val() != 'IN') {
            if ($.isEmptyObject($('#DV_TH_P_ADDR #txtState').val()))
                $('#DV_TH_P_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_TH_P_ADDR #txtDistrict').val()))
                $('#DV_TH_P_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtAdd1').val())) {
            $('#DV_TH_M_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_TH_M_ADDR #txtAdd2,#DV_TH_M_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_TH_M_ADDR #ddlCountry').val() == 'select')
            $('#DV_TH_M_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing pincode
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtPin').val()))
            $('#DV_TH_M_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing city
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtCity').val()))
            $('#DV_TH_M_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        if ($('#DV_TH_M_ADDR #ddlCountry').val() != 'IN') {
            if ($.isEmptyObject($('#DV_TH_M_ADDR #txtState').val()))
                $('#DV_TH_M_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_TH_M_ADDR #txtDistrict').val()))
                $('#DV_TH_M_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }


    } catch (e) {
        fnException(e);
    }
}

////--V2
//const GetAgeFromDate = () =>
//{
//    try
//    {

//        if (!$.isEmptyObject(this.value))
//        {
//            let splitbirth = date.toString().split('-');
//            let birthdate = new Date(Number(splitbirth[0]), (Number(splitbirth[1]) - 1), Number(splitbirth[2]));
//            let currdate = new Date();
//            let age = currdate.getFullYear() - birthdate.getFullYear();
//            let age_month = currdate.getMonth() - birthdate.getMonth();
//            let age_day = currdate.getDate() - birthdate.getDate();
//            if (age_month < 0 || (age_month == 0 && age_day < 0))
//            {
//                age = parseInt(age) - 1;
//            }
//            return age;
//        }
//    } catch (e)
//    {
//        fnException(e);
//    }
//}
//const IsMinorHolder = () =>
//{
//    try
//    {
//        if (!$.isEmptyObject(this.value))
//        {
//            let splinombirth = date.toString().split('-');
//            date = splinombirth[2] + '-' + splinombirth[1] + '-' + splinombirth[0];
//            return this.GetAgeFromDate() < 18 ? true : false;
//        }

//    } catch (e)
//    {
//        fnException(e);
//    }
//}

//remove red border
$('.form-control').change(function () {
    $(this).removeClass('InputBorderRed');
    $(this).parent().removeClass('InputBorderRed');
});
//PAN validations
$('input[name="PAN"]').keyup(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value) && !IsValidPAN(this.value)) {
        $(this).next().text('PAN is not valid').show();
    }
});
//Mobile no validations
$('input[name="MOBILE"]').keyup(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value) && !IsValidMobile(this.value)) {
        $(this).next().text('Mobile Number is not valid').show();
    }
});
//Email validations
$('input[name="EMAIL"]').keydown(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value) && !IsValidEmail(this.value)) {
        $(this).next().text('Email Id is not valid').show();
    }
});
//No special cha allowed except ( , # . / )
$('.NoSpecialChar').keydown(function (e) {
    var str = e.key;
    if (/^[a-zA-Z0-9-\' ]*$/.test(str) == false)
        return false;

    return true;
});
$('[name="ADD1"],[name="ADD2"],[name="ADD3"]').keyup(function () {
    //var regexpSpace = /[-]+$/g;
    //if ($(this).val().match(regexpSpace)) {
    //    $(this).val($(this).val().replace('-', ''));
    //    return false;
    //}

    //var regexp = /[^a-zA-Z0-9-.,/# ]/g;

    var regexp = /[^0-9a-zA-Z\s\,\.\-\#\/]+$/g;
    if ($(this).val().match(regexp)) {
        $(this).val($(this).val().replace(regexp, ''));
    }

});
//convert input into uppercase
$('.uppercase').keyup(function () {
    this.value = this.value.toUpperCase();
}).change(function () {
    this.value = this.value.toUpperCase();
});;
$('.RemoveSpace').keypress(function (e) {
    var v1 = $(this).val();
    v1 = v1.replace(/\s\s+/g, ' ');
    $(this).val(v1);

    var keyCode = e.keyCode == 0 ? e.charCode : e.keyCode;
    var ret = ((keyCode >= 48 && keyCode <= 57) || (keyCode >= 65 && keyCode <= 90) || (keyCode >= 97 && keyCode <= 122) || keyCode == 8 || keyCode == 32);
    return ret;

});


const FHReset = function ()
{
    $('.D_T_E').parent().removeClass('InputBorderRed');
    $('.errorbox').text('').hide();
    $('#DV_FH input[type="text"]').val('').removeClass('InputBorderRed');
    $('#DV_FH input[type="checkbox"]').prop('checked', false).removeClass('InputBorderRed');
    $('#DV_FH select').val('select').removeClass('InputBorderRed');

    $('#DV_FH #btnfreshcutomer').hide();
    $('#DV_FH_SEARCH').slideDown();
    $('#DV_FH_HEAD').hide();
    $('#DV_FH_DTLS').slideUp();
    $('#chkIsFHAddrSameAsPermanent').prop('checked', false);
}
const SHReset = function ()
{
    $('.D_T_E').parent().removeClass('InputBorderRed');
    $('.errorbox').text('').hide();
    $('#DV_SH input[type="text"]').val('').removeClass('InputBorderRed');
    $('#DV_SH input[type="checkbox"]').prop('checked', false).removeClass('InputBorderRed');
    $('#DV_SH select').val('select').removeClass('InputBorderRed');

    $('#DV_SH #btnfreshcutomer').hide();
    if (!$.isEmptyObject($('#lblFolioNumber').text()))
    {
        $('#DV_PROV_SH').show();
        $('#DV_SH_SEARCH').hide();
    }
    else
    {
        $('#DV_PROV_SH').hide();
        $('#DV_SH_SEARCH').show();
    }
    $('#DV_SH_CKYC_SEARCH').hide();
    $('#DV_SH_HEAD').hide();
    $('#DV_SH_DTLS').hide();
    $('.SHHeader').text('');
    $('#chkIsSHAddrSameAsPermanent').prop('checked', false);
    $('#DV_SH #ddlFatherTitle').val('MR');
    $('#DV_SH #ddlMotherTitle').val('MRS');
}
const THReset = function ()
{
    $('.D_T_E').parent().removeClass('InputBorderRed');
    $('.errorbox').text('').hide();
    $('#DV_TH input[type="text"]').val('').removeClass('InputBorderRed');
    $('#DV_TH input[type="checkbox"]').prop('checked', false).removeClass('InputBorderRed');
    $('#DV_TH select').val('select').removeClass('InputBorderRed');

    $('#DV_TH #btnfreshcutomer').hide();
    if (!$.isEmptyObject($('#lblFolioNumber').text()))
    {
        $('#DV_PROV_TH').show();
        $('#DV_TH_SEARCH').hide();
    }
    else
    {
        $('#DV_PROV_TH').hide();
        $('#DV_TH_SEARCH').show();
    }
    $('#DV_TH_CKYC_SEARCH').hide();
    $('#DV_TH_HEAD').hide();
    $('#DV_TH_DTLS').hide();
    $('.THHeader').text('');
    $('#chkIsTHAddrSameAsPermanent').prop('checked', false);
    $('#DV_TH #ddlFatherTitle').val('MR');
    $('#DV_TH #ddlMotherTitle').val('MRS');
}
//get Investor details for additional purchase
const InvSearch = function (Dep_Category, searchby, Searchbyref, SearchByDOB, Appl_No)
{
    BTP_OBJECT.mode = 'R';

    if (!$.isEmptyObject(Searchbyref))
    {
        let SearchBo = {
            HolderType: '01',
            searchby: searchby,
            Searchbyref: Searchbyref,
            SearchByDOB: SearchByDOB,
            Appl_No: Appl_No,
            Dep_Category: Dep_Category
        }

        ExtendedAjaxCall('AdditionalPurchase/SearchExistingCustomer', SearchBo, 'POST', function (result)
        {
            //default validations
            BTP_OBJECT.InvCountFolioYear = 4;
            BTP_OBJECT.ApplicationType = 'F';
            BTP_OBJECT.FH_CKYC_COMPLIANT = result[0].CKYC_Compliant;

            $('#chkIsFHAddrSameAsPermanent').prop('checked', false).prop('disabled', false);
            $('#chkIdOverSeasAddress').prop('checked', false).change();
            $('#DV_FH #ddlFatherTitle').val('MR');
            $('#DV_FH #ddlMotherTitle').val('MRS');

            if (!$.isEmptyObject(result) && result.length > 0 && result[0].Msg.toUpperCase() == 'SUCCESS')
            {
                //Application details
                BTP_OBJECT.FH_DATA_SOURCE = result[0].Source;
                BTP_OBJECT.ApplicationType = 'A';
                BTP_OBJECT.InvCountFolioYear = result[0].CountFolioYear;

                //header details
                $('#lblFolioNumber').text(result[0].Folio);
                $('#lblExistingFDRNumber').text(result[0].Dep_no);
                $('#lblLastInvestmentDate').text(result[0].Last_Inv_Date);

                //title
                $('#ddlInvtitle').val(result[0]["NamePrefix"]).change();

                //FH name
                $('#txtInvFirstName').val(result[0].Holder_F_Name).change();
                $('#txtInvMiddleName').val(result[0].Holder_M_Name).change();
                $('#txtInvLastName').val(result[0].Holder_L_Name).change();
                $('#lblInvestorName').text(result[0].Holder_Full_Name);

                //gender
                $('#DV_FH #ddlGender').val(result[0].Gender).change();

                //dob
                if (BTP_OBJECT.IND_NIND == 'IND')
                {
                    $('#txtInvDOB').datetextentry('set_date', result[0].DOB).datetextentry('set_readonly', true).focusout();
                    $('#lblDOB').text(result[0].Display_DOB);
                    //$('#txtInvDOB').blur();
                    InvDOB_Change();
                }
                else 
                {
                    $('#txtInvDOI').datetextentry('set_date', result[0].DOB).datetextentry('set_readonly', true);
                    $('#lblDOB').text(result[0].Display_DOB);
                }

                //pan
                $('#txtInvPan').val(result[0].PAN).change();
                $('#lblPAN').text(result[0].PAN);

                //mobile
                $('#txtMobile').val(result[0]["MOBILE_NO"]).change();
                $('#lblMobileNumber').text(result[0]["MOBILE_NO"]);

                //email
                $('#txtEmail').val(result[0]["EMAIL_ID"]).change();
                $('#lblEmailID').text(result[0]["EMAIL_ID"]);

                //tel no
                $('#DV_FH_P_ADDR #txtTelephone').val(result[0].TEL_RES);

                //maritalstatus
                $('#DV_FH #ddlMaritalStatus').val(result[0].MARITAL_STATUS);

                //father  name
                if (!$.isEmptyObject(result[0].Holder_Father_F_Name))
                {
                    $('#DV_FH #ddlFatherTitle').val(result[0].Holder_Father_Prefix);
                    $('#DV_FH #txtFatherFName').val(result[0].Holder_Father_F_Name);
                    $('#DV_FH #txtFatherMName').val(result[0].Holder_Father_M_Name);
                    $('#DV_FH #txtFatherLName').val(result[0].Holder_Father_L_Name);
                }

                //mother
                if (!$.isEmptyObject(result[0].Holder_Mother_F_Name))
                {
                    $('#DV_FH #ddlMotherTitle').val(result[0].Holder_Mother_Prefix);
                    $('#DV_FH #txtMotherFName').val(result[0].Holder_Mother_F_Name);
                    $('#DV_FH #txtMotherMName').val(result[0].Holder_Mother_M_Name);
                    $('#DV_FH #txtMotherLName').val(result[0].Holder_Mother_L_Name);
                }

                //spouse
                if (!$.isEmptyObject(result[0].Holder_Spouse_F_Name))
                {
                    $('#DV_FH #ddlSpouseTitle').val(result[0].Holder_Spouse_Prefix);
                    $('#DV_FH #txtSpouseFName').val(result[0].Holder_Spouse_F_Name);
                    $('#DV_FH #txtSpouseMName').val(result[0].Holder_Spouse_M_Name);
                    $('#DV_FH #txtSpouseLName').val(result[0].Holder_Spouse_L_Name);
                }

                //guardian
                if (!$.isEmptyObject(result[0].Holder_Guardian_F_Name))
                {
                    $('#DV_FH #ddlGuardianTitle').val(result[0].Holder_Guardian_Prefix);
                    $('#DV_FH #txtGuardianFName').val(result[0].Holder_Guardian_F_Name);
                    $('#DV_FH #txtGuardianMName').val(result[0].Holder_Guardian_M_Name);
                    $('#DV_FH #txtGuardianLName').val(result[0].Holder_Guardian_L_Name);
                    $('#DV_FH #txtGuardianPAN').val(result[0].Holder_Guardian_PAN);
                }

                //annual income
                $('#DV_FH #ddlAnnualIncome').val(result[0].ANNUAL_INC);

                //occupation type
                $('#DV_FH #ddlCustSegType').val(result[0].CustSeg_Type_Code);

                //avinash added Occupation / sub - occupation changes
                BindDDLExtendedAjaxCall('#ddlCustSegSubType', 'DataEntry/Get_ddl_Occ_CustSegSubTypeList', null, 'POST', null, null, true, false, false, ErrorFunction);
                if (!$.isEmptyObject(result[0].CustSeg_Subtype_Code)) {
                    $("#Occ_Cus_SegSubtype_Div").show();
                    $('#DV_FH #ddlCustSegSubType').val(result[0].CustSeg_Subtype_Code);
                }
                else {
                    $('#DV_FH #ddlCustSegType').val('select');
                    $("#Occ_Cus_SegSubtype_Div").hide();
                }

                //ckyc no
                $('#txtInvCKYCNumber').val(result[0].CKYCNumber);

                $('#DV_FH #hdnMobilisationMode').val(result[0].MobilisationMode);

                //PER
                if (!$.isEmptyObject(result[0].ADD1))
                {
                    $('#DV_FH_P_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                    $('#DV_FH_P_ADDR #txtAdd1').val(result[0].ADD1);
                    $('#DV_FH_P_ADDR #txtAdd2').val(result[0].ADD2);
                    $('#DV_FH_P_ADDR #txtAdd3').val(result[0].ADD3);
                    $('#DV_FH_P_ADDR #ddlCountry').val(result[0].CountryCode).change();
                    $('#DV_FH_P_ADDR #txtCity').val(result[0].CITY);
                    if (result[0].CountryCode == 'IN')
                    {
                        $('#DV_FH_P_ADDR #txtPin').val(result[0].PINCODE).keyup();
                    }
                    else
                    {
                        $('#DV_FH_P_ADDR #txtState').val(result[0].STATE);
                        $('#DV_FH_P_ADDR #txtDistrict').val(result[0].DISTRICT);
                        $('#DV_FH_P_ADDR #txtPin').val(result[0].PINCODE);
                    }
                }

                //Mailing
                if (!$.isEmptyObject(result[0].M_ADD1))
                {
                    $('#chkIsFHAddrSameAsPermanent').prop('disabled', true);
                    $('#DV_FH_M_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                    $('#DV_FH_M_ADDR #txtAdd1').val(result[0].M_ADD1);
                    $('#DV_FH_M_ADDR #txtAdd2').val(result[0].M_ADD2);
                    $('#DV_FH_M_ADDR #txtAdd3').val(result[0].M_ADD3);
                    $('#DV_FH_M_ADDR #ddlCountry').val(result[0].M_CountryCode).change();
                    $('#DV_FH_M_ADDR #txtCity').val(result[0].M_CITY);

                    if (result[0].M_CountryCode == 'IN')
                    {
                        $('#DV_FH_M_ADDR #txtPin').val(result[0].M_PINCODE).keyup();
                    }
                    else
                    {
                        $('#DV_FH_M_ADDR #txtState').val(result[0].M_STATE);
                        $('#DV_FH_M_ADDR #txtDistrict').val(result[0].M_DISTRICT);
                        $('#DV_FH_M_ADDR #txtPin').val(result[0].M_PINCODE);
                    }
                }

                //overseas address
                if (!$.isEmptyObject(result[0].O_ADD1))
                {
                    $('#chkIdOverSeasAddress').prop('checked', true).change();
                    $('.O_ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                    $('#txtOAdd1').val(result[0].O_ADD1);
                    $('#txtOAdd2').val(result[0].O_ADD2);
                    $('#txtOAdd3').val(result[0].O_ADD3);
                    $('#ddlOCountry').val(result[0].O_CountryCode).change();
                    $('#txtOState').val(result[0].O_STATE)
                    $('#txtOPin').val(result[0].O_PINCODE);
                    $('#txtOCity').val(result[0].O_CITY);
                }

                //ckyc validations
                FH_KYC_Validations();

                ////ovd validations
                //if (BTP_OBJECT.InvCountFolioYear > 3)
                //{
                //    alert("Entered FDR is 3 Years old so OVDs are mandatory else reject the application.")
                //}

                //validations
                $('#btnfreshcutomer').hide();
                $('#addfreshInv').hide();
                $('#IdInfoDiv').slideDown();
                $('#IdInvestorSearch').slideUp();
                $('#DV_FH_CKYC_SEARCH').hide();
                $('#DV_INV_DETAILS').show();
                $('#IdInvestorInfo').slideDown();
            }
            else if (!$.isEmptyObject(result) && result.length > 0 && !$.isEmptyObject(result[0].Msg))
            {

                let msg = '<p>' + result[0].Msg + '</p>';
                BtpMessagePopup(msg, "error");
                $('#btnfreshcutomer').show();
                $('#addfreshInv').show();
                $('#divGetDetails').hide();
            }
            else
            {
                BtpMessagePopup("<p>No Record Found</p>", "error");
                $('#btnfreshcutomer').show();
                $('#addfreshInv').show();
                $('#divGetDetails').hide();
            }

            $('#preloader').hide();
        }, null, true, false, false, ErrorFunction);
    }

    BTP_OBJECT.mode = 'R';
}
//get second holder details
const SHSearch = function (searchby, Searchbyref, SearchByDOB, Appl_No)
{
    BTP_OBJECT.mode = 'R';

    if (!$.isEmptyObject(Searchbyref))
    {

        var SearchBo = {
            HolderType: '02',
            searchby: searchby,
            Searchbyref: Searchbyref,
            SearchByDOB: SearchByDOB,
            Appl_No: Appl_No

        }

        ExtendedAjaxCall('AdditionalPurchase/SearchExistingCustomer', SearchBo, 'POST', function (result)
        {
            BTP_OBJECT.SHCountFolioYear = 4;

            $('#DV_SH_HEAD').hide();
            $('#DV_SH_DTLS').hide();
            $('.SHHeader').text('');
            $('#chkIsSHAddrSameAsPermanent').prop('checked', false).prop('disabled', false);
            $('#chkIsSHAddrSameAsFH').prop('checked', false).prop('disabled', false);
            $('#DV_SH #ddlFatherTitle').val('MR');
            $('#DV_SH #ddlMotherTitle').val('MRS');

            if (!$.isEmptyObject(result) && result.length > 0 && result[0].Msg.toUpperCase() == 'SUCCESS')
            {
                var row = result[0];
                $('#hdrSHFolioNo').text(row.Folio);
                $('#hdrSHExistingFDRNo').text(row.Dep_no);
                $('#hdrSHLastInvDate').text(row.Last_Inv_Date);
                BTP_OBJECT.SHCountFolioYear = row.CountFolioYear;
                BTP_OBJECT.SH_DATA_SOURCE = result[0].Source;
                BTP_OBJECT.SH_CKYC_COMPLIANT = result[0].CKYC_Compliant;

                //title
                $('#DV_SH #ddlTitle').val(result[0]["NamePrefix"]).change();

                //name
                $('#DV_SH #txtFName').val(result[0].Holder_F_Name).change();
                $('#DV_SH #txtMName').val(result[0].Holder_M_Name).change();
                $('#DV_SH #txtLName').val(result[0].Holder_L_Name).change();

                //gender
                $('#DV_SH #ddlGender').val(result[0].Gender).change();

                //dob
                $('#DV_SH #txtDOB').datetextentry('set_date', result[0].DOB).datetextentry('set_readonly', true).focusout();
                //$('#DV_SH #txtDOB').blur();
                SHDOBChange();

                //pan
                $('#DV_SH #txtPAN').val(result[0].PAN).change();

                //mobile
                $('#DV_SH_P_ADDR #txtMobileNo').val(result[0]["MOBILE_NO"]).change();

                //email
                $('#DV_SH_P_ADDR #txtEmailId').val(result[0]["EMAIL_ID"]).change();

                //tel no
                $('#DV_SH_P_ADDR #txtTelephone').val(result[0].TEL_RES);

                //maritalstatus
                $('#DV_SH_MD #ddlMaritalStatus').val(result[0].MARITAL_STATUS);

                //father name
                if (!$.isEmptyObject(result[0].Holder_Father_F_Name))
                {
                    $('#DV_SH #ddlFatherTitle').val(result[0].Holder_Father_Prefix);
                    $('#DV_SH #txtFatherFName').val(result[0].Holder_Father_F_Name);
                    $('#DV_SH #txtFatherMName').val(result[0].Holder_Father_M_Name);
                    $('#DV_SH #txtFatherLName').val(result[0].Holder_Father_L_Name);
                }

                //mother name
                if (!$.isEmptyObject(result[0].Holder_Mother_F_Name))
                {
                    $('#DV_SH #ddlMotherTitle').val(result[0].Holder_Mother_Prefix);
                    $('#DV_SH #txtMotherFName').val(result[0].Holder_Mother_F_Name);
                    $('#DV_SH #txtMotherMName').val(result[0].Holder_Mother_M_Name);
                    $('#DV_SH #txtMotherLName').val(result[0].Holder_Mother_L_Name);
                }

                //spouse name
                if (!$.isEmptyObject(result[0].Holder_Spouse_F_Name))
                {
                    $('#DV_SH #ddlSpouseTitle').val(result[0].Holder_Spouse_Prefix);
                    $('#DV_SH #txtSpouseFName').val(result[0].Holder_Spouse_F_Name);
                    $('#DV_SH #txtSpouseMName').val(result[0].Holder_Spouse_M_Name);
                    $('#DV_SH #txtSpouseLName').val(result[0].Holder_Spouse_L_Name);
                }

                //guardian name
                if (!$.isEmptyObject(result[0].Holder_Guardian_F_Name))
                {
                    $('#DV_SH #ddlGuardianTitle').val(result[0].Holder_Guardian_Prefix);
                    $('#DV_SH #txtGuardianFName').val(result[0].Holder_Guardian_F_Name);
                    $('#DV_SH #txtGuardianMName').val(result[0].Holder_Guardian_M_Name);
                    $('#DV_SH #txtGuardianLName').val(result[0].Holder_Guardian_L_Name);
                    $('#DV_SH #txtGuardianPAN').val(result[0].Holder_Guardian_PAN);
                }

                //annual income
                $('#DV_SH #ddlAnnualIncome').val(result[0].ANNUAL_INC);

                //occupation
                $('#DV_SH #ddlCustSegType').val(result[0].CustSeg_Type_Code);


                //avinash added Occupation / sub - occupation changes
                BindDDLExtendedAjaxCall('#DV_SH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);

                if ($('#HdnCustSeg_typeCode_SH').val() != "" && $('#HdnCustSeg_typeCode_SH').val() != undefined) {
                    $('#DV_SH #ddlCustSegType').val($('#HdnCustSeg_typeCode_SH').val());
                }
                else {
                    $('#DV_SH #ddlCustSegType').val('select');
                }

                $('#DV_SH #ddlCustSegType').val(result[0].CustSeg_Type_Code);

                if (!$.isEmptyObject(result[0].CustSeg_Subtype_Code)) {
                    $("#Occ_Cus_SegSubtype_Div").show();
                    $('#DV_SH #ddlCustSegSubType').val(result[0].CustSeg_Subtype_Code);
                }
                else {
                    $("#Occ_Cus_SegSubtype_Div").hide();
                }

                //ckyc no
                $('#DV_SH #txtCKYCNumber').val(result[0].CKYCNumber);

                $('#DV_SH #hdnMobilisationMode').val(result[0].MobilisationMode);

                //PER
                if (!$.isEmptyObject(result[0].ADD1))
                {
                    $('#DV_SH_P_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                    $('#chkIsSHAddrSameAsFH').prop('disabled', true);

                    $('#DV_SH_P_ADDR #txtAdd1').val(result[0].ADD1);
                    $('#DV_SH_P_ADDR #txtAdd2').val(result[0].ADD2);
                    $('#DV_SH_P_ADDR #txtAdd3').val(result[0].ADD3);
                    $('#DV_SH_P_ADDR #ddlCountry').val(result[0].CountryCode).change();
                    $('#DV_SH_P_ADDR #txtCity').val(result[0].CITY);
                    if (result[0].CountryCode == 'IN')
                    {
                        $('#DV_SH_P_ADDR #txtPin').val(result[0].PINCODE).keyup();
                    }
                    else
                    {
                        $('#DV_SH_P_ADDR #txtState').val(result[0].STATE);
                        $('#DV_SH_P_ADDR #txtDistrict').val(result[0].DISTRICT);
                        $('#DV_SH_P_ADDR #txtPin').val(result[0].PINCODE);
                    }
                }

                //Mailing
                if (!$.isEmptyObject(result[0].M_ADD1))
                {
                    $('#chkIsSHAddrSameAsPermanent').prop('disabled', true);
                    $('#DV_SH_M_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                    $('#DV_SH_M_ADDR #txtAdd1').val(result[0].M_ADD1);
                    $('#DV_SH_M_ADDR #txtAdd2').val(result[0].M_ADD2);
                    $('#DV_SH_M_ADDR #txtAdd3').val(result[0].M_ADD3);
                    $('#DV_SH_M_ADDR #ddlCountry').val(result[0].M_CountryCode).change();
                    $('#DV_SH_M_ADDR #txtCity').val(result[0].M_CITY);
                    if (result[0].M_CountryCode == 'IN')
                    {
                        $('#DV_SH_M_ADDR #txtPin').val(result[0].M_PINCODE).keyup();
                    }
                    else
                    {
                        $('#DV_SH_M_ADDR #txtState').val(result[0].M_STATE);
                        $('#DV_SH_M_ADDR #txtDistrict').val(result[0].M_DISTRICT);
                        $('#DV_SH_M_ADDR #txtPin').val(result[0].M_PINCODE);
                    }
                }

                //CKYC validations
                SH_KYC_Validations();

                //validations                
                $('#btnSHAddFresh').hide();
                $('#DV_SH_SEARCH').hide();
                $('#DV_SH_CKYC_SEARCH').hide();
                if ($('#ddlHolderType').val() == '02')
                {
                    $('#DV_SH_HEAD').show();
                }
                $('#DV_SH_DTLS').slideDown();
            }
            else
            {
                $('#DV_SH_HEAD').hide();
                $('#DV_SH #btnfreshcutomer').show();

                BtpMessagePopup('No Record Found. Please Continue as Fresh Holder.', 'error');
            }
        }, null, null, false, false, ErrorFunction);

    }
    else
    {
        $('#DV_SH_SEARCH').hide();
        $('#DV_SH_DTLS').show();
    }
    BTP_OBJECT.mode = 'A';
}
//get third holder details
const THSearch = function (searchby, Searchbyref, SearchByDOB, Appl_No)
{
    BTP_OBJECT.mode = 'R';

    if (!$.isEmptyObject(Searchbyref))
    {

        var SearchBo = {
            HolderType: '03',
            searchby: searchby,
            Searchbyref: Searchbyref,
            SearchByDOB: SearchByDOB,
            Appl_No: Appl_No

        }

        ExtendedAjaxCall('AdditionalPurchase/SearchExistingCustomer', SearchBo, 'POST', function (result)
        {
            BTP_OBJECT.THCountFolioYear = 4;
            $('#DV_TH_HEAD').hide();
            $('#DV_TH_DTLS').hide();
            $('.THHeader').text('');
            $('#chkIsTHAddrSameAsPermanent').prop('checked', false).prop('disabled', false);
            $('#chkIsTHAddrSameAsFH').prop('checked', false).prop('disabled', false);
            $('#DV_TH #ddlFatherTitle').val('MR');
            $('#DV_TH #ddlMotherTitle').val('MRS');

            if (!$.isEmptyObject(result) && result.length > 0 && result[0].Msg.toUpperCase() == 'SUCCESS')
            {
                var row = result[0];
                $('#hdrTHFolioNo').text(row.Folio);
                $('#hdrTHExistingFDRNo').text(row.Dep_no);
                $('#hdrTHLastInvDate').text(row.Last_Inv_Date);
                BTP_OBJECT.THCountFolioYear = row.CountFolioYear;
                BTP_OBJECT.TH_DATA_SOURCE = result[0].Source;
                BTP_OBJECT.TH_CKYC_COMPLIANT = result[0].CKYC_Compliant;

                //title
                $('#DV_TH #ddlTitle').val(result[0]["NamePrefix"]).change();

                //name
                $('#DV_TH #txtFName').val(result[0].Holder_F_Name).change();
                $('#DV_TH #txtMName').val(result[0].Holder_M_Name).change();
                $('#DV_TH #txtLName').val(result[0].Holder_L_Name).change();

                //gender
                $('#DV_TH #ddlGender').val(result[0].Gender).change();

                //dob
                $('#DV_TH #txtDOB').datetextentry('set_date', result[0].DOB).datetextentry('set_readonly', true).focusout();
                //$('#DV_TH #txtDOB').blur();
                THDOBChange();

                //pan
                $('#DV_TH #txtPAN').val(result[0].PAN).change();

                //mobile
                $('#DV_TH_P_ADDR #txtMobileNo').val(result[0]["MOBILE_NO"]).change();

                //email
                $('#DV_TH_P_ADDR #txtEmailId').val(result[0]["EMAIL_ID"]).change();

                //tel no 
                $('#DV_TH_P_ADDR #txtTelephone').val(result[0].TEL_RES);

                //maritalstatus
                $('#DV_TH_MD #ddlMaritalStatus').val(result[0].MARITAL_STATUS).change();

                //father name
                if (!$.isEmptyObject(result[0].Holder_Father_F_Name))
                {
                    $('#DV_TH #ddlFatherTitle').val(result[0].Holder_Father_Prefix);
                    $('#DV_TH #txtFatherFName').val(result[0].Holder_Father_F_Name);
                    $('#DV_TH #txtFatherMName').val(result[0].Holder_Father_M_Name);
                    $('#DV_TH #txtFatherLName').val(result[0].Holder_Father_L_Name);
                }

                //mother name
                if (!$.isEmptyObject(result[0].Holder_Mother_F_Name))
                {
                    $('#DV_TH #ddlMotherTitle').val(result[0].Holder_Mother_Prefix);
                    $('#DV_TH #txtMotherFName').val(result[0].Holder_Mother_F_Name);
                    $('#DV_TH #txtMotherMName').val(result[0].Holder_Mother_M_Name);
                    $('#DV_TH #txtMotherLName').val(result[0].Holder_Mother_L_Name);
                }

                //spouse name
                if (!$.isEmptyObject(result[0].Holder_Spouse_F_Name))
                {
                    $('#DV_TH #ddlSpouseTitle').val(result[0].Holder_Spouse_Prefix);
                    $('#DV_TH #txtSpouseFName').val(result[0].Holder_Spouse_F_Name);
                    $('#DV_TH #txtSpouseMName').val(result[0].Holder_Spouse_M_Name);
                    $('#DV_TH #txtSpouseLName').val(result[0].Holder_Spouse_L_Name);
                }

                //guardian name
                if (!$.isEmptyObject(result[0].Holder_Guardian_F_Name))
                {
                    $('#DV_TH #ddlGuardianTitle').val(result[0].Holder_Guardian_Prefix);
                    $('#DV_TH #txtGuardianFName').val(result[0].Holder_Guardian_F_Name);
                    $('#DV_TH #txtGuardianMName').val(result[0].Holder_Guardian_M_Name);
                    $('#DV_TH #txtGuardianLName').val(result[0].Holder_Guardian_L_Name);
                    $('#DV_TH #txtGuardianPAN').val(result[0].Holder_Guardian_PAN);
                }

                //annual income
                $('#DV_TH #ddlAnnualIncome').val(result[0].ANNUAL_INC);

                //occupation
                $('#DV_TH #ddlOccupation').val(result[0].CustSeg_Type_Code);

                //avinash added Occupation / sub - occupation changes
                BindDDLExtendedAjaxCall('#DV_TH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);
                if ($('#HdnCustSeg_typeCode_TH').val() != '' && $('#HdnCustSeg_typeCode_TH').val() != undefined) {
                    $('#DV_TH #ddlCustSegType').val('select');
                }
                else {
                    $('#DV_TH #ddlCustSegType').val($('#HdnCustSeg_typeCode_TH').val());
                }

                //ckyc no
                $('#DV_TH #txtCKYCNumber').val(result[0].CKYCNumber);

                $('#DV_TH #hdnMobilisationMode').val(result[0].MobilisationMode);

                //PER
                if (!$.isEmptyObject(result[0].ADD1))
                {
                    $('#DV_TH_P_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                    $('#chkIsTHAddrSameAsFH').prop('disabled', true);

                    $('#DV_TH_P_ADDR #txtAdd1').val(result[0].ADD1);
                    $('#DV_TH_P_ADDR #txtAdd2').val(result[0].ADD2);
                    $('#DV_TH_P_ADDR #txtAdd3').val(result[0].ADD3);
                    $('#DV_TH_P_ADDR #ddlCountry').val(result[0].CountryCode).change();
                    $('#DV_TH_P_ADDR #txtCity').val(result[0].CITY);
                    if (result[0].CountryCode == 'IN')
                    {
                        $('#DV_TH_P_ADDR #txtPin').val(result[0].PINCODE).keyup();
                    }
                    else
                    {
                        $('#DV_TH_P_ADDR #txtState').val(result[0].STATE);
                        $('#DV_TH_P_ADDR #txtDistrict').val(result[0].DISTRICT);
                        $('#DV_TH_P_ADDR #txtPin').val(result[0].PINCODE);
                    }
                }

                //Mailing
                if (!$.isEmptyObject(result[0].M_ADD1))
                {
                    $('#chkIsTHAddrSameAsPermanent').prop('disabled', true);
                    $('#DV_TH_M_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                    $('#DV_TH_M_ADDR #txtAdd1').val(result[0].M_ADD1);
                    $('#DV_TH_M_ADDR #txtAdd2').val(result[0].M_ADD2);
                    $('#DV_TH_M_ADDR #txtAdd3').val(result[0].M_ADD3);
                    $('#DV_TH_M_ADDR #ddlCountry').val(result[0].M_CountryCode).change();
                    $('#DV_TH_M_ADDR #txtCity').val(result[0].M_CITY);
                    if (result[0].M_CountryCode == 'IN')
                    {
                        $('#DV_TH_M_ADDR #txtPin').val(result[0].M_PINCODE).keyup();
                    }
                    else
                    {
                        $('#DV_TH_M_ADDR #txtState').val(result[0].M_STATE);
                        $('#DV_TH_M_ADDR #txtDistrict').val(result[0].M_DISTRICT);
                        $('#DV_TH_M_ADDR #txtPin').val(result[0].M_PINCODE);
                    }
                }

                //CKYC validations
                TH_KYC_Validations();

                //validations                              
                $('#btnTHAddFresh').hide();
                $('#DV_TH_SEARCH').hide();
                $('#DV_TH_CKYC_SEARCH').hide();
                if ($('#ddlHolderType').val() == '03')
                {
                    $('#DV_TH_HEAD').show();
                }
                $('#DV_TH_DTLS').slideDown();
            }
            else
            {
                $('#DV_TH_HEAD').hide();
                $('#DV_TH #btnfreshcutomer').show();

                BtpMessagePopup('No Record Found. Please Continue as Fresh Holder.', 'error');
            }
        }, null, true, false, false, ErrorFunction);

    }
    else
    {
        $('#DV_TH_SEARCH').hide();
        $('#DV_TH_DTLS').show();
    }
    BTP_OBJECT.mode = 'A';
}
const IsSHValidSearch = function (searchby, Searchbyref, SearchByDOB, Appl_No)
{

    if (searchby == "select" || searchby == "")
    {
        BtpMessagePopup('Please Select Search By', 'error');
        return false;
    }

    if (Searchbyref == "")
    {
        BtpMessagePopup('Please Enter Search Text', 'error');
        return false;
    }

    if (SearchByDOB == "" && searchby != 'FDR' && searchby != 'Folio')
    {
        BtpMessagePopup('Please Enter Search DOB', 'error');
        return false;
    }

    return true;
}
const IsTHValidSearch = function (searchby, Searchbyref, SearchByDOB, Appl_No)
{

    if (searchby == "select" || searchby == "")
    {
        //$('#lblTHErrorMsg').text('Please Select Search By');
        //$('.trTHErrorMsg').show();
        BtpMessagePopup('Please Select Search By', 'error');
        return false;
    }

    if (Searchbyref == "")
    {
        //$('#lblTHErrorMsg').text('Please Enter Search Text');
        //$('.trTHErrorMsg').show();
        BtpMessagePopup('Please Enter Search Text', 'error');

        return false;
    }

    if (SearchByDOB == "" && searchby != 'FDR' && searchby != 'Folio')
    {
        //$('#lblTHErrorMsg').text('Please Enter Search  DOB');
        //$('.trTHErrorMsg').show();
        BtpMessagePopup('Please Enter Search DOB', 'error');

        return false;

    }

    return true;
}
//pan validations 
const CheckExisitingPAN = function (Appl_No, DOB, Folio, PAN)
{
    let err_msg = '';
    try
    {
        let investorDtl = {
            Appl_No: Appl_No,
            DOB: DOB,
            Folio: Folio,
            PAN: PAN
        }

        ExtendedAjaxCall('DataEntry/CheckExistingPan', investorDtl, 'POST', function (result)
        {
            if (!$.isEmptyObject(result) && result == 'Success')
                err_msg = '';
            else if (!$.isEmptyObject(result))
                err_msg = '<p>' + result + '</p>';
            else
                err_msg = '<p>Something went wrong checking PAN..!</p>';

            $('#preloader').hide();
        }, null, true, false, false, ErrorFunction);


    } catch (e)
    {
        fnException(e); return '<p>Something went wrong checking PAN..!</p>';
    }
    return err_msg;
}
$('#DV_SH #btnSearchHolder').click(function ()
{
    var dataFound = false;
    var searchby = $('#DV_SH #ddlSearchBy').val();
    var Searchbyref = $('#DV_SH #txtSearchText').val();
    var SearchByDOB = $('#DV_SH #txtSearchDOB').val();
    var Appl_No = $('#lblApplicationNumber').text();

    if (IsSHValidSearch(searchby, Searchbyref, SearchByDOB, Appl_No))
    {
        dataFound = SHSearch(searchby, Searchbyref, SearchByDOB, Appl_No);
    }
    $("#SH_PEP").hide();
});
$('#DV_TH #btnSearchHolder').click(function ()
{
    var dataFound = false;

    var searchby = $('#DV_TH #ddlSearchBy').val();
    var Searchbyref = $('#DV_TH #txtSearchText').val();
    var SearchByDOB = $('#DV_TH #txtSearchDOB').val();
    var Appl_No = $('#lblApplicationNumber').text();

    if (IsTHValidSearch(searchby, Searchbyref, SearchByDOB, Appl_No))
    {

        dataFound = THSearch(searchby, Searchbyref, SearchByDOB, Appl_No);
    }
    $("#TH_PEP").hide();
});
$('#chkFHEdit').change(function ()
{
    if ($(this).prop('checked'))
    {
        $('#DV_FH #ddlTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #ddlGender').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #ddlMaritalStatus').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #ddlOccupation,#DV_FH #ddlAnnualIncome').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_FH #ddlFatherTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_FH #ddlMotherTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_FH #ddlSpouseTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_FH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_FH #txtTelephone').prop('disabled', false).removeClass('DisabledControl');

    }
    else
    {
        var FDR = $('#hdrExistingFDRNo').text();
        var Folio = $('#hdrFolioNo').text();
        var Appl_No = $('#lblApplicationNumber').text();

        if (BTP_OBJECT.mode == 'A')
        {
            if (confirm('We are reverting earlier changes'))
            {
                if (!$.isEmptyObject(Folio))
                {
                    InvSearch('Folio', Folio, null, Appl_No);
                }

            }
            else
            {
                $('#chkInvEdit').prop('checked', true);
            }
        }
        else
        {

            if (!$.isEmptyObject(Folio))
            {
                InvSearch('Folio', Folio, null, Appl_No);
            }

        }
    }
});
$('#chkSHEdit').change(function ()
{
    if ($(this).prop('checked'))
    {

        $('#DV_SH #ddlTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #ddlGender').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #ddlMaritalStatus').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #ddlOccupation,#DV_SH #ddlAnnualIncome').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_SH #ddlFatherTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_SH #ddlMotherTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_SH #ddlSpouseTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_SH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_SH #txtTelephone').prop('disabled', false).removeClass('DisabledControl');
    }
    else
    {
        var dataFound = false;
        var FDR = $('#hdrSHExistingFDRNo').text();
        var Folio = $('#hdrSHFolioNo').text();
        var SearchByDOB = $('#txtSHDOB').val();
        var Appl_No = $('#lblApplicationNumber').text();

        if (BTP_OBJECT.mode == 'A')
        {
            if (confirm('We are reverting earlier changes'))
            {
                if (Folio != '')
                {
                    SHSearch('Folio', Folio, null, Appl_No);
                }

            }
            else
            {
                $('#chkSHEdit').prop('checked', true);
            }
        }
        else
        {
            var dataFound = false;

            if (Folio != '')
            {
                SHSearch('Folio', Folio, null, Appl_No);
            }

        }
    }
});
$('#chkTHEdit').change(function ()
{
    if ($(this).prop('checked'))
    {

        $('#DV_TH #ddlTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #ddlGender').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #ddlMaritalStatus').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #ddlOccupation,#DV_TH #ddlAnnualIncome').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_TH #ddlFatherTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_TH #ddlMotherTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_TH #ddlSpouseTitle').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_TH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');

        $('#DV_TH #txtTelephone').prop('disabled', false).removeClass('DisabledControl');
    }
    else
    {
        var dataFound = false;
        var FDR = $('#hdrTHExistingFDRNo').text();
        var Folio = $('#hdrTHFolioNo').text();
        var SearchByDOB = $('#txtTHDOB').val();
        var Appl_No = $('#lblApplicationNumber').text();
        if (BTP_OBJECT.mode == 'A')
        {
            if (confirm('We are reverting earlier changes'))
            {

                if (Folio != '')
                {
                    THSearch('Folio', Folio, null, Appl_No);
                }
            }
            else
            {
                $('#chkTHEdit').prop('checked', true);
            }
        }
        else
        {

            if (Folio != '')
            {
                THSearch('Folio', Folio, null, Appl_No);
            }

        }
    }
});
//investor search
$('#btnInvSearch').on('click', function ()
{
    try
    {
        $("#FH_PEP").hide();
        //Reset_step1();
        $('#ddlInvtitle').val('select').change();
        $('#txtInvFirstName').val('').change();
        $('#txtInvMiddleName').val('').change();
        $('#txtInvLastName').val('').change();
        $('#txtInvPan').val('').change();
        $('#txtMobile').val('').change();
        $('#txtEmail').val('').change();
        $('#txtInvDOB').datetextentry('set_date', null);
        $('#txtInvDrawn_Bank_Search,#hdnDrawn_Bank_Name,#hdnBank_Branch_Name,#hdnBank_MICR,#hdnBank_NEFT,#txtInvCheque_DD_No,#txtPhysicalApplNo,#txtAmount,#txtSubBrokerCode,#txtRemark').val('');
        $('#ddlBranch,#ddlInvPayment_Mode,#ddlCMSBranch').val('select').change();
        $('#txtChequeDate').datetextentry('set_date', null);
        $('#txtamountinwords').text('');
        $('#txtPhysicalApplNo').val('0000');
        $('#txtInvCKYCNumber').val('').change();
        $('#rdoDigital').prop('checked', true).change();

        $('.form-control').removeClass('InputBorderRed');

        var ddlDepositorCategory = $('#ddlDepositorsStatus');
        var ddlInvSearchBy = $('#ddlInvSearchBy');
        var txtSearchRefNo = $('#txtSearchRefNo');
        var txtSearchDOB = $('#txtSearchDOB');

        var isError = false;
        var errMessage = "";
        $('#dvErrorMsg').html('');


        if (ddlDepositorCategory.val() == 'select')
        {
            errMessage += '<p>Deposite Category is required..!</p>';
            ddlDepositorCategory.addClass('InputBorderRed');
            isError = true;
        }

        if (ddlInvSearchBy.val() == 'select')
        {
            errMessage += '<p>Search By is required..!</p>';
            ddlInvSearchBy.addClass('InputBorderRed');

            isError = true;
        }

        if ($.isEmptyObject(txtSearchRefNo.val()))
        {
            errMessage += '<p>Search By Reference No is required..!</p>';
            txtSearchRefNo.addClass('InputBorderRed');

            isError = true;
        }

        if (!$.isEmptyObject(txtSearchRefNo.val()))
        {
            if (ddlInvSearchBy.val() == 'PAN' && !IsValidPAN(txtSearchRefNo.val()))
            {
                errMessage += "<p>Please Enter valid PAN Number..!</p>";
                isError = true;
            }
            else if (ddlInvSearchBy.val() == 'Mobile' && !IsValidMobile(txtSearchRefNo.val()))
            {
                errMessage += "<p>Please Enter valid Mobile Number..!</p>";
                isError = true;
            }
            else if (ddlInvSearchBy.val() == 'Email' && !IsValidEmail(txtSearchRefNo.val()))
            {
                errMessage += "<p>Please Enter valid Email Id..!</p>";
                isError = true;
            }
        }

        if ($.isEmptyObject(txtSearchDOB.val()) && ddlInvSearchBy.val() != 'Folio' && ddlInvSearchBy.val() != 'FDR' && ddlDepositorCategory.val() == 'IND')
        {
            errMessage += "<p>Please Enter Date Of Birth..!</p>";
            isError = true;
        }

        if (isError)
        {
            $('#dvErrorMsg').html(errMessage);
            $('#ModelError').modal('show');
            return false;
        }

        InvSearch(ddlDepositorCategory.val(), ddlInvSearchBy.val(), txtSearchRefNo.val().trim(), txtSearchDOB.val(), null);

    } catch (e)
    {
        fnException(e);
    }
});
//add as fresh inveestor
$('#IdInvestorSearch #btnfreshcutomer').click(function ()
{
    Reset_step1();
    $('#IdInfoDiv').slideDown();
    if ($('#ddlDepositorsStatus').val() == 'HUF')
    {
        $('#DV_FH_CKYC_SEARCH').hide();
        $('#ddlInvtitle').val('M/S').prop('disabled', true).addClass('DisabledContol')
        $('#DV_INV_DETAILS').show();
    }
    else
    {
        $('#DV_FH_CKYC_SEARCH').show();
        $('#ddlInvtitle').val('select').prop('disabled', false).removeClass('DisabledContol')
        $('#DV_INV_DETAILS').hide();
    }
    $('#IdInvestorSearch').hide();
    $('#IdInvestorInfo').show();
});
$('#DV_SH #btnfreshcutomer').click(function ()
{
    BTP_OBJECT.mode = 'R';
    SHReset();
    BTP_OBJECT.mode = 'A';
    $('#DV_SH_HEAD').hide();
    $('#DV_PROV_SH').hide();
    $('#DV_SH_EDIT_AS_CKYC').hide();
    $('#DV_SH_SEARCH').slideUp();
    $('#DV_SH_CKYC_SEARCH').slideDown();
    $('#DV_SH_DTLS').hide();
});
$('#DV_TH #btnfreshcutomer').click(function ()
{
    $('#DV_TH_HEAD').hide();
    BTP_OBJECT.mode = 'R';
    THReset();
    BTP_OBJECT.mode = 'A';
    $('#DV_PROV_TH').hide();
    $('#DV_TH_EDIT_AS_CKYC').hide();
    $('#DV_TH_SEARCH').slideUp();
    $('#DV_TH_CKYC_SEARCH').slideDown();
    $('#DV_TH_DTLS').hide();
});
$('#DV_SH #txtPAN').focusout(function ()
{
    if ($('#hdrSHFolioNo').text() != '' && $('#DV_SH #txtPAN').val() != '' && !CheckIsMinor($('#DV_SH #txtPAN').val()))
    {
        var Appl_No = $('#lblApplicationNumber').text();
        var DOB = $('#DV_SH #txtDOB').val();
        var Folio = $('#hdrSHFolioNo').text();
        CheckExisitingPAN(Appl_No, DOB, Folio, $(this).val());
    }
});
$('#DV_TH #txtPAN').focusout(function ()
{
    if ($('#hdrTHFolioNo').text() != '' && $('#DV_TH #txtPAN').val() != '' && !CheckIsMinor($('#DV_TH #txtPAN').val()))
    {
        var Appl_No = $('#lblApplicationNumber').text();
        var DOB = $('#DV_TH #txtDOB').val();
        var Folio = $('#hdrTHFolioNo').text();
        CheckExisitingPAN(Appl_No, DOB, Folio, $(this).val());
    }
});

const stepper = {
    activeTabIndex: 1,
    maxTabIndex: 1
}

//call model popup
$('#btnsubmit08').on('click', function () {
    $('#btnOpenModalSuccess').click();
});

//toggle accordian 2nd and 3rd holder
const ToggleSHD = function ToggleSHD(e) {
    $(e).children('.fa').toggleClass('fa-chevron-circle-down').toggleClass('fa-chevron-circle-up');
    $('.PermAddTblOutr').slideToggle('slow');
};
const ToggleTHD = function (e) {
    $(e).children('.fa').toggleClass('fa-chevron-circle-down').toggleClass('fa-chevron-circle-up');
    $('.CorspAddTblOutr').slideToggle('slow');
};

//toggle accodian see more text
$('.btn.btn-link').on('click', function () {
    if ($(this).hasClass('collapsed')) {
        $(this).find('.badge').text('See Less');
    }
    else {
        $(this).find('.badge').text('See More');
    }
});

//tab javascript
$(".BtnTabSwit, .BtnTabSwitMob").on('click keypress', function (event) {
    // event.which === 13 means the "Enter" key is pressed
    if ((event.type === "keypress" && event.which === 13) || event.type === "click") {
        let tabClicked = parseInt($(this).data("tab-index"));

        if (parseInt(tabClicked) != stepper.activeTabIndex && parseInt(tabClicked) <= stepper.maxTabIndex)
        //if (parseInt(tabClicked) != stepper.activeTabIndex)        
        {
            $(".tab-switcher").removeClass('active');
            $(".list-group-item").removeClass('active');
            $(this).parent().addClass('active').removeClass('NoActive');
            $(".tab-container").slideUp();

            $("#allTabsContainer .tab-container").each(function () {
                if ($(this).data("tab-index") == tabClicked) {
                    $(this).slideDown();
                    return;
                }
            });

            stepper.activeTabIndex = tabClicked;
            if (stepper.maxTabIndex < stepper.activeTabIndex) {
                stepper.maxTabIndex = stepper.activeTabIndex;
            }

        }
    }
});

//toggle button
//$('#BtnStepsToggle').on('click', function () {
//    $('#IdStepsMob').slideToggle();
//});
$('#BtnStepsToggle').click(function (e) {
    e.stopPropagation();
    $('#IdStepsMob').slideToggle();
});
$('#IdStepsMob').click(function (e) {
    e.stopPropagation();
});
$('body,html').click(function (e) {
    $('#IdStepsMob').slideUp();
});

//tab back
$('#btnBack02,#btnBack03,#btnBack04,#btnBack05,#btnBack06,#btnBack07,#btnBack08').on('click', function () {
    if (this.id == 'btnBack02') {
        $('#IdBtnTabSwit01').click();
    }
    else if (this.id == 'btnBack03') {
        $('#IdBtnTabSwit02').click();
    }
    else if (this.id == 'btnBack04') {
        $('#IdBtnTabSwit03').click();
    }
    else if (this.id == 'btnBack05') {
        $('#IdBtnTabSwit04').click();
    }
    else if (this.id == 'btnBack06') {
        $('#IdBtnTabSwit05').click();
    }
    else if (this.id == 'btnBack07') {
        if ($('#chkNomApplicable').prop('checked')) {
            $('#IdBtnTabSwit06').click();
        }
        else {
            $('#IdBtnTabSwit05').click();
        }
    }
    else if (this.id == 'btnBack08') {
        $('#IdBtnTabSwit07').click();
    }


});

//tab save
$('#btnsubmit01,#btnsubmit02,#btnsubmit03,#btnsubmit04,#btnsubmit05,#btnsubmit06,#btnsubmit07,#btnsubmit08').on('click', function () {
    if (this.id == 'btnsubmit01') {

        if (SubmitStep1()) {

            GET_APPL_DTLS($('#lblApplicationNumber').text().trim());

            if (stepper.maxTabIndex == stepper.activeTabIndex)
                stepper.maxTabIndex += 1

            $('#IdInfoDiv').slideDown();
            $('#IdBtnTabSwit02').click();
            //$('#IdBtnTabSwit01').css('border-color', '#047904');
            $('#IdBtnTabSwit01').parent().addClass('Active');
        }

    }
    else if (this.id == 'btnsubmit02') {
        if (SubmitStep2()) {
            if (stepper.maxTabIndex == stepper.activeTabIndex)
                stepper.maxTabIndex += 1

            $('#IdBtnTabSwit03').click();
            //$('#IdBtnTabSwit02').css('border-color', '#047904');
            $('#IdBtnTabSwit02').parent().addClass('Active');
        }
    }
    else if (this.id == 'btnsubmit03') {
        if (SubmitStep3()) {
            if (stepper.maxTabIndex == stepper.activeTabIndex)
                stepper.maxTabIndex += 1

            $('#IdBtnTabSwit04').click();
            //$('#IdBtnTabSwit03').css('border-color', '#047904');
            $('#IdBtnTabSwit03').parent().addClass('Active');
        }
    }
    else if (this.id == 'btnsubmit04') {
        if (SubmitStep4()) {
            if (stepper.maxTabIndex == stepper.activeTabIndex)
                stepper.maxTabIndex += 1

            $('#IdBtnTabSwit05').click();
            //$('#IdBtnTabSwit04').css('border-color', '#047904');
            $('#IdBtnTabSwit04').parent().addClass('Active');
        }
    }
    else if (this.id == 'btnsubmit05') {
        if (SubmitStep5()) {
            BindOVD($('#lblApplicationNumber').text().trim());
            if ($('#chkNomApplicable').prop('checked')) {
                if (stepper.maxTabIndex == stepper.activeTabIndex)
                    stepper.maxTabIndex += 1

                $('#IdBtnTabSwit06').click();
                //$('#IdBtnTabSwit05').css('border-color', '#047904');
                $('#IdBtnTabSwit05').parent().addClass('Active');
            }
            //else if ($.isEmptyObject(IsDocUploaded()) && BTP_OBJECT.OVDSave == false)
            //{
            //    if (stepper.maxTabIndex == stepper.activeTabIndex)
            //        stepper.maxTabIndex += 3

            //    $('#IdBtnTabSwit08').click();
            //    //$('#IdBtnTabSwit07').css('border-color', '#047904');
            //    $('#IdBtnTabSwit05').parent().addClass('Active');
            //    $('#IdBtnTabSwit07').parent().addClass('Active');
            //}
            else {
                if (stepper.maxTabIndex == stepper.activeTabIndex)
                    stepper.maxTabIndex += 2

                $('#IdBtnTabSwit05').parent().addClass('Active');
                $('#IdBtnTabSwit07').prop('disabled', false).removeClass('DisabledControl');
                $('#IdBtnTabSwit07').click();
            }
        }
    }
    else if (this.id == 'btnsubmit06') {
        if (SubmitStep6()) {
            BindOVD($('#lblApplicationNumber').text().trim());

            //if ($.isEmptyObject(IsDocUploaded()) && BTP_OBJECT.OVDSave == false)
            if (false) {
                if (stepper.maxTabIndex == stepper.activeTabIndex)
                    stepper.maxTabIndex += 2

                $('#IdBtnTabSwit08').click();
                $('#IdBtnTabSwit06').parent().addClass('Active');
                $('#IdBtnTabSwit07').parent().addClass('Active');
            }
            else {
                if (stepper.maxTabIndex == stepper.activeTabIndex)
                    stepper.maxTabIndex += 1

                $('#IdBtnTabSwit07').prop('disabled', false).removeClass('DisabledControl');
                $('#IdBtnTabSwit07').click();
                $('#IdBtnTabSwit06').parent().addClass('Active');
            }
        }
    }
    else if (this.id == 'btnsubmit07') {
        BindOVD($('#lblApplicationNumber').text().trim());

        if (SubmitStep7()) {
            if (stepper.maxTabIndex == stepper.activeTabIndex)
                stepper.maxTabIndex += 1

            $('#IdBtnTabSwit08').click();
            //$('#IdBtnTabSwit07').css('border-color', '#047904');
            $('#IdBtnTabSwit07').parent().addClass('Active');
        }
    }
});

///basic forgery check
const Basic_Forgery_Check = function (objBO)
{
    let err_msg = '';
    try
    {
        ExtendedAjaxCall('Signzy_Services/Check_Basic_Forgery', objBO, 'POST', function (result) 
        {
            try
            {
                if (!$.isEmptyObject(result.ErrorCode) && !$.isEmptyObject(result.ErrorMessage))
                    err_msg += '';
                //err_msg += 'An error occurred while processing your request. Please try again..';
                else if (!$.isEmptyObject(result.result) && !$.isEmptyObject(result.result.result.forgery))
                {
                    if (result.result.result.forgery == 'FORGED')
                        err_msg += result.result.result.message;
                }

                $('#preloader').hide();

            } catch (e)
            {
                err_msg = 'Something went wrong..!';
                fnException(e);
            }
        }, null, true, false, false, ErrorFunction);

    } catch (e)
    {
        err_msg = 'Something went wrong..!';
        fnException(e);
    }
    return err_msg;
}

//ovd classification 
const OVD_Classification = function (objBO) 
{
    let err_msg = '';
    try
    {

        $.ajax({
            url: WA_FD_BTP + 'Signzy_Services/Check_OVD_Classification',
            type: "POST",
            data: objBO,
            async: false,
            contentType: false,
            processData: false,
            beforeSend: OnBeforeSendCall,
            success: function (result)
            {
                try
                {
                    let jsonResult = JSON.parse(result);

                    if (!$.isEmptyObject(jsonResult.ErrorCode) && !$.isEmptyObject(jsonResult.ErrorMessage))
                        err_msg += 'An error occurred while processing your request. Please try again..';
                    else if (!$.isEmptyObject(jsonResult.result))
                    {
                        //individual pan validations
                        if ($('#ddlDocType :selected').text().toUpperCase().match('PAN') == 'PAN'
                            && !$.isEmptyObject(jsonResult.result.result[0].classification.idType)
                            && jsonResult.result.result[0].classification.idType != 'individualPan'
                            && BTP_OBJECT.IND_NIND == 'IND')
                        {
                            err_msg += '<p>Document is invalid, Please upload valid individual PAN document</p>';
                        }
                        //Non-individual PAN
                        else if ($('#ddlDocType :selected').text().toUpperCase().match('PAN') == 'PAN'
                            && !$.isEmptyObject(jsonResult.result.result[0].classification.idType)
                            && (jsonResult.result.result[0].classification.idType != 'businessPan'
                                || jsonResult.result.result[0].classification.idType != 'unknownPan')
                            && BTP_OBJECT.IND_NIND != 'IND')
                        {
                            err_msg += '<p>Document is invalid, Please upload valid PAN </p>';
                        }
                        //AADHAR validations
                        else if ($('#ddlDocType :selected').text().toUpperCase().match('AADHAR') == 'AADHAR'
                            && !$.isEmptyObject(jsonResult.result.result[0].classification.idType)
                            && jsonResult.result.result[0].classification.idType != 'aadhaar')
                        {
                            err_msg += '<p>Document is invalid, Please upload valid Aadhar Card</p>';
                        }
                        //PASSPORT validations
                        else if ($('#ddlDocType :selected').text().toUpperCase().match('PASSPORT') == 'PASSPORT'
                            && !$.isEmptyObject(jsonResult.result.result[0].classification.idType)
                            && jsonResult.result.result[0].classification.idType != 'passport')
                        {
                            err_msg += '<p>Document is invalid, Please upload valid Passort</p>';
                        }
                        //PASSPORT validations
                        else if ($('#ddlDocType :selected').text().toUpperCase().match('DRIVING') == 'DRIVING'
                            && !$.isEmptyObject(jsonResult.result.result[0].classification.idType)
                            && jsonResult.result.result[0].classification.idType != 'dl')
                        {
                            err_msg += '<p>Document is invalid, Please upload valid Driving Licence</p>';
                        }
                    }

                } catch (e)
                {
                    err_msg = 'Something went wrong..!';
                    fnException(e);
                }
                $('#preloader').hide();
            },
            error: ErrorFunction,
            complete: null
        });

    } catch (e)
    {
        err_msg = 'Something went wrong..!';
        fnException(e);
    }

    return err_msg;
}

////PAN data extraction
//function PAN_DATA_EXTRACTION(objBO) 
//{
//    let err_msg = '';
//    try
//    {
//        //$.ajax({
//        //    url: WA_FD_BTP + 'Signzy_Services/Check_PAN_Data',
//        //    type: "POST",
//        //    data: objBO,
//        //    async: false,
//        //    contentType: false,
//        //    processData: false,
//        //    beforeSend: OnBeforeSendCall,
//        //    success: function (result)
//        //    {
//        //        try
//        //        {
//        //            let jsonResult = JSON.parse(result);
//        //            if (!$.isEmptyObject(jsonResult.ErrorCode) && !$.isEmptyObject(jsonResult.ErrorMessage))
//        //                err_msg += 'An error occurred while processing your request. Please try again..';
//        //            else if (!$.isEmptyObject(jsonResult.result) && !$.isEmptyObject(jsonResult.result.response.result))
//        //            {

//        //            }

//        //        } catch (e)
//        //        {
//        //            fnException(e);
//        //        }
//        //        $('#preloader').hide();
//        //    },
//        //    error: ErrorFunction,
//        //    complete: null
//        //});

//        ExtendedAjaxCall('Signzy_Services/Extract_PAN_Data', objBO, 'POST', function(result) 
//        {
//            try
//            {
//                if (!$.isEmptyObject(result.ErrorCode) && !$.isEmptyObject(result.ErrorMessage))
//                    err_msg += '';
//                //err_msg += 'An error occurred while processing your request. Please try again..';
//                else if (!$.isEmptyObject(jsonResult.result) && !$.isEmptyObject(jsonResult.result.response.result))
//                {

//                }

//                $('#preloader').hide();

//            } catch (e)
//            {
//                err_msg = 'Something went wrong..!';
//                fnException(e);
//            }
//        }, null, true, false, false, ErrorFunction);


//    } catch (e)
//    {
//        err_msg = 'Something went wrong..!';
//        fnException(e);
//    }

//    return err_msg;
//}

////DL data extraction
//function DL_DATA_EXTRACTION(objBO) 
//{
//    let err_msg = '';
//    try
//    {
//        //$.ajax({
//        //    url: WA_FD_BTP + 'Signzy_Services/Check_Driving_License',
//        //    type: "POST",
//        //    data: objBO,
//        //    async: false,
//        //    contentType: false,
//        //    processData: false,
//        //    beforeSend: OnBeforeSendCall,
//        //    success: function (result)
//        //    {
//        //        try
//        //        {
//        //            let jsonResult = JSON.parse(result);
//        //            if (!$.isEmptyObject(jsonResult.ErrorCode) && !$.isEmptyObject(jsonResult.ErrorMessage))
//        //                err_msg += 'An error occurred while processing your request. Please try again..';
//        //            else
//        //            { }


//        //        } catch (e)
//        //        {
//        //            err_msg = 'Something went wrong..!';
//        //            fnException(e);
//        //        }
//        //        $('#preloader').hide();
//        //    },
//        //    error: ErrorFunction,
//        //    complete: null
//        //});

//        ExtendedAjaxCall('Signzy_Services/Extract_PAN_Data', objBO, 'POST', function(result) 
//        {
//            try
//            {
//                if (!$.isEmptyObject(result.ErrorCode) && !$.isEmptyObject(result.ErrorMessage))
//                    err_msg += '';
//                //err_msg += 'An error occurred while processing your request. Please try again..';
//                else if (!$.isEmptyObject(result) && !$.isEmptyObject(result.response.result))
//                {

//                }

//                $('#preloader').hide();

//            } catch (e)
//            {
//                err_msg = 'Something went wrong..!';
//                fnException(e);
//            }
//        }, null, true, false, false, ErrorFunction);

//    } catch (e)
//    {
//        err_msg = 'Something went wrong..!';
//        fnException(e);
//    }

//    return err_msg;
//}

//ovd ref no verification

const OVD_Ref_Verification = function (ref_no)
{
    let err_msg = '';
    try
    {
        $(ref_no).val($(ref_no).val().toUpperCase());
        $(ref_no).next().text('').hide();
        let objBO = {};
        objBO.DocId = $(ref_no).attr('doc_id');
        objBO.Holder_Type = $(ref_no).attr('HolderTypeCode');
        let sub_doc_type = $(ref_no).attr('sub_doc_type');
        let doc_no = $(ref_no).val();
        objBO.OVD_Type = '';
        objBO.OVD_Task = 'BF';
        objBO.App_Code = 'CPTP_UNI';
        objBO.Appl_No = $('#lblApplicationNumber').text();
        objBO.Source_Type = 'CPTP_UNI';
        objBO.Source_Sub_Type = 'CPTP_UNI';
        objBO.Parameters = [];

        if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '01')
        {
            objBO.OVD_HolderFirstName = $('#txtInvFirstName').val().trim();
            objBO.OVD_HolderMiddleName = $('#txtInvMiddleName').val().trim();
            objBO.OVD_HolderLastName = $('#txtInvLastName').val().trim();
        }
        else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '01')
        {
            objBO.OVD_HolderFirstName = $('#DV_SH #txtFName').val().trim();
            objBO.OVD_HolderMiddleName = $('#DV_SH #txtMName').val().trim();
            objBO.OVD_HolderLastName = $('#DV_SH #txtLName').val().trim();
        }
        else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '01')
        {
            objBO.OVD_HolderFirstName = $('#DV_TH #txtFName').val().trim();
            objBO.OVD_HolderMiddleName = $('#DV_TH #txtMName').val().trim();
            objBO.OVD_HolderLastName = $('#DV_TH #txtLName').val().trim();
        }


        if ($.isEmptyObject(doc_no))
            return false;
        if ($.isEmptyObject(objBO.DocId))
            return false;

        ///pan validations-------------------------------------------------------
        //individual pan
        if (sub_doc_type.toUpperCase().match('PAN') == 'PAN'
            && BTP_OBJECT.IND_NIND == 'IND'
            && !IsValidPAN(doc_no))
        {
            err_msg = 'PAN ref no is not valid..!';
        }
        //individual pan
        else if (sub_doc_type.toUpperCase().match('PAN') == 'PAN'
            && BTP_OBJECT.IND_NIND == 'IND')
        {
            let Name = '';
            let FatherName = '';
            if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '01')
            {
                Name = $('#txtInvFirstName').val().trim() + ' ' + $('#txtInvMiddleName').val().trim() + ' ' + $('#txtInvLastName').val().trim();
                FatherName = $('#DV_FH #txtFatherFName').val().trim() + ' ' + $('#DV_FH #txtFatherMName').val().trim() + ' ' + $('#DV_FH #txtFatherLName').val().trim();
            }
            else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '02')
            {
                Name = $('#DV_SH #txtFName').val().trim() + ' ' + $('#DV_SH #txtMName').val().trim() + ' ' + $('#DV_SH #txtLName').val().trim();
                FatherName = $('#DV_SH #txtFatherFName').val().trim() + ' ' + $('#DV_SH #txtFatherMName').val().trim() + ' ' + $('#DV_SH #txtFatherLName').val().trim();
            }
            else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '03')
            {
                Name = $('#DV_TH #txtFName').val().trim() + ' ' + $('#DV_TH #txtMName').val().trim() + ' ' + $('#DV_TH #txtLName').val().trim();
                FatherName = $('#DV_TH #txtFatherFName').val().trim() + ' ' + $('#DV_TH #txtFatherMName').val().trim() + ' ' + $('#DV_TH #txtFatherLName').val().trim();
            }

            objBO.OVD_Type = 'CI';
            if (!$.isEmptyObject($.trim(Name)))
                objBO.Parameters.push({ key: "Name", value: Name });
            if (!$.isEmptyObject($.trim(FatherName)))
                objBO.Parameters.push({ key: "Father Name", value: FatherName });
            objBO.Parameters.push({ key: "Pan Number", value: doc_no });
        }
        else if (sub_doc_type.toUpperCase().match('PAN') == 'PAN'
            && BTP_OBJECT.IND_NIND != 'IND'
            && IsValidPAN(doc_no))
        {
            objBO.OVD_Type = 'CB';
            //objBO.Parameters.push({ key: "Name", value: "Shivaprasad Terse" });
            //objBO.Parameters.push({ key: "Father Name", value: "Subhash Terse" });
            //objBO.Parameters.push({ key: "Pan Number", value: doc_no });
        }

        ///Driving Licence-----------------------------------------------------------
        if (sub_doc_type.toUpperCase().match('DRIVING') == 'DRIVING'
            && BTP_OBJECT.IND_NIND == 'IND')
        {
            let Name = '';
            let FatherName = '';
            if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '01')
            {
                Name = $('#txtInvFirstName').val().trim() + ' ' + $('#txtInvMiddleName').val().trim() + ' ' + $('#txtInvLastName').val().trim();
                FatherName = $('#DV_FH #txtFatherFName').val().trim() + ' ' + $('#DV_FH #txtFatherMName').val().trim() + ' ' + $('#DV_FH #txtFatherLName').val().trim();
            }
            else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '02')
            {
                Name = $('#DV_SH #txtFName').val().trim() + ' ' + $('#DV_SH #txtMName').val().trim() + ' ' + $('#DV_SH #txtLName').val().trim();
                FatherName = $('#DV_SH #txtFatherFName').val().trim() + ' ' + $('#DV_SH #txtFatherMName').val().trim() + ' ' + $('#DV_SH #txtFatherLName').val().trim();
            }
            else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '03')
            {
                Name = $('#DV_TH #txtFName').val().trim() + ' ' + $('#DV_TH #txtMName').val().trim() + ' ' + $('#DV_TH #txtLName').val().trim();
                FatherName = $('#DV_TH #txtFatherFName').val().trim() + ' ' + $('#DV_TH #txtFatherMName').val().trim() + ' ' + $('#DV_TH #txtFatherLName').val().trim();
            }

            objBO.OVD_Type = 'D';
            if (!$.isEmptyObject($.trim(Name)))
                objBO.Parameters.push({ key: "Name", value: Name });
            if (!$.isEmptyObject($.trim(FatherName)))
                objBO.Parameters.push({ key: "Father Name", value: FatherName });
            objBO.Parameters.push({ key: "DL NO", value: doc_no });
        }

        ///Passport------------------------------------------------------------------------
        if (sub_doc_type.toUpperCase().match('PASSPORT') == 'PASSPORT'
            && BTP_OBJECT.IND_NIND == 'IND')
        {
            let Name = '';
            let FatherName = '';
            if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '01')
            {
                Name = $('#txtInvFirstName').val().trim() + ' ' + $('#txtInvMiddleName').val().trim() + ' ' + $('#txtInvLastName').val().trim();
                FatherName = $('#DV_FH #txtFatherFName').val().trim() + ' ' + $('#DV_FH #txtFatherMName').val().trim() + ' ' + $('#DV_FH #txtFatherLName').val().trim();
            }
            else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '02')
            {
                Name = $('#DV_SH #txtFName').val().trim() + ' ' + $('#DV_SH #txtMName').val().trim() + ' ' + $('#DV_SH #txtLName').val().trim();
                FatherName = $('#DV_SH #txtFatherFName').val().trim() + ' ' + $('#DV_SH #txtFatherMName').val().trim() + ' ' + $('#DV_SH #txtFatherLName').val().trim();
            }
            else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '03')
            {
                Name = $('#DV_TH #txtFName').val().trim() + ' ' + $('#DV_TH #txtMName').val().trim() + ' ' + $('#DV_TH #txtLName').val().trim();
                FatherName = $('#DV_TH #txtFatherFName').val().trim() + ' ' + $('#DV_TH #txtFatherMName').val().trim() + ' ' + $('#DV_TH #txtFatherLName').val().trim();
            }

            objBO.OVD_Type = 'A';
            if (!$.isEmptyObject($.trim(Name)))
                objBO.Parameters.push({ key: "Name", value: Name });
            if (!$.isEmptyObject($.trim(FatherName)))
                objBO.Parameters.push({ key: "Father Name", value: FatherName });
            objBO.Parameters.push({ key: "Passport No", value: doc_no });
        }

        ///Voter ID------------------------------------------------------------------------
        if (sub_doc_type.toUpperCase().match('VOTER') == 'VOTER'
            && BTP_OBJECT.IND_NIND == 'IND')
        {
            let Name = '';
            let FatherName = '';
            if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '01')
            {
                Name = $('#txtInvFirstName').val().trim() + ' ' + $('#txtInvMiddleName').val().trim() + ' ' + $('#txtInvLastName').val().trim();
                FatherName = $('#DV_FH #txtFatherFName').val().trim() + ' ' + $('#DV_FH #txtFatherMName').val().trim() + ' ' + $('#DV_FH #txtFatherLName').val().trim();
            }
            else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '02')
            {
                Name = $('#DV_SH #txtFName').val().trim() + ' ' + $('#DV_SH #txtMName').val().trim() + ' ' + $('#DV_SH #txtLName').val().trim();
                FatherName = $('#DV_SH #txtFatherFName').val().trim() + ' ' + $('#DV_SH #txtFatherMName').val().trim() + ' ' + $('#DV_SH #txtFatherLName').val().trim();
            }
            else if (!$.isEmptyObject(objBO.Holder_Type) && objBO.Holder_Type == '03')
            {
                Name = $('#DV_TH #txtFName').val().trim() + ' ' + $('#DV_TH #txtMName').val().trim() + ' ' + $('#DV_TH #txtLName').val().trim();
                FatherName = $('#DV_TH #txtFatherFName').val().trim() + ' ' + $('#DV_TH #txtFatherMName').val().trim() + ' ' + $('#DV_TH #txtFatherLName').val().trim();
            }

            objBO.OVD_Type = 'B';
            if (!$.isEmptyObject($.trim(Name)))
                objBO.Parameters.push({ key: "Name", value: Name });
            if (!$.isEmptyObject($.trim(FatherName)))
                objBO.Parameters.push({ key: "Father Name", value: FatherName });
            objBO.Parameters.push({ key: "Number", value: doc_no });
        }

        //Basic forgery check
        if ($.isEmptyObject(err_msg))
            err_msg = Basic_Forgery_Check(objBO);

        if (!$.isEmptyObject(err_msg))
            $(ref_no).next().text(err_msg).show();

    } catch (e)
    {
        err_msg = 'Something went wrong..!';
        fnException(e);
    }

    return err_msg;
};

//PAN/DL data extraction
const Data_Extraction = function (refNo)
{
    try
    {
        let HolderType = $(refNo).attr('HolderTypeCode');
        let sub_doc_type = $(refNo).attr('sub_doc_type');
        let Doc_Ref_No = $(refNo).val();
        let objBO = {};
        objBO.DocId = $(refNo).attr('doc_id');
        objBO.HolderType = $(refNo).attr('HolderTypeCode');


        if (!$.isEmptyObject(HolderType) && HolderType == '01')
        {
            objBO.OVD_HolderFirstName = $('#txtInvFirstName').val().trim();
            objBO.OVD_HolderMiddleName = $('#txtInvMiddleName').val().trim();
            objBO.OVD_HolderLastName = $('#txtInvLastName').val().trim();
            objBO.OVD_HolderDOB = $('#txtInvDOB').val();
        }
        else if (!$.isEmptyObject(HolderType) && HolderType == '02')
        {
            objBO.OVD_HolderFirstName = $('#DV_SH #txtFName').val().trim();
            objBO.OVD_HolderMiddleName = $('#DV_SH #txtMName').val().trim();
            objBO.OVD_HolderLastName = $('#DV_SH #txtLName').val().trim();
            objBO.OVD_HolderDOB = $('#DV_SH #txtDOB').val();
        }
        else if (!$.isEmptyObject(HolderType) && HolderType == '03')
        {
            objBO.OVD_HolderFirstName = $('#DV_TH #txtFName').val().trim();
            objBO.OVD_HolderMiddleName = $('#DV_TH #txtMName').val().trim();
            objBO.OVD_HolderLastName = $('#DV_TH #txtLName').val().trim();
            objBO.OVD_HolderDOB = $('#DV_TH #txtDOB').val();
        }
        objBO.Appl_No = $('#lblApplicationNumber').text();
        objBO.OVD_Task = 'DX';
        objBO.Source_Type = 'CPTP_UNI';
        objBO.Source_Sub_Type = 'CPTP_UNI';
        objBO.Holder_Type = HolderType;

        //individual pan
        if ($.isEmptyObject(Doc_Ref_No) && sub_doc_type.toUpperCase().match('PAN') == 'PAN'
            && BTP_OBJECT.IND_NIND == 'IND')
        {
            objBO.OVD_Type = 'CI';
            objBO.OVD_Number = '';

            ExtendedAjaxCall('Signzy_Services/Extract_PAN_Data', objBO, 'POST', function (result) 
            {
                try
                {
                    var panResult = result;
                    if (!$.isEmptyObject(result.result) && !$.isEmptyObject(result.result.response.result)
                        && !$.isEmptyObject(result.result.response.result.number))
                    {
                        $(refNo).val(result.result.response.result.number);
                    }

                    $('#preloader').hide();

                } catch (e)
                {

                }
            }, null, true, true, false, ErrorFunction);
        }
        //non-individual pan
        else if ($.isEmptyObject(Doc_Ref_No) && sub_doc_type.toUpperCase().match('PAN') == 'PAN'
            && BTP_OBJECT.IND_NIND != 'IND')
        {
            objBO.OVD_Type = 'CB';
            objBO.OVD_Number = '';

            ExtendedAjaxCall('Signzy_Services/Extract_PAN_Data', objBO, 'POST', function (result) 
            {
                try
                {
                    if (!$.isEmptyObject(result.result) && !$.isEmptyObject(result.result.response.result)
                        && !$.isEmptyObject(result.result.response.result.number))
                    {
                        $(refNo).val(result.result.response.result.number);
                    }

                    $('#preloader').hide();

                } catch (e)
                {

                }
            }, null, true, true, false, ErrorFunction);
        }
        //driving licence
        else if ($.isEmptyObject(Doc_Ref_No) && sub_doc_type.toUpperCase().match('DRIVING') == 'DRIVING')
        {
            objBO.OVD_Type = 'D';
            objBO.OVD_Number = '';

            ExtendedAjaxCall('Signzy_Services/Extract_PAN_Data', objBO, 'POST', function (result) 
            {
                try
                {
                    if (!$.isEmptyObject(result.result) && !$.isEmptyObject(result.result.response.result)
                        && !$.isEmptyObject(result.result.response.result.number))
                    {
                        $(refNo).val(result.result.response.result.number);
                    }

                    $('#preloader').hide();

                } catch (e)
                {
                    console.error(e);
                }
            }, null, true, true, false, ErrorFunction);
        }

    } catch (e)
    {
        console.error(e);
    }
}

const SignzyFileSizeValidation = function (file)
{
    try
    {
        if (!$.isEmptyObject(file) && Math.round((file.size / 1024 / 1024), 2) > 2.00)
        {
            MessagePopup('<p>Selecteddocumentcouldnotbeuploaded. Exceedingthemaximumfilesizeof2MB!!</p>', 'error');
            return false;
        }
        return true;

    } catch (e)
    {
        fnException();
    }
}

const FH_CKYC_Search = function (Appl_No, OVDRefType, OVDRefNo, DOB)
{
    var objBO = {
        Appl_No: null,
        InvestorType: "01",
        OVDRefType: OVDRefType,
        OVDRefNo: OVDRefNo,
        DOB: DOB
    };
    ExtendedAjaxCall('CKYC_Search/CKYC_Search', objBO, 'POST', function (result)
    {
        try
        {
            if (!$.isEmptyObject(result) && result.Status == 1)
            {
                if (!$.isEmptyObject(result.result) && result.result[0].Status == 1)
                {
                    //validations
                    $('#ddlInvtitle,#txtInvFirstName,#txtInvMiddleName,#txtInvLastName,#txtInvPan,#txtMobile,#txtEmail').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                    $('#DV_FH .HOLD_DTL,#DV_FH .MORE_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                    var row = result.result[0];
                    BTP_OBJECT.FH_DATA_SOURCE = 'CKYC';
                    BTP_OBJECT.InvCountFolioYear = 0;

                    //title
                    $('#ddlInvtitle').val(row.NamePrefix).change();

                    //name
                    $('#txtInvFirstName').val(row.Holder_F_Name).change();
                    $('#txtInvMiddleName').val(row.Holder_M_Name).change();
                    $('#txtInvLastName').val(row.Holder_L_Name).change();
                    $('#lblInvestorName').text(row.Holder_Full_Name);

                    //gender
                    $('#DV_FH #ddlGender').val(row.Gender).change();

                    //dob
                    $('#txtInvDOB').datetextentry('set_date', row.DOB).focusout();
                    $('#lblDOB').text(row.Display_DOB);
                    InvDOB_Change();

                    //pan
                    $('#txtInvPan').val(row.PAN).change();
                    $('#lblPAN').text(row.PAN);

                    //mobile
                    $('#txtMobile').val(row.MOBILE_NO).change();
                    $('#lblMobileNumber').text(row.MOBILE_NO);

                    //email
                    $('#txtEmail').val(row.EMAIL_ID).change();
                    $('#lblEmailID').val(row.EMAIL_ID);

                    //tel no
                    $('#DV_FH_P_ADDR #txtTelephone').val(row.TEL_RES);

                    //maritalstatus
                    $('#DV_FH #ddlMaritalStatus').val(row.MARITAL_STATUS).change();

                    //father name
                    $('#DV_FH #ddlFatherTitle').val(row.Holder_Father_Prefix);
                    $('#DV_FH #txtFatherFName').val(row.Holder_Father_F_Name);
                    $('#DV_FH #txtFatherMName').val(row.Holder_Father_M_Name);
                    $('#DV_FH #txtFatherLName').val(row.Holder_Father_L_Name);

                    //mother name
                    $('#DV_FH #ddlMotherTitle').val(row.Holder_Mother_Prefix);
                    $('#DV_FH #txtMotherFName').val(row.Holder_Mother_F_Name);
                    $('#DV_FH #txtMotherMName').val(row.Holder_Mother_M_Name);
                    $('#DV_FH #txtMotherLName').val(row.Holder_Mother_L_Name);

                    //spouse name
                    $('#DV_FH #ddlSpouseTitle').val(row.Holder_Spouse_Prefix);
                    $('#DV_FH #txtSpouseFName').val(row.Holder_Spouse_F_Name);
                    $('#DV_FH #txtSpouseMName').val(row.Holder_Spouse_M_Name);
                    $('#DV_FH #txtSpouseLName').val(row.Holder_Spouse_L_Name);

                    //guardian name
                    $('#DV_FH #ddlGuardianTitle').val(row.Holder_Guardian_Prefix);
                    $('#DV_FH #txtGuardianFName').val(row.Holder_Guardian_F_Name);
                    $('#DV_FH #txtGuardianMName').val(row.Holder_Guardian_M_Name);
                    $('#DV_FH #txtGuardianLName').val(row.Holder_Guardian_L_Name);
                    $('#DV_FH #txtGuardianPAN').val(row.Holder_Guardian_PAN);

                    //occupation
                    $('#DV_FH #ddlOccupation').val(row.OccupationType);

                    //ckyc no
                    $('#txtInvCKYCNumber').val(row.CKYCNumber);

                    //PER 
                    if (!$.isEmptyObject(row.ADD1))
                    {
                        $('#DV_FH_P_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                        $('#DV_FH_P_ADDR #txtAdd1').val(row.ADD1);
                        $('#DV_FH_P_ADDR #txtAdd2').val(row.ADD2);
                        $('#DV_FH_P_ADDR #txtAdd3').val(row.ADD3);
                        $('#DV_FH_P_ADDR #ddlCountry').val(row.CountryCode).change();
                        $('#DV_FH_P_ADDR #txtCity').val(row.CITY);
                        $('#DV_FH_P_ADDR #txtState').val(row.STATE);
                        $('#DV_FH_P_ADDR #txtDistrict').val(row.DISTRICT);
                        $('#DV_FH_P_ADDR #txtPin').val(row.PINCODE).keyup();
                    }

                    //Mailing
                    if (!$.isEmptyObject(row.M_ADD1))
                    {
                        $('#chkIsFHAddrSameAsPermanent').prop('disabled', true);
                        $('#DV_FH_M_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                        $('#DV_FH_M_ADDR #txtAdd1').val(row.M_ADD1);
                        $('#DV_FH_M_ADDR #txtAdd2').val(row.M_ADD2);
                        $('#DV_FH_M_ADDR #txtAdd3').val(row.M_ADD3);
                        $('#DV_FH_M_ADDR #ddlCountry').val(row.M_CountryCode).change();
                        $('#DV_FH_M_ADDR #txtState').val(row.M_STATE);
                        $('#DV_FH_M_ADDR #txtDistrict').val(row.M_DISTRICT);
                        $('#DV_FH_M_ADDR #txtCity').val(row.M_CITY);
                        $('#DV_FH_M_ADDR #txtPin').val(row.M_PINCODE).keyup();
                    }

                    if (!$.isEmptyObject(row.O_ADD1))
                    {
                        $('#chkIdOverSeasAddress').prop('checked', true).change();

                        $('#txtOAdd1').val(row.O_ADD1);
                        $('#txtOAdd2').val(row.O_ADD2);
                        $('#txtOAdd3').val(row.O_ADD3);
                        $('#ddlOCountry').val(row.O_CountryCode).change();
                        $('#txtOState').val(row.O_STATE);
                        $('#txtOCity').val(row.O_CITY);
                        $('#txtOPin').val(row.O_PINCODE).keyup();

                    }

                    //FH ckyc validations
                    FH_CKYC_Validations();

                    //validations
                    $('#ddl_CKYC_SearchBy').val('select');
                    $('#txt_CKYC_SearchByRef').val('');
                    $('#txt_CKYC_SearchDOB').datetextentry('set_date', null);
                    $('#btnFHAddManually').hide();

                    $('#IdInfoDiv').slideDown();
                    $('#DV_FH_CKYC_SEARCH').hide();
                    $('#DV_INV_DETAILS').show();
                }
            }
            else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg))
            {
                $('#btnFHAddManually').show();
                BtpMessagePopup(result.Msg, "error");
            }
            else
            {
                $('#btnFHAddManually').show();
                BtpMessagePopup("<p>No Record Found</p>", "error");
            }

            $('#preloader').hide();

        } catch (e)
        {
            fnException(e);
        }
    }, null, true, true, false, ErrorFunction);

}

//first holder ckyc validations
const FH_CKYC_Validations = function ()
{
    try
    {
        $('#DV_FH .HOLD_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        $('#DV_FH .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        $('#DV_FH .MORE_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //title  
        if ($('#ddlInvtitle').val() == 'select')
            $('#ddlInvtitle').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //name
        $('#txtInvFirstName').prop('required', true);
        $('#txtInvFirstName,#txtInvMiddleName,#txtInvLastName').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //gender
        if ($('#DV_FH #ddlGender').val() == 'select')
            $('#DV_FH #ddlGender').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //dob
        if (BTP_OBJECT.IND_NIND == 'IND')
        {
            if ($.isEmptyObject($('#txtInvDOB').val()))
            {
                $('#txtInvDOB').datetextentry('set_readonly', false);
                $('#txtInvDOB').parent().addClass('InputBordeRed');
            }
            else
            {
                $('#txtInvDOB').datetextentry('set_readonly', true);
                $('#txtInvDOB').parent().removeClass('InputBordeRed');
            }
        }
        else
        {
            if ($.isEmptyObject($('#txtInvDOI').val()))
            {
                $('#txtInvDOI').datetextentry('set_readonly', false);
                $('#txtInvDOI').parent().addClass('InputBordeRed');
            }
            else
            {
                $('#txtInvDOI').datetextentry('set_readonly', true);
                $('#txtInvDOI').parent().removeClass('InputBordeRed');
            }
        }
        //else
        //{
        //    $('#txtInvDOB,#txtInvDOI').datetextentry('set_date', null).datetextentry('set_readonly', false);
        //}

        //pan
        if ($.isEmptyObject($('#txtInvPan').val()) && (!IsMinor($('#txtInvDOB').val()) || BTP_OBJECT.IND_NIND != 'IND'))
            $('#txtInvPan').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        else
            $('#txtInvPan').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //CKYC No
        $('#txtInvCKYCNumber').prop('required', true).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //ckyc no
        $('#DV_FH #txtCKYCNumber').prop('disabled', true).addClass('DisabledControl');


        //Guard pan 
        if ($.isEmptyObject($('#DV_FH #txtGuardianPAN').val()) && (IsMinor($('#DV_FH #txtDOB').val()) && BTP_OBJECT.IND_NIND == 'IND'))
            $('#DV_FH #txtGuardianPAN').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard title 
        if ($.isEmptyObject($('#DV_FH #ddlGuardianTitle').val()) && (IsMinor($('#DV_FH #txtDOB').val()) && BTP_OBJECT.IND_NIND == 'IND'))
            $('#DV_FH #ddlGuardianTitle').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard name 
        if ($.isEmptyObject($('#DV_FH #txtGuardianFName').val()) && (IsMinor($('#DV_FH #txtDOB').val()) && BTP_OBJECT.IND_NIND == 'IND'))
            $('#DV_FH #txtGuardianFName').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mobile
        if ($.isEmptyObject($('#txtMobile').val()))
            $('#txtMobile').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        else
            $('#txtMobile').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //email
        if ($.isEmptyObject($('#txtEmail').val()))
            $('#txtEmail').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        else
            $('#txtEmail').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //either father/mother/spouse name is required
        if ($.isEmptyObject($('#DV_FH #txtFatherFName').val())
            && $.isEmptyObject($('#DV_FH #txtMotherFName').val())
            && $.isEmptyObject($('#DV_FH #txtSpouseFName').val()))
        {
            $('#DV_FH #ddlFatherTitle').val('MR').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_FH #ddlMotherTitle').val('MRS').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_FH #ddlSpouseTitle').val('select').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_FH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');
        }

        //Occupation
        if ($('#DV_FH #ddlOccupation').val() == 'select') {
            $('#DV_FH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            $('#DV_FH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //AnnualIncome
        if ($('#DV_FH #ddlAnnualIncome').val() == 'select') {
            $('#DV_FH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            $('#DV_FH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent address1
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtAdd1').val()))
        {
            $('#DV_FH_P_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_FH_P_ADDR #txtAdd2,#DV_FH_P_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_FH_P_ADDR #ddlCountry').val() == 'select')
            $('#DV_FH_P_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent pincode
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtPin').val()))
            $('#DV_FH_P_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent city
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtCity').val()))
            $('#DV_FH_P_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent state/district
        if ($('#DV_FH_P_ADDR #ddlCountry').val() != 'IN')
        {
            if ($.isEmptyObject($('#DV_FH_P_ADDR #txtState').val()))
                $('#DV_FH_P_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_FH_P_ADDR #txtDistrict').val()))
                $('#DV_FH_P_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtAdd1').val()))
        {
            $('#DV_FH_M_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_FH_M_ADDR #txtAdd2,#DV_FH_M_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_FH_M_ADDR #ddlCountry').val() == 'select')
            $('#DV_FH_M_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing pincode
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtPin').val()))
            $('#DV_FH_M_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing city
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtCity').val()))
            $('#DV_FH_M_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        if ($('#DV_FH_M_ADDR #ddlCountry').val() != 'IN')
        {
            if ($.isEmptyObject($('#DV_FH_M_ADDR #txtState').val()))
                $('#DV_FH_M_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_FH_M_ADDR #txtDistrict').val()))
                $('#DV_FH_M_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

        //overseas address1
        if ($('#chkIdOverSeasAddress').prop('checked'))
        {
            if ($.isEmptyObject($('#txtOAdd1').val()))
            {
                $('#txtOAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
                $('#txtOAdd2,#txtOAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
            }

            //overseas country
            if ($('#ddlOCountry').val() == 'select')
                $('#ddlOCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            //overseas pincode
            if ($.isEmptyObject($('#txtOPin').val()))
                $('#txtOPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            //overseas city
            if ($.isEmptyObject($('#txtOCity').val()))
                $('#txtOCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#txtOState').val()))
                $('#txtOState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

    } catch (e)
    {
        fnException(e);
    }
}

//second holder ckyc validations
const SH_CKYC_Validations = function ()
{
    try
    {
        $('#DV_SH .HOLD_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        $('#DV_SH .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        $('#DV_SH .MORE_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //title 
        if ($('#DV_SH #ddlTitle').val() == 'select')
            $('#DV_SH #ddlTitle').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //name

        $('#DV_SH #txtFName').prop('required', true).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        $('#DV_SH #txtMName,#DV_SH #txtLName').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');


        //gender
        if ($('#DV_SH #ddlGender').val() == 'select')
            $('#DV_SH #ddlGender').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //dob
        if ($.isEmptyObject($('#DV_SH #txtDOB').val()))
        {
            $('#DV_SH #txtDOB').datetextentry('set_readonly', false);
            $('#DV_SH #txtDOB').parent().addClass('InputBorderRed');
        }
        else
        {
            $('#DV_SH #txtDOB').datetextentry('set_readonly', true);
            $('#DV_SH #txtDOB').parent().removeClass('InputBorderRed');
        }

        //pan
        if ($.isEmptyObject($('#DV_SH #txtPAN').val()) && !IsMinor($('#DV_SH #txtDOB').val()))
            $('#DV_SH #txtPAN').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        else
            $('#DV_SH #txtPAN').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //Guard pan 
        if ($.isEmptyObject($('#DV_SH #txtGuardianPAN').val()) && IsMinor($('#DV_SH #txtDOB').val()))
            $('#DV_SH #txtGuardianPAN').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard title 
        if ($.isEmptyObject($('#DV_SH #ddlGuardianTitle').val()) && IsMinor($('#DV_SH #txtDOB').val()))
            $('#DV_SH #ddlGuardianTitle').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard name 
        if ($.isEmptyObject($('#DV_SH #txtGuardianFName').val()) && IsMinor($('#DV_SH #txtDOB').val()))
            $('#DV_SH #txtGuardianFName').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mobile
        if ($.isEmptyObject($('#DV_SH #txtMobileNo').val()))
            $('#DV_SH #txtMobileNo').prop('disabled', false).removeClass('DisabledControl');

        //email
        if ($.isEmptyObject($('#DV_SH #txtEmailId').val()))
            $('#DV_SH #txtEmailId').prop('disabled', false).removeClass('DisabledControl');

        //either father/mother/spouse name is required
        if ($.isEmptyObject($('#DV_SH #txtFatherFName').val())
            && $.isEmptyObject($('#DV_SH #txtMotherFName').val())
            && $.isEmptyObject($('#DV_SH #txtSpouseFName').val()))
        {
            $('#DV_SH #ddlFatherTitle').val('MR').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_SH #ddlMotherTitle').val('MRS').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_SH #ddlSpouseTitle').val('select').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');
        }

        //ckyc no
        $('#DV_SH #txtCKYCNumber').prop('disabled', true).addClass('DisabledControl');

        //Occupation
        if ($('#DV_SH #ddlOccupation').val() == 'select') {
            $('#DV_SH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
       

        //AnnualIncome
        if ($('#DV_SH #ddlAnnualIncome').val() == 'select') {
            $('#DV_SH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
      

        //permanent address1
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtAdd1').val()))
        {
            $('#DV_SH_P_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_SH_P_ADDR #txtAdd2,#DV_SH_P_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_SH_P_ADDR #ddlCountry').val() == 'select')
            $('#DV_SH_P_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent pincode
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtPin').val()))
            $('#DV_SH_P_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent city
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtCity').val()))
            $('#DV_SH_P_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent state/district
        if ($('#DV_SH_P_ADDR #ddlCountry').val() != 'IN')
        {
            if ($.isEmptyObject($('#DV_SH_P_ADDR #txtState').val()))
                $('#DV_SH_P_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_SH_P_ADDR #txtDistrict').val()))
                $('#DV_SH_P_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtAdd1').val()))
        {
            $('#DV_SH_M_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_SH_M_ADDR #txtAdd2,#DV_SH_M_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_SH_M_ADDR #ddlCountry').val() == 'select')
            $('#DV_SH_M_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing pincode
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtPin').val()))
            $('#DV_SH_M_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing city
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtCity').val()))
            $('#DV_SH_M_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        if ($('#DV_SH_M_ADDR #ddlCountry').val() != 'IN')
        {
            if ($.isEmptyObject($('#DV_SH_M_ADDR #txtState').val()))
                $('#DV_SH_M_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_SH_M_ADDR #txtDistrict').val()))
                $('#DV_SH_M_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }


    } catch (e)
    {
        fnException(e);
    }
}

//third holder ckyc validations
const TH_CKYC_Validations = function ()
{
    try
    {
        $('#DV_TH .HOLD_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        $('#DV_TH .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        $('#DV_TH .MORE_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //title 
        if ($('#DV_TH #ddlTitle').val() == 'select')
            $('#DV_TH #ddlTitle').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //name      
        $('#DV_TH #txtFName').prop('required', true).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
        $('#DV_TH #txtFName,#DV_TH #txtMName,#DV_TH #txtLName').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //gender
        if ($('#DV_TH #ddlGender').val() == 'select')
            $('#DV_TH #ddlGender').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //dob
        if ($.isEmptyObject($('#DV_TH #txtDOB').val()))
        {
            $('#DV_TH #txtDOB').datetextentry('set_readonly', false);
            $('#DV_TH #txtDOB').parent().addClass('InputBorderRed');
        }
        else
        {
            $('#DV_TH #txtDOB').datetextentry('set_readonly', true);
            $('#DV_TH #txtDOB').parent().removeClass('InputBorderRed');
        }

        //pan
        if ($.isEmptyObject($('#DV_TH #txtPAN').val()) && !IsMinor($('#DV_TH #txtDOB').val()))
            $('#DV_TH #txtPAN').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        else
            $('#DV_TH #txtPAN').prop('required', true).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

        //Guard pan 
        if ($.isEmptyObject($('#DV_TH #txtGuardianPAN').val()) && IsMinor($('#DV_TH #txtDOB').val()))
            $('#DV_TH #txtGuardianPAN').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard title 
        if ($.isEmptyObject($('#DV_TH #ddlGuardianTitle').val()) && IsMinor($('#DV_TH #txtDOB').val()))
            $('#DV_TH #ddlGuardianTitle').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //Guard name 
        if ($.isEmptyObject($('#DV_TH #txtGuardianFName').val()) && IsMinor($('#DV_TH #txtDOB').val()))
            $('#DV_TH #txtGuardianFName').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mobile
        if ($.isEmptyObject($('#DV_TH #txtMobileNo').val()))
            $('#DV_TH #txtMobileNo').prop('disabled', false).removeClass('DisabledControl');

        //email
        if ($.isEmptyObject($('#DV_TH #txtEmailId').val()))
            $('#DV_TH #txtEmailId').prop('disabled', false).removeClass('DisabledControl');

        //either father/mother/spouse name is required
        if ($.isEmptyObject($('#DV_TH #txtFatherFName').val())
            && $.isEmptyObject($('#DV_TH #txtMotherFName').val())
            && $.isEmptyObject($('#DV_TH #txtSpouseFName').val()))
        {
            $('#DV_TH #ddlFatherTitle').val('MR').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtFatherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtFatherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtFatherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_TH #ddlMotherTitle').val('MRS').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtMotherFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtMotherMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtMotherLName').prop('disabled', false).removeClass('DisabledControl');

            $('#DV_TH #ddlSpouseTitle').val('select').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtSpouseFName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtSpouseMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtSpouseLName').prop('disabled', false).removeClass('DisabledControl');
        }

        //ckyc no
        $('#DV_TH #txtCKYCNumber').prop('disabled', true).addClass('DisabledControl');

        //Occupation
        if ($('#DV_TH #ddlOccupation').val() == 'select') {
            $('#DV_TH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            $('#DV_TH #ddlOccupation').prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //AnnualIncome
        if ($('#DV_TH #ddlAnnualIncome').val() == 'select') {
            $('#DV_TH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }
        else {
            $('#DV_TH #ddlAnnualIncome').prop('required', true).prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }


        //permanent address1
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtAdd1').val()))
        {
            $('#DV_TH_P_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_TH_P_ADDR #txtAdd2,#DV_TH_P_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_TH_P_ADDR #ddlCountry').val() == 'select')
            $('#DV_TH_P_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent pincode
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtPin').val()))
            $('#DV_TH_P_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent city
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtCity').val()))
            $('#DV_TH_P_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //permanent state/district
        if ($('#DV_TH_P_ADDR #ddlCountry').val() != 'IN')
        {
            if ($.isEmptyObject($('#DV_TH_P_ADDR #txtState').val()))
                $('#DV_TH_P_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_TH_P_ADDR #txtDistrict').val()))
                $('#DV_TH_P_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtAdd1').val()))
        {
            $('#DV_TH_M_ADDR #txtAdd1').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
            $('#DV_TH_M_ADDR #txtAdd2,#DV_TH_M_ADDR #txtAdd3').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_TH_M_ADDR #ddlCountry').val() == 'select')
            $('#DV_TH_M_ADDR #ddlCountry').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing pincode
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtPin').val()))
            $('#DV_TH_M_ADDR #txtPin').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        //mailing city
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtCity').val()))
            $('#DV_TH_M_ADDR #txtCity').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

        if ($('#DV_TH_M_ADDR #ddlCountry').val() != 'IN')
        {
            if ($.isEmptyObject($('#DV_TH_M_ADDR #txtState').val()))
                $('#DV_TH_M_ADDR #txtState').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');

            if ($.isEmptyObject($('#DV_TH_M_ADDR #txtDistrict').val()))
                $('#DV_TH_M_ADDR #txtDistrict').prop('disabled', false).removeClass('DisabledControl').addClass('InputBorderRed');
        }


    } catch (e)
    {
        fnException(e);
    }
}

//FH ckyc search
$('#btn_CKYC_SearchByCersai').click(function ()
{
    $("#FH_PEP").show();
    var OVDRefType = $('#ddl_CKYC_SearchBy').val();
    var PAN = $('#txt_CKYC_SearchByRef').val();
    var DOB = $('#txt_CKYC_SearchDOB').val();

    if ($.isEmptyObject(PAN) && OVDRefType == 'PAN')
    {
        BtpMessagePopup('Please enter PAN number', 'error');
        return;
    }
    else if ($.isEmptyObject(PAN) && OVDRefType == 'CKYC')
    {
        BtpMessagePopup('Please enter CKYC number', 'error');
        return;
    }
    else if (!IsValidPAN(PAN) && OVDRefType == 'PAN')
    {
        BtpMessagePopup('Please enter valid PAN number', 'error');
        return;;
    }
    else if ($.isEmptyObject(DOB))
    {
        BtpMessagePopup('Please enter DOB', 'error');
        return;;
    }

    FH_CKYC_Search(null, OVDRefType, PAN, DOB);

});

$('#btnFHAddManually').click(function ()
{
    $('#ddl_CKYC_SearchBy').val('select');
    $('#txt_CKYC_SearchByRef').val('');
    $('#txt_CKYC_SearchDOB').datetextentry('set_date', null);
    $('#btnFHAddManually').hide();

    $('#DV_FH_CKYC_SEARCH').hide();
    $('#DV_INV_DETAILS').show();
    //avinash added occupation
    BindDDLExtendedAjaxCall('#DV_FH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);

    $("#FH_PEP").show();
});

//SH ckyc search
$('#btn_SH_CKYC_Search').click(function ()
{
    try
    {
        let OVDRefType = $('#ddl_SH_CKYC_SearchBy').val();
        let PAN = $('#txt_SH_CKYC_SearchByRef').val();
        let DOB = $('#txt_SH_CKYC_Search_DOB').val();

        if ($.isEmptyObject(PAN) && OVDRefType == 'PAN')
        {
            BtpMessagePopup('Please enter PAN number', 'error');
            return;
        }
        else if ($.isEmptyObject(PAN) && OVDRefType == 'CKYC')
        {
            BtpMessagePopup('Please enter CKYC number', 'error');
            return;
        }
        else if (!IsValidPAN(PAN) && OVDRefType == 'PAN')
        {
            BtpMessagePopup('Please enter valid PAN number', 'error');
            return;;
        }
        else if ($.isEmptyObject(DOB))
        {
            BtpMessagePopup('Please enter DOB', 'error');
            return;;
        }


        var objBO = {
            Appl_No: $('#lblApplicationNumber').text(),
            InvestorType: "02",
            OVDRefType: OVDRefType,
            OVDRefNo: PAN,
            DOB: DOB
        };
        ExtendedAjaxCall('CKYC_Search/CKYC_Search', objBO, 'POST', function (result)
        {
            try
            {
                if (!$.isEmptyObject(result) && result.Status == 1)
                {
                    if (!$.isEmptyObject(result.result) && result.result[0].Status == 1)
                    {
                        $('#DV_SH .HOLD_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_SH .MORE_DTL').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                        let row = result.result[0];
                        BTP_OBJECT.SH_DATA_SOURCE = 'CKYC';
                        BTP_OBJECT.SHCountFolioYear = 0;

                        //title
                        $('#DV_SH #ddlTitle').val(row.NamePrefix).change();

                        //name
                        $('#DV_SH #txtFName').val(row.Holder_F_Name).change();
                        $('#DV_SH #txtMName').val(row.Holder_M_Name).change();
                        $('#DV_SH #txtLName').val(row.Holder_L_Name).change();

                        //gender
                        $('#DV_SH #ddlGender').val(row.Gender).change();

                        //dob
                        $('#DV_SH #txtDOB').datetextentry('set_date', row.DOB).focusout();
                        SHDOBChange();

                        //pan
                        $('#DV_SH #txtPAN').val(row.PAN).change();

                        //mobile
                        $('#DV_SH #txtMobileNo').val(row.MOBILE_NO).change();

                        //email
                        $('#DV_SH #txtEmailId').val(row.EMAIL_ID).change();

                        //tel no
                        $('#DV_SH_P_ADDR #txtTelephone').val(row.TEL_RES);

                        //maritalstatus
                        $('#DV_SH #ddlMaritalStatus').val(row.MARITAL_STATUS).change();

                        //father name
                        $('#DV_SH #ddlFatherTitle').val(row.Holder_Father_Prefix);
                        $('#DV_SH #txtFatherFName').val(row.Holder_Father_F_Name);
                        $('#DV_SH #txtFatherMName').val(row.Holder_Father_M_Name);
                        $('#DV_SH #txtFatherLName').val(row.Holder_Father_L_Name);

                        //mother name
                        $('#DV_SH #ddlMotherTitle').val(row.Holder_Mother_Prefix);
                        $('#DV_SH #txtMotherFName').val(row.Holder_Mother_F_Name);
                        $('#DV_SH #txtMotherMName').val(row.Holder_Mother_M_Name);
                        $('#DV_SH #txtMotherLName').val(row.Holder_Mother_L_Name);

                        //spouse name
                        $('#DV_SH #ddlSpouseTitle').val(row.Holder_Spouse_Prefix);
                        $('#DV_SH #txtSpouseFName').val(row.Holder_Spouse_F_Name);
                        $('#DV_SH #txtSpouseMName').val(row.Holder_Spouse_M_Name);
                        $('#DV_SH #txtSpouseLName').val(row.Holder_Spouse_L_Name);

                        //guardian name
                        $('#DV_SH #ddlGuardianTitle').val(row.Holder_Guardian_Prefix);
                        $('#DV_SH #txtGuardianFName').val(row.Holder_Guardian_F_Name);
                        $('#DV_SH #txtGuardianMName').val(row.Holder_Guardian_M_Name);
                        $('#DV_SH #txtGuardianLName').val(row.Holder_Guardian_L_Name);
                        $('#DV_SH #txtGuardianPAN').val(row.Holder_Guardian_PAN);

                        //occupation
                        $('#DV_SH #ddlOccupation').val(row.OccupationType);

                        //avinash added
                        BindDDLExtendedAjaxCall('#DV_SH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);
                        $('#DV_SH #ddlCustSegType').val('select');

                        if ($("#DV_SH_MD #ddlCustSegType").val() == "select") {
                            $("#DV_SH_MD #Occ_Cus_SegSubtype_Div").hide();
                        }
                        else {
                            $("#DV_SH_MD #Occ_Cus_SegSubtype_Div").show();
                        }


                        //ckyc no
                        $('#DV_SH #txtCKYCNumber').val(row.CKYCNumber);

                        //PER
                        if (!$.isEmptyObject(row.ADD1))
                        {
                            $('#DV_SH_P_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                            $('#chkIsSHAddrSameAsFH').prop('disabled', true);

                            $('#DV_SH_P_ADDR #txtAdd1').val(row.ADD1);
                            $('#DV_SH_P_ADDR #txtAdd2').val(row.ADD2);
                            $('#DV_SH_P_ADDR #txtAdd3').val(row.ADD3);
                            $('#DV_SH_P_ADDR #ddlCountry').val(row.CountryCode).change();
                            $('#DV_SH_P_ADDR #txtCity').val(row.CITY);
                            $('#DV_SH_P_ADDR #txtState').val(row.STATE);
                            $('#DV_SH_P_ADDR #txtDistrict').val(row.DISTRICT);
                            $('#DV_SH_P_ADDR #txtPin').val(row.PINCODE).keyup();
                        }

                        //Mailing
                        if (!$.isEmptyObject(row.M_ADD1))
                        {
                            $('#chkIsSHAddrSameAsPermanent').prop('disabled', true);
                            $('#DV_SH_M_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                            $('#DV_SH_M_ADDR #txtAdd1').val(row.M_ADD1);
                            $('#DV_SH_M_ADDR #txtAdd2').val(row.M_ADD2);
                            $('#DV_SH_M_ADDR #txtAdd3').val(row.M_ADD3);
                            $('#DV_SH_M_ADDR #ddlCountry').val(row.M_CountryCode).change();
                            $('#DV_SH_M_ADDR #txtState').val(row.M_STATE);
                            $('#DV_SH_M_ADDR #txtDistrict').val(row.M_DISTRICT);
                            $('#DV_SH_M_ADDR #txtCity').val(row.M_CITY);
                            $('#DV_SH_M_ADDR #txtPin').val(row.M_PINCODE).keyup();
                        }

                        //SH ckyc validations
                        SH_CKYC_Validations();

                        //validations
                        $('#ddl_SH_CKYC_SearchBy').val('select');
                        $('#txt_SH_CKYC_SearchByRef').val('');
                        $('#txt_SH_CKYC_Search_DOB').datetextentry('set_date', null);
                        $('#btnSHAddManually').hide();
                        $('#DV_PROV_SH').hide();
                        $('#DV_SH_SEARCH').hide();
                        $('#DV_SH_CKYC_SEARCH').hide();
                        $('#DV_SH_DTLS').show();
                    }
                }
                else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg))
                {
                    $('#btnSHAddManually').show();
                    BtpMessagePopup(result.Msg, "error");
                }
                else
                {
                    $('#btnSHAddManually').show();
                    BtpMessagePopup("<p>No Record Found</p>", "error");
                }

                $('#preloader').hide();

            } catch (e)
            {
                fnException(e);
            }
        }, null, true, true, false, ErrorFunction);

        $("#SH_PEP").show();

    } catch (e)
    {
        fnException(e);
    }
});

$('#btnSHAddManually').click(function ()
{
    $('#DV_SH .HOLD_DTL').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
    $('#DV_SH .MORE_DTL').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
    $('#DV_SH_P_ADDR .ADDR').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
    $('#DV_SH_M_ADDR .ADDR').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
    $('#DV_SH #txtDOB').prop('disabled', false);
    $('#DV_SH #txtDOB').parent().removeClass('DisabledControl').removeClass('InputBorderRed');

    $('#ddl_SH_CKYC_SearchBy').val('select');
    $('#txt_SH_CKYC_SearchByRef').val('');
    $('#txt_SH_CKYC_Search_DOB').datetextentry('set_date', null);
    $('#btnSHAddManually').hide();

    $('#DV_PROV_SH').hide();
    $('#DV_SH_SEARCH').hide();
    $('#DV_SH_CKYC_SEARCH').hide();
    $('#DV_SH_DTLS').show();
    $('#DV_SH #txtDOB').datetextentry('set_readonly', false);
    //avinash added occupation
    BindDDLExtendedAjaxCall('#DV_SH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);

    if ($("#DV_SH_MD #ddlCustSegType").val() == "select") {
        $("#DV_SH #Occ_Cus_SegSubtype_Div").hide();
    }
    else {
        $("#DV_SH #Occ_Cus_SegSubtype_Div").show();
    }

    $("#SH_PEP").show();
});

//TH ckyc search
$('#btn_TH_CKYC_Search').click(function ()
{
    try
    {
        let OVDRefType = $('#ddl_TH_CKYC_SearchBy').val();
        let PAN = $('#txt_TH_CKYC_SearchByRef').val();
        let DOB = $('#txt_TH_CKYC_Search_DOB').val();

        if ($.isEmptyObject(PAN) && OVDRefType == 'PAN')
        {
            BtpMessagePopup('Please enter PAN number', 'error');
            return;
        }
        else if ($.isEmptyObject(PAN) && OVDRefType == 'CKYC')
        {
            BtpMessagePopup('Please enter CKYC number', 'error');
            return;
        }
        else if (!IsValidPAN(PAN) && OVDRefType == 'PAN')
        {
            BtpMessagePopup('Please enter valid PAN number', 'error');
            return;;
        }
        else if ($.isEmptyObject(DOB))
        {
            BtpMessagePopup('Please enter DOB', 'error');
            return;;
        }


        var objBO = {
            Appl_No: $('#lblApplicationNumber').text(),
            InvestorType: "03",
            OVDRefType: OVDRefType,
            OVDRefNo: PAN,
            DOB: DOB
        };
        ExtendedAjaxCall('CKYC_Search/CKYC_Search', objBO, 'POST', function (result)
        {
            try
            {
                if (!$.isEmptyObject(result) && result.Status == 1)
                {
                    if (!$.isEmptyObject(result.result) && result.result[0].Status == 1)
                    {
                        let row = result.result[0];
                        BTP_OBJECT.TH_DATA_SOURCE = 'CKYC';
                        BTP_OBJECT.THCountFolioYear = 0;

                        //title
                        $('#DV_TH #ddlTitle').val(row.NamePrefix).change();

                        //name
                        $('#DV_TH #txtFName').val(row.Holder_F_Name).change();
                        $('#DV_TH #txtMName').val(row.Holder_M_Name).change();
                        $('#DV_TH #txtLName').val(row.Holder_L_Name).change();

                        //gender
                        $('#DV_TH #ddlGender').val(row.Gender).change();

                        //dob
                        $('#DV_TH #txtDOB').datetextentry('set_date', row.DOB).focusout();
                        THDOBChange();

                        //pan
                        $('#DV_TH #txtPAN').val(row.PAN).change();

                        //mobile
                        $('#DV_TH #txtMobileNo').val(row.MOBILE_NO).change();

                        //email
                        $('#DV_TH #txtEmailId').val(row.EMAIL_ID).change();

                        //tel no
                        $('#DV_TH_P_ADDR #txtTelephone').val(row.TEL_RES);

                        //maritalstatus
                        $('#DV_TH #ddlMaritalStatus').val(row.MARITAL_STATUS).change();

                        //father name
                        $('#DV_TH #ddlFatherTitle').val(row.Holder_Father_Prefix);
                        $('#DV_TH #txtFatherFName').val(row.Holder_Father_F_Name);
                        $('#DV_TH #txtFatherMName').val(row.Holder_Father_M_Name);
                        $('#DV_TH #txtFatherLName').val(row.Holder_Father_L_Name);

                        //mother name
                        $('#DV_TH #ddlMotherTitle').val(row.Holder_Mother_Prefix);
                        $('#DV_TH #txtMotherFName').val(row.Holder_Mother_F_Name);
                        $('#DV_TH #txtMotherMName').val(row.Holder_Mother_M_Name);
                        $('#DV_TH #txtMotherLName').val(row.Holder_Mother_L_Name);

                        //spouse name
                        $('#DV_TH #ddlSpouseTitle').val(row.Holder_Spouse_Prefix);
                        $('#DV_TH #txtSpouseFName').val(row.Holder_Spouse_F_Name);
                        $('#DV_TH #txtSpouseMName').val(row.Holder_Spouse_M_Name);
                        $('#DV_TH #txtSpouseLName').val(row.Holder_Spouse_L_Name);

                        //guardian name
                        $('#DV_TH #ddlGuardianTitle').val(row.Holder_Guardian_Prefix);
                        $('#DV_TH #txtGuardianFName').val(row.Holder_Guardian_F_Name);
                        $('#DV_TH #txtGuardianMName').val(row.Holder_Guardian_M_Name);
                        $('#DV_TH #txtGuardianLName').val(row.Holder_Guardian_L_Name);
                        $('#DV_TH #txtGuardianPAN').val(row.Holder_Guardian_PAN);

                        //occupation
                        $('#DV_TH #ddlOccupation').val(row.OccupationType);

                        //avinash added
                        BindDDLExtendedAjaxCall('#DV_TH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);
                        $('#DV_TH #ddlCustSegType').val('select');


                        if ($("#DV_TH_MD #ddlCustSegType").val() == "select") {
                            $("#DV_TH_MD #Occ_Cus_SegSubtype_Div").hide();
                        }
                        else {
                            $("#DV_TH_MD #Occ_Cus_SegSubtype_Div").show();
                        }

                        //ckyc no
                        $('#DV_TH #txtCKYCNumber').val(row.CKYCNumber);

                        //PER
                        if (!$.isEmptyObject(row.ADD1))
                        {
                            $('#DV_TH_P_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                            $('#chkIsTHAddrSameAsFH').prop('disabled', true);

                            $('#DV_TH_P_ADDR #txtAdd1').val(row.ADD1);
                            $('#DV_TH_P_ADDR #txtAdd2').val(row.ADD2);
                            $('#DV_TH_P_ADDR #txtAdd3').val(row.ADD3);
                            $('#DV_TH_P_ADDR #ddlCountry').val(row.CountryCode).change();
                            $('#DV_TH_P_ADDR #txtCity').val(row.CITY);
                            $('#DV_TH_P_ADDR #txtState').val(row.STATE);
                            $('#DV_TH_P_ADDR #txtDistrict').val(row.DISTRICT);
                            $('#DV_TH_P_ADDR #txtPin').val(row.PINCODE).keyup();
                        }

                        //Mailing
                        if (!$.isEmptyObject(row.M_ADD1))
                        {
                            $('#chkIsTHAddrSameAsPermanent').prop('disabled', true);
                            $('#DV_TH_M_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                            $('#DV_TH_M_ADDR #txtAdd1').val(row.M_ADD1);
                            $('#DV_TH_M_ADDR #txtAdd2').val(row.M_ADD2);
                            $('#DV_TH_M_ADDR #txtAdd3').val(row.M_ADD3);
                            $('#DV_TH_M_ADDR #ddlCountry').val(row.M_CountryCode).change();
                            $('#DV_TH_M_ADDR #txtState').val(row.M_STATE);
                            $('#DV_TH_M_ADDR #txtDistrict').val(row.M_DISTRICT);
                            $('#DV_TH_M_ADDR #txtCity').val(row.M_CITY);
                            $('#DV_TH_M_ADDR #txtPin').val(row.M_PINCODE).keyup();
                        }

                        //TH ckyc validations
                        TH_CKYC_Validations();

                        //validations
                        $('#ddl_TH_CKYC_SearchBy').val('select');
                        $('#txt_TH_CKYC_SearchByRef').val('');
                        $('#txt_TH_CKYC_Search_DOB').datetextentry('set_date', null);
                        $('#btnTHAddManually').hide();
                        $('#DV_PROV_TH').hide();
                        $('#DV_TH_SEARCH').hide();
                        $('#DV_TH_CKYC_SEARCH').hide();
                        $('#DV_TH_DTLS').show();
                    }
                }
                else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg))
                {
                    $('#btnTHAddManually').show();
                    BtpMessagePopup(result.Msg, "error");
                }
                else
                {
                    $('#btnTHAddManually').show();
                    BtpMessagePopup("<p>No Record Found</p>", "error");
                }

                $('#preloader').hide();

            } catch (e)
            {
                fnException(e);
            }
        }, null, true, true, false, ErrorFunction);

        $("#TH_PEP").show();
    } catch (e)
    {
        fnException(e);
    }
});

$('#btnTHAddManually').click(function ()
{
    $('#DV_TH .HOLD_DTL').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
    $('#DV_TH .MORE_DTL').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
    $('#DV_TH_P_ADDR .ADDR').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
    $('#DV_TH_M_ADDR .ADDR').prop('disabled', false).removeClass('DisabledControl').removeClass('InputBorderRed');
    $('#DV_TH #txtDOB').prop('disabled', false);
    $('#DV_TH #txtDOB').parent().removeClass('DisabledControl').removeClass('InputBorderRed');

    $('#ddl_TH_CKYC_SearchBy').val('select');
    $('#txt_TH_CKYC_SearchByRef').val('');
    $('#txt_TH_CKYC_Search_DOB').datetextentry('set_date', null);
    $('#btnTHAddManually').hide();

    $('#DV_PROV_TH').hide();
    $('#DV_TH_SEARCH').hide();
    $('#DV_TH_CKYC_SEARCH').hide();
    $('#DV_TH_DTLS').show();

    $('#DV_TH #txtDOB').datetextentry('set_readonly', false);
    //avinash added occupation
    BindDDLExtendedAjaxCall('#DV_TH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);

    if ($("#DV_TH_MD #ddlCustSegType").val() == "select") {
        $("#DV_TH #Occ_Cus_SegSubtype_Div").hide();
    }
    else {
        $("#DV_TH #Occ_Cus_SegSubtype_Div").show();
    }
    $("#TH_PEP").show();
});

//provisional second holder dropdown
function BindProvSH()
{
    try
    {
        if (!$.isEmptyObject($('#lblFolioNumber').text()))
        {
            var objBO = {
                Folio: $('#lblFolioNumber').text(),
                Name: $('#ddlInvtitle').val() + ' ' + $('#txtInvFirstName').val().trim() + ' ' + $('#txtInvMiddleName').val().trim() + ' ' + $('#txtInvLastName').val().trim()
            };

            BindDDLExtendedAjaxCall('#ddlProvSH', 'HolderDetails/GetProvHolderNamesAsync', objBO, 'POST', null, null, true, false, false, ErrorFunction);

            if ($.isEmptyObject($('#DV_SH #txtFName').val()))
            {
                $('#DV_PROV_SH').show();
                $('#DV_SH_SEARCH').hide();
                $('#DV_SH_CKYC_SEARCH').hide();
                $('#DV_SH_DTLS').hide();
            }
            else
            {
                $('#DV_PROV_SH').hide();
                $('#DV_SH_SEARCH').hide();
                $('#DV_SH_CKYC_SEARCH').hide();
                $('#DV_SH_DTLS').show();
            }
        }
        else
        {
            $('#DV_PROV_SH').hide();
            if ($.isEmptyObject($('#DV_SH #txtFName').val()))
            {
                $('#DV_SH_SEARCH').show();
                $('#DV_SH_CKYC_SEARCH').hide();
                $('#DV_SH_DTLS').hide();
            }
            else
            {
                $('#DV_SH_SEARCH').hide();
                $('#DV_SH_CKYC_SEARCH').hide();
                $('#DV_SH_DTLS').show();
            }
        }
    } catch (e)
    {
        fnException(e);
    }
};

//provisional third holder dropdown
function BindProvTH()
{
    try
    {
        if (!$.isEmptyObject($('#lblFolioNumber').text()))
        {
            var objBO = {
                Folio: $('#lblFolioNumber').text(),
                Name: $('#DV_SH #ddlTitle').val() + ' ' + $('#DV_SH #txtFName').val().trim() + ' ' + $('#DV_SH #txtMName').val().trim() + ' ' + $('#DV_SH #txtLName').val().trim()
            };

            BindDDLExtendedAjaxCall('#ddlProvTH', 'HolderDetails/GetProvHolderNamesAsync', objBO, 'POST', null, null, true, false, false, ErrorFunction);
            if ($.isEmptyObject($('#DV_TH #txtFName').val()))
            {
                $('#DV_PROV_TH').show();
                $('#DV_TH_SEARCH').hide();
                $('#DV_TH_CKYC_SEARCH').hide();
                $('#DV_TH_DTLS').hide();
            }
            else
            {
                $('#DV_PROV_TH').hide();
                $('#DV_TH_SEARCH').hide();
                $('#DV_TH_CKYC_SEARCH').hide();
                $('#DV_TH_DTLS').show();
            }
        }
        else
        {
            $('#DV_PROV_TH').hide();
            if ($.isEmptyObject($('#DV_TH #txtFName').val()))
            {
                $('#DV_TH_SEARCH').show();
                $('#DV_TH_CKYC_SEARCH').hide();
                $('#DV_TH_DTLS').hide();
            }
            else
            {
                $('#DV_TH_SEARCH').hide();
                $('#DV_TH_CKYC_SEARCH').hide();
                $('#DV_TH_DTLS').show();
            }
        }
    } catch (e)
    {
        fnException(e);
    }
};

$('#btnAddNewExistingSH').click(function ()
{
    $('#DV_PROV_SH').hide();
    $('#DV_SH_SEARCH').show();
    $('#DV_SH_CKYC_SEARCH').hide();
    $('#DV_SH_DTLS').hide();
});

$('#btnAddNewExistingTH').click(function ()
{
    $('#DV_PROV_TH').hide();
    $('#DV_TH_SEARCH').show();
    $('#DV_TH_CKYC_SEARCH').hide();
    $('#DV_TH_DTLS').hide();
});

//bind prov second holder
$('#ddlProvSH').change(function ()
{
    try
    {
        if (!$.isEmptyObject(this.value) && this.value != 'select')
        {
            GetProvSH(this.value);
            $("#SH_PEP").hide();
        }
    } catch (e)
    {
        fnException(e);
    }
});

function GetProvSH(id)
{
    try
    {
        var objBO = {
            Id: id
        };

        ExtendedAjaxCall('HolderDetails/GetProvHolderDtlsAsync', objBO, 'POST', function (result)
        {
            if (!$.isEmptyObject(result))
            {
                let row = result[0];

                //header values
                $('#hdrSHFolioNo').text(row.Folio);
                $('#hdrSHExistingFDRNo').text(row.Dep_no);
                $('#hdrSHLastInvDate').text(row.Last_Inv_Date);
                BTP_OBJECT.SHCountFolioYear = row.CountFolioYear;
                BTP_OBJECT.SH_DATA_SOURCE = row.Source;
                $('#hdnSHSourceTableId').val(row.SourceTableId);

                //title  
                $('#DV_SH #ddlTitle').val(row.NamePrefix).change();;

                //name
                $('#DV_SH #txtFName').val(row.Holder_F_Name).change();
                $('#DV_SH #txtMName').val(row.Holder_M_Name).change();
                $('#DV_SH #txtLName').val(row.Holder_L_Name).change();

                //gender
                $('#DV_SH #ddlGender').val(row.Gender).change();

                //dob
                $('#DV_SH #txtDOB').datetextentry('set_date', row.DOB).datetextentry('set_readonly', true).focusout();
                SHDOBChange();

                //pan
                $('#DV_SH #txtPAN').val(row.PAN).change();

                //mobile
                $('#DV_SH #txtMobileNo').val(row.MOBILE_NO).change();

                //email
                $('#DV_SH #txtEmailId').val(row.EMAIL_ID).change();

                //maritalstatus
                $('#DV_SH #ddlMaritalStatus').val(row.MARITAL_STATUS).change();

                //father name
                $('#DV_SH #ddlFatherTitle').val(row.Holder_Father_Prefix);
                $('#DV_SH #txtFatherFName').val(row.Holder_Father_F_Name);
                $('#DV_SH #txtFatherMName').val(row.Holder_Father_M_Name);
                $('#DV_SH #txtFatherLName').val(row.Holder_Father_L_Name);

                //mother name
                $('#DV_SH #ddlMotherTitle').val(row.Holder_Mother_Prefix);
                $('#DV_SH #txtMotherFName').val(row.Holder_Mother_F_Name);
                $('#DV_SH #txtMotherMName').val(row.Holder_Mother_M_Name);
                $('#DV_SH #txtMotherLName').val(row.Holder_Mother_L_Name);

                //spouse name
                $('#DV_SH #ddlSpouseTitle').val(row.Holder_Spouse_Prefix);
                $('#DV_SH #txtSpouseFName').val(row.Holder_Spouse_F_Name);
                $('#DV_SH #txtSpouseMName').val(row.Holder_Spouse_M_Name);
                $('#DV_SH #txtSpouseLName').val(row.Holder_Spouse_L_Name);

                //guardian name
                $('#DV_SH #ddlGuardianTitle').val(row.Holder_Guardian_Prefix);
                $('#DV_SH #txtGuardianFName').val(row.Holder_Guardian_F_Name);
                $('#DV_SH #txtGuardianMName').val(row.Holder_Guardian_M_Name);
                $('#DV_SH #txtGuardianLName').val(row.Holder_Guardian_L_Name);
                $('#DV_SH #txtGuardianPAN').val(row.Holder_Guardian_PAN);

                //occupation
                $('#DV_SH #ddlOccupation').val(row.OccupationType);

                //avinash added Occupation / sub - occupation changes
                BindDDLExtendedAjaxCall('#DV_SH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);
                if (!$.isEmptyObject(row.CustSeg_Type_Code)) {
                    $('#DV_SH_MD #ddlCustSegType').val('select');
                    $('#DV_SH_MD #ddlCustSegType').val(row.CustSeg_Type_Code);
                }

                BindDDLExtendedAjaxCall('#DV_SH_MD #ddlCustSegSubType', 'DataEntry/Get_ddl_Occ_CustSegSubTypeList', null, 'POST', null, null, true, false, false, ErrorFunction);
                if (!$.isEmptyObject(row.CustSeg_Subtype_Code)) {
                    $("#DV_SH_MD #Occ_Cus_SegSubtype_Div").show();
                    $('#DV_SH_MD #ddlCustSegSubType').val(row.CustSeg_Subtype_Code);
                }
                else {
                    $("#DV_SH_MD #Occ_Cus_SegSubtype_Div").hide();
                }

                if ($("#DV_SH_MD #ddlCustSegType").val() == "select") {
                    $("#DV_SH_MD #Occ_Cus_SegSubtype_Div").hide();
                }
                else {
                    $("#DV_SH_MD #Occ_Cus_SegSubtype_Div").show();
                }

                //annualincome
                $('#DV_SH #ddlAnnualIncome').val(row.Kyc_AnnualIncome_Code);

                //ckyc no
                $('#DV_SH #txtCKYCNumber').val(row.CKYCNumber);

                $('#DV_SH #hdnMobilisationMode').val(row.MobilisationMode);

                $('#DV_SH_P_ADDR #txtTelephone').val(row.TEL_RES);

                //PER
                if (!$.isEmptyObject(row.ADD1))
                {
                    $('#DV_SH_P_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                    $('#chkIsSHAddrSameAsFH').prop('disabled', true);

                    $('#DV_SH_P_ADDR #txtAdd1').val(row.ADD1);
                    $('#DV_SH_P_ADDR #txtAdd2').val(row.ADD2);
                    $('#DV_SH_P_ADDR #txtAdd3').val(row.ADD3);
                    $('#DV_SH_P_ADDR #ddlCountry').val(row.CountryCode).change();
                    $('#DV_SH_P_ADDR #txtCity').val(row.CITY);
                    $('#DV_SH_P_ADDR #txtState').val(row.STATE);
                    $('#DV_SH_P_ADDR #txtDistrict').val(row.DISTRICT);
                    $('#DV_SH_P_ADDR #txtPin').val(row.PINCODE).keyup();
                }

                //Mailing
                if (!$.isEmptyObject(row.M_ADD1))
                {
                    $('#chkIsSHAddrSameAsPermanent').prop('disabled', true);
                    $('#DV_SH_M_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                    $('#DV_SH_M_ADDR #txtAdd1').val(row.M_ADD1);
                    $('#DV_SH_M_ADDR #txtAdd2').val(row.M_ADD2);
                    $('#DV_SH_M_ADDR #txtAdd3').val(row.M_ADD3);
                    $('#DV_SH_M_ADDR #ddlCountry').val(row.M_CountryCode).change();
                    $('#DV_SH_M_ADDR #txtState').val(row.M_STATE);
                    $('#DV_SH_M_ADDR #txtDistrict').val(row.M_DISTRICT);
                    $('#DV_SH_M_ADDR #txtPin').val(row.M_PINCODE).keyup();
                    $('#DV_SH_M_ADDR #txtCity').val(row.M_CITY);
                }

                //CKYC validations
                SH_KYC_Validations();

                //validations
                $('#btnSHAddFresh').hide();
                $('#DV_PROV_SH').hide();
                $('#DV_SH_SEARCH').hide();
                $('#DV_SH_CKYC_SEARCH').hide();
                if ($('#ddlHolderType').val() == '02')
                {
                    $('#DV_SH_HEAD').show();
                }
                $('#DV_SH_DTLS').slideDown();
            }

            $('#preloader').hide();
        }, null, true, false, false, ErrorFunction);
    } catch (e)
    {
        fnException(e)
    }
}

$('#ddlProvTH').change(function ()
{
    try
    {
        if (!$.isEmptyObject(this.value) && this.value != 'select')
        {
            GetProvTH(this.value);
            $("#TH_PEP").hide();
        }
    } catch (e)
    {
        fnException(e);
    }
});

function GetProvTH(id)
{
    try
    {
        var objBO = {
            Id: id
        };

        ExtendedAjaxCall('HolderDetails/GetProvHolderDtlsAsync', objBO, 'POST', function (result)
        {

            if (!$.isEmptyObject(result))
            {
                let row = result[0];
                $('#hdrTHFolioNo').text(row.Folio);
                $('#hdrTHExistingFDRNo').text(row.Dep_no);
                $('#hdrTHLastInvDate').text(row.Last_Inv_Date);
                BTP_OBJECT.THCountFolioYear = row.CountFolioYear;
                BTP_OBJECT.TH_DATA_SOURCE = row.Source;

                $('#hdnTHSourceTableId').val(row.SourceTableId);

                //title
                $('#DV_TH #ddlTitle').val(row.NamePrefix).change();

                //name
                $('#DV_TH #txtFName').val(row.Holder_F_Name).change();
                $('#DV_TH #txtMName').val(row.Holder_M_Name).change();
                $('#DV_TH #txtLName').val(row.Holder_L_Name).change();

                //gender
                $('#DV_TH #ddlGender').val(row.Gender).change();

                //dob
                $('#DV_TH #txtDOB').datetextentry('set_date', row.DOB).datetextentry('set_readonly', true).focusout();
                THDOBChange();

                //pan
                $('#DV_TH #txtPAN').val(row.PAN).change();;

                //mobile
                $('#DV_TH #txtMobileNo').val(row.MOBILE_NO).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed').change();

                //email
                $('#DV_TH #txtEmailId').val(row.EMAIL_ID).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed').change();

                //maritalstatus
                $('#DV_TH #ddlMaritalStatus').val(row.MARITAL_STATUS).change();

                //father name
                $('#DV_TH #ddlFatherTitle').val(row.Holder_Father_Prefix);
                $('#DV_TH #txtFatherFName').val(row.Holder_Father_F_Name);
                $('#DV_TH #txtFatherMName').val(row.Holder_Father_M_Name);
                $('#DV_TH #txtFatherLName').val(row.Holder_Father_L_Name);

                //mother name
                $('#DV_TH #ddlMotherTitle').val(row.Holder_Mother_Prefix);
                $('#DV_TH #txtMotherFName').val(row.Holder_Mother_F_Name);
                $('#DV_TH #txtMotherMName').val(row.Holder_Mother_M_Name);
                $('#DV_TH #txtMotherLName').val(row.Holder_Mother_L_Name);

                //spouse name
                $('#DV_TH #ddlSpouseTitle').val(row.Holder_Spouse_Prefix);
                $('#DV_TH #txtSpouseFName').val(row.Holder_Spouse_F_Name);
                $('#DV_TH #txtSpouseMName').val(row.Holder_Spouse_M_Name);
                $('#DV_TH #txtSpouseLName').val(row.Holder_Spouse_L_Name);

                //guardian name
                $('#DV_TH #ddlGuardianTitle').val(row.Holder_Guardian_Prefix);
                $('#DV_TH #txtGuardianFName').val(row.Holder_Guardian_F_Name);
                $('#DV_TH #txtGuardianMName').val(row.Holder_Guardian_M_Name);
                $('#DV_TH #txtGuardianLName').val(row.Holder_Guardian_L_Name);
                $('#DV_TH #txtGuardianPAN').val(row.Holder_Guardian_PAN);

                //occupation
                $('#DV_TH #ddlOccupation').val(row.OccupationType);

                //avinash added Occupation / sub - occupation changes
                BindDDLExtendedAjaxCall('#DV_TH #ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);
                if (!$.isEmptyObject(row.CustSeg_Type_Code)) {
                    $('#DV_TH_MD #ddlCustSegType').val(row.CustSeg_Type_Code);
                }

                BindDDLExtendedAjaxCall('#DV_TH_MD #ddlCustSegSubType', 'DataEntry/Get_ddl_Occ_CustSegSubTypeList', null, 'POST', null, null, true, false, false, ErrorFunction);
                if (!$.isEmptyObject(row.CustSeg_Subtype_Code)) {
                    $("#DV_TH_MD #Occ_Cus_SegSubtype_Div").show();
                    $('#DV_TH_MD #ddlCustSegSubType').val(row.CustSeg_Type_Code);
                }
                else {
                    $("#DV_TH_MD #Occ_Cus_SegSubtype_Div").hide();
                }

                if ($("#DV_SH_MD #ddlCustSegType").val() == "select") {
                    $("#DV_SH_MD #Occ_Cus_SegSubtype_Div").hide();
                }
                else {
                    $("#DV_SH_MD #Occ_Cus_SegSubtype_Div").show();
                }

                //annualincome
                $('#DV_TH #ddlAnnualIncome').val(row.Kyc_AnnualIncome_Code);

                //ckyc no
                $('#DV_TH #txtCKYCNumber').val(row.CKYCNumber);

                $('#DV_TH #hdnMobilisationMode').val(row.MobilisationMode);

                $('#DV_TH_P_ADDR #txtTelephone').val(row.TEL_RES);

                //PER
                if (!$.isEmptyObject(row.ADD1))
                {
                    $('#DV_TH_P_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                    $('#chkIsTHAddrSameAsFH').prop('disabled', true);

                    $('#DV_TH_P_ADDR #txtAdd1').val(row.ADD1);
                    $('#DV_TH_P_ADDR #txtAdd2').val(row.ADD2);
                    $('#DV_TH_P_ADDR #txtAdd3').val(row.ADD3);
                    $('#DV_TH_P_ADDR #ddlCountry').val(row.CountryCode).change();
                    $('#DV_TH_P_ADDR #txtCity').val(row.CITY);
                    $('#DV_TH_P_ADDR #txtState').val(row.STATE);
                    $('#DV_TH_P_ADDR #txtDistrict').val(row.DISTRICT);
                    $('#DV_TH_P_ADDR #txtPin').val(row.PINCODE).keyup();
                }

                //Mailing
                if (!$.isEmptyObject(row.M_ADD1))
                {
                    $('#chkIsTHAddrSameAsPermanent').prop('disabled', true);
                    $('#DV_TH_M_ADDR .ADDR').prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');

                    $('#DV_TH_M_ADDR #txtAdd1').val(row.M_ADD1);
                    $('#DV_TH_M_ADDR #txtAdd2').val(row.M_ADD2);
                    $('#DV_TH_M_ADDR #txtAdd3').val(row.M_ADD3);
                    $('#DV_TH_M_ADDR #ddlCountry').val(row.M_CountryCode).change();
                    $('#DV_TH_M_ADDR #txtState').val(row.M_STATE);
                    $('#DV_TH_M_ADDR #txtDistrict').val(row.M_DISTRICT);
                    $('#DV_TH_M_ADDR #txtPin').val(row.M_PINCODE).keyup();
                    $('#DV_TH_M_ADDR #txtCity').val(row.M_CITY);
                }

                TH_KYC_Validations();

                //validations
                $('#btnTHAddFresh').hide();
                $('#DV_PROV_TH').hide();
                $('#DV_TH_SEARCH').hide();
                $('#DV_TH_CKYC_SEARCH').hide();
                if ($('#ddlHolderType').val() == '02')
                {
                    $('#DV_TH_HEAD').show();
                }
                $('#DV_TH_DTLS').slideDown();
            }

            $('#preloader').hide();
        }, null, true, false, false, ErrorFunction);
    } catch (e)
    {
        fnException(e)
    }
}



const InvDOB_Change = function () {
    try {

        let age = GetAge($('#txtInvDOB').val());

        if (age >= 60) {
            $('#ddlCategory option[value="PUBLIC"]').hide();
            $('#ddlCategory option[value="EMPLOYEE"]').hide();
            $('#ddlCategory option[value="SR CITIZEN"]').show();
            $('#ddlCategory').val('SR CITIZEN').change();
            if (BTP_OBJECT.OtherDetailsSave)
                $('#ddlCategory').change();
        }
        else {
            $('#ddlCategory option[value="PUBLIC"]').show();
            $('#ddlCategory option[value="EMPLOYEE"]').hide();
            $('#ddlCategory option[value="SR CITIZEN"]').hide();
            $('#ddlCategory').val('select').prop('disabled', false).removeClass('DisabledControl').change();
            if (BTP_OBJECT.OtherDetailsSave)
                $('#ddlCategory').change();
        }

        $('#txtInvPan').prop('required', true);
        $('#DV_FH #ddlMaritalStatus option[value="01"]').prop('disabled', false);

        if (age < 18) {
            $('#txtInvPan').val('').prop('required', false);
            $('#DV_FH #ddlGuardianTitle').prop('required', true);
            $('#DV_FH #txtGuardianFName').prop('required', true);
            $('#DV_FH #txtGuardianPAN').prop('required', true);
            $('#DV_FH #ddlMaritalStatus option[value="01"]').prop('disabled', true);
            $('#DV_FH #ddlMaritalStatus').val('03');
            $('#DV_PAN').hide();
            $('#DV_FH .GUARDIAN').show();
            //$('#DV_FH .SPOUSE').hide();
        }
        else if ($('#DV_FH #ddlMaritalStatus').val() == '01') {
            $('#DV_FH #ddlGuardianTitle').prop('required', false);
            $('#DV_FH #txtGuardianFName').prop('required', false);
            $('#DV_FH #txtGuardianPAN').prop('required', false);
            $('#DV_PAN').show();
            $('#DV_FH .GUARDIAN').hide();
            $('#DV_FH .SPOUSE').show();
        }
        else {
            $('#DV_FH #ddlGuardianTitle').prop('required', false);
            $('#DV_FH #txtGuardianFName').prop('required', false);
            $('#DV_FH #txtGuardianPAN').prop('required', false);
            $('#DV_PAN').show();
            $('#DV_FH .GUARDIAN').hide();
            //$('#DV_FH .SPOUSE').hide();
        }
    } catch (e) {
        fnException(e); return false;
    }
}
//cheque validation
const ValidateChequeDate = function (date) {
    try {
        if (!$.isEmptyObject(date)) {
            let chequeDate = date.toString().split('-');
            chequeDate = new Date(Number(chequeDate[0]), (Number(chequeDate[1]) - 1), Number(chequeDate[2]));
            let now = new Date();
            let next = new Date();
            let prev = new Date();
            next.setDate(now.getDate() + Number(Max_Cheque_Date));
            prev.setDate(now.getDate() - Number(Min_Cheque_Date));

            if (chequeDate < prev)
                return "Cheque date cannot be less than " + Min_Cheque_Date + " days from today..!";

            if (chequeDate > next)
                return "Cheque date cannot be greater than " + Max_Cheque_Date + " days from today..!";

        }
        return null;
    } catch (e) {
        fnException(e); return null;
    }
}
//amount validation
const ValidateAmount = function (amount) {
    let msg = null;
    try {
        let depositDetails = {
            FD_Amount: parseFloat(amount),
            SCHEME: $('#ddlSchemes').val(),
            PERIOD: $('#ddlTenure').val(),
            INTEREST_FREQ: $('#ddlInterestFrequency').val(),
            CATEGORY: $('#ddlCategory').val(),
            Mode_Status: "AF"
        }

        ExtendedAjaxCall('FDConfiguration/ValidateAmount?amount=' + amount, null, 'GET', function (result) {
            if (!$.isEmptyObject(result) && result != "Success")
                msg = result;
            $('#preloader').hide();
        }, null, null, false, false, ErrorFunction);

    } catch (e) {
        fnException(e);
    }
    return msg;
}
//PAN check
const Check_PAN = function (PAN, DOB, Appl_No, Folio) {
    let err_msg = '';
    try {
        let investorDtl = {
            Appl_No: Appl_No,
            DOB: DOB,
            Folio: Folio,
            PAN: PAN
        }
        ExtendedAjaxCall('DataEntry/Check_PAN', investorDtl, 'POST', function (result) {
            if (!$.isEmptyObject(result) && !$.isEmptyObject(result[0].Msg))
                err_msg = '<p>' + result[0].Msg + '</p >';

        }, null, null, false, false, ErrorFunction);


    } catch (e) {
        fnException(e); return '<p>Something went wrong while checking PAN..!</p>';
    }
    return err_msg;
}

//
$('#txtSearchDOB,input[name="SEARCH_DOB"]').datetextentry({
    max_date: function () { return this.get_today(); },
    max_date_message: 'Date cannot be future date'
});

//investor dob
$('#txtInvDOB').datetextentry({
    min_year: '1915',
    max_date: function () { return this.get_today(); },
    max_date_message: 'Date cannot be future date',
    on_blur: InvDOB_Change

});

//non-individul doi
$('#txtInvDOI').datetextentry({
    max_date: function () { return this.get_today(); },
    max_date_message: 'Date cannot be future date',
});

//cheque date
$('#txtChequeDate').datetextentry({
    min_year: '1915',
    on_blur: function () {
        try {
            let txtChequeDate = $('#txtChequeDate');
            if (!$.isEmptyObject(txtChequeDate.val())) {
                let chequeDate = $('#txtChequeDate').val().split('-');
                chequeDate = new Date(Number(chequeDate[0]), (Number(chequeDate[1]) - 1), Number(chequeDate[2]));
                let now = new Date();
                let next = new Date();
                let prev = new Date();
                next.setDate(now.getDate() + Number(Max_Cheque_Date));
                prev.setDate(now.getDate() - Number(Min_Cheque_Date));

                if (chequeDate < prev) {
                    let msg = "Cheque date cannot be less than " + Min_Cheque_Date + " days from today";
                    txtChequeDate.datetextentry('set_error', msg);
                }

                if (chequeDate > next) {
                    let msg = "Cheque date cannot be greater than " + Max_Cheque_Date + " days from today";
                    txtChequeDate.datetextentry('set_error', msg);
                }

            }
            return null;
        } catch (e) {
            fnException(e); return null;
        }
    }
});

//depositor status
$('#ddlDepositorsStatus').selectedIndex = 1;

$('#ddlDepositorsStatus')
    .focusin(function () {
        $(this).next().text('').hide();
    })
    .change(function () {
        $(this).next().text('').hide();
        BTP_OBJECT.IND_NIND = this.value;

        if (this.value == 'IND' || this.value == 'select') {
            $('.IND').show();
            $('.NIND').hide();
            //$('#ddlInvtitle').val('select').change();
        }
        else {
            $('.IND').hide();
            $('.NIND').show();
            //$('#ddlInvtitle').val('M/S').change();
        }

        $('#lblDepositorCategory').text($('#ddlDepositorsStatus :Selected').text());

    });

$('#ddlInvSearchBy')
    .focusin(function () {
        let ddlDepositorCategory = $('#ddlDepositorsStatus');

        ddlDepositorCategory.next().text('').hide();
        if (ddlDepositorCategory.val() == 'select') {
            ddlDepositorCategory.focus();
            ddlDepositorCategory.next().text('Depositor Category is required').show();
            return;
        }

    })
    .change(function () {
        let ddlDepositorCategory = $('#ddlDepositorsStatus');
        let ddlInvSearchBy = $('#ddlInvSearchBy');
        let txtSearchRefNo = $('#txtSearchRefNo');
        let txtSearchDOB = $('#txtSearchDOB');

        $("#DobSearch").hide();

        txtSearchRefNo.val('').removeAttr('oninput', "this.value=this.value.replace(/[^0-9]/g,'');").change();
        txtSearchDOB.datetextentry('clear');

        if (ddlDepositorCategory.val() == "IND") {
            if (ddlInvSearchBy.val() == "Mobile") {
                txtSearchRefNo.attr('maxlength', '10').attr('oninput', "this.value=this.value.replace(/[^0-9]/g,'');");
                $("#DobSearch").show();
            }
            else if (ddlInvSearchBy.val() == "PAN") {
                txtSearchRefNo.attr('maxlength', '10');
                $("#DobSearch").show();
            }
            else if (ddlInvSearchBy.val() == "CKYCNo") {
                txtSearchRefNo.attr('maxlength', '20');
                $("#DobSearch").show();
            }
            else if (ddlInvSearchBy.val() == "FDR")
                txtSearchRefNo.attr('maxlength', '15');
            else if (ddlInvSearchBy.val() == "Folio")
                txtSearchRefNo.attr('maxlength', '15');
            else if (ddlInvSearchBy.val() == "Email") {
                txtSearchRefNo.removeAttr('maxlength');
                $("#DobSearch").show();
            }
        }
        else {
            if (ddlInvSearchBy.val() == "Mobile")
                txtSearchRefNo.attr('maxlength', '10').attr('oninput', "this.value=this.value.replace(/[^0-9]/g,'');");
            else if (ddlInvSearchBy.val() == "PAN")
                txtSearchRefNo.attr('maxlength', '10');
            else if (ddlInvSearchBy.val() == "CKYCNo")
                txtSearchRefNo.attr('maxlength', '20');
            else if (ddlInvSearchBy.val() == "FDR")
                txtSearchRefNo.attr('maxlength', '15');
            else if (ddlInvSearchBy.val() == "Folio")
                txtSearchRefNo.attr('maxlength', '15');
            else if (ddlInvSearchBy.val() == "Email")
                txtSearchRefNo.removeAttr('maxlength');
        }
    });

$('#txtSearchRefNo')
    .keyup(function () {
        $(this).next().text('').hide();
        let ddlInvSearchBy = $('#ddlInvSearchBy');

        if (!$.isEmptyObject(this.value)) {
            if (ddlInvSearchBy.val() == 'PAN' && !IsValidPAN(this.value))
                $(this).next().text('Please Enter valid PAN').show();
            else if (ddlInvSearchBy.val() == 'Mobile' && !IsValidMobile(this.value))
                $(this).next().text('Please Enter valid Mobile').show();
            else if (ddlInvSearchBy.val() == 'Email' && !IsValidEmail(this.value))
                $(this).next().text('Please Enter valid Email').show();
        }

    })
    .change(function () {
        if ($.isEmptyObject(this.value))
            $(this).next().text('').hide();
    });

//amount
$('#txtAmount')
    .change(function () {
        $('#ddlCategory').val('select').prop('disabled', false).removeClass('DisabledControl').change();
    })
    .keyup(function () {
        $(this).next().text('').hide();

        if (!$.isEmptyObject(this.value) && isNaN(this.value))
            $(this).next().text('Amount is not valid').show();
        else if (!$.isEmptyObject(this.value) && parseInt(this.value) < Min_Amount) {
            let msg = 'Amount can not be less than ' + Min_Amount;
            $(this).next().text(msg).show();
        }
        else if (!$.isEmptyObject(this.value)) {
            ExtendedAjaxCall('FDConfiguration/ValidateAmount?amount=' + $(this).val(), null, 'GET', function (result) {
                if (!$.isEmptyObject(result) && result.toUpperCase() != 'SUCCESS')
                    $(this).next().text(result).show();
            }, function () {

                }, null, true, false, ErrorFunction);
        }
    })
    .focusout(function () {
        let amountinword = convertNumberToWords(this.value);
        $('#txtamountinwords').text(amountinword);
    });

//Investor title
$('#ddlInvtitle').change(function () {
    if ($(this).val() == 'MR' || $(this).val() == 'SHRI')
        $('#DV_FH #ddlGender').val('M');

    if ($(this).val() == 'MS' || $(this).val() == 'MRS')
        $('#DV_FH #ddlGender').val('F');
});

//invester PAN
$('#txtInvPan').keyup(function () {
    $(this).next().text('').removeClass('successBox').hide();

    if (!$.isEmptyObject(this.value) && !IsValidPAN(this.value))
        $(this).next().text('PAN is not valid').show();
    else {

    }
});

//investor mobile
$('#txtMobile').keyup(function () {
    $(this).next().text('').hide();
    if (!$.isEmptyObject(this.value) && !IsValidMobile(this.value))
        $(this).next().text('Mobile Number is not valid').show();
});

//investor email
$('#txtEmail').keydown(function () {
    $(this).next().text('').hide();
    if (!$.isEmptyObject(this.value) && !IsValidEmail(this.value))
        $(this).next().text('Email Id is not valid').show();
});

//application type
$('#rdoPhysical,#rdoDigital').change(function () {
    if (this.id == 'rdoPhysical') {
        BTP_OBJECT.appl_dec_type = 'PHYSICAL';
        $('#lblApplicationType').text('PHYSICAL');
        $('#DV_FH_CKYC_SEARCH').hide();
        $('#DV_INV_DETAILS').show();
        $('#spnApplFormUpload').text('*');
        $('#DV_APPL_UPLOAD').show();
    }
    else {
        BTP_OBJECT.appl_dec_type = 'DIGITAL';
        $('#lblApplicationType').text('DIGITAL');
        if ($.isEmptyObject($('#txtInvFirstName').val())) {
            $('#DV_FH_CKYC_SEARCH').show();
            $('#DV_INV_DETAILS').hide();
        }
        else {
            $('#DV_FH_CKYC_SEARCH').hide();
            $('#DV_INV_DETAILS').show();
        }
        $('#spnApplFormUpload').text('');
        $('#DV_APPL_UPLOAD').hide();
    }
});


//step2 submit
const SubmitStep2 = function () {
    try {
        let err_msg = "";
        let objOtherDtl = getStep2Data();

        ExtendedAjaxCall('RenewInvestorDetailsSave/SubmitStep2', objOtherDtl, 'POST', function (result) {
            try {
                if (!$.isEmptyObject(result) && result.Status == 1) {
                    BTP_OBJECT.OtherDetailsSave = true;
                    if ($('#ddlSchemes').val() == 'select')
                        $('#ddlCategory').change();
                }
                else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg))
                    err_msg += '<p>' + result[0].Msg + '</p>';
                else
                    err_msg += '<p>Something went wrong..!</p>';

                $('#preloader').hide();

            } catch (e) {
                fnException(e);
            }
        }, null, true, false, false, ErrorFunction);

        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, "error");
            return false;
        }

        return true;

    } catch (e) {
        fnException(e); return false;
    }

}

//get step2 data for save
const getStep2Data = function () {
    let objOtherDtl = {};

    try {
        let ddlDepositorsStatus = $('#ddlDepositorsStatus').val();
        objOtherDtl.Appl_No = $('#lblApplicationNumber').text().trim();
        objOtherDtl.Sub_Broker_Code = $('#txtSubBrokerCode').val().trim();
        objOtherDtl.Depositor_Status = ddlDepositorsStatus == 'select' ? null : ddlDepositorsStatus.trim();
        objOtherDtl.Physical_App_Number = $('#txtPhysicalApplNo').val();
        objOtherDtl.IsSecondHolderApplicable = $('#chkSHApplicable').prop('checked') ? true : false;
        objOtherDtl.IsThirdHolderApplicable = $('#chkTHApplicable').prop('checked') ? true : false;
        objOtherDtl.IsNomineeApplicable = $('#chkNomApplicable').prop('checked') ? true : false;
        objOtherDtl.FolioNo = $('#lblFolioNumber').text().trim();
        objOtherDtl.FDRNo = $('#lblExistingFDRNumber').text().trim();
        objOtherDtl.LastInvDate = $('#lblLastInvestmentDate').text().trim();
        objOtherDtl.Is_FH_Tax_Resident = $('#btnsldFatca').hasClass('active');
        objOtherDtl.Is_FH_Green_Card_Holder = $('#btnsldGreen').hasClass('active');
        objOtherDtl.Is_SH_Tax_Resident = $('#btnSHsldFatca').hasClass('active');
        objOtherDtl.Is_SH_Green_Card_Holder = $('#btnSHsldGreen').hasClass('active');
        objOtherDtl.Is_TH_Tax_Resident = $('#btnTHsldFatca').hasClass('active');
        objOtherDtl.Is_TH_Green_Card_Holder = $('#btnTHsldGreen').hasClass('active');

    } catch (e) {
        fnException(e);
    }
    return objOtherDtl;
}

//step2 reset
const Reset_step2 = function () {
    $('.errorbox').text('').hide();
    $('#chkSHApplicable,#chkTHApplicable,#chkNomApplicable').prop('checked', false).change();
    $('#btnSHsldFatca,#btnSHsldGreen,#btnTHsldFatca,#btnTHsldGreen').removeClass('active');
    $('#chkTHApplicable').prop('disabled', true).prop('checked', false).change();
}


$('#chkSHApplicable').change(function () {
    $('#btnSHsldFatca,#btnSHsldGreen').removeClass('active').change();

    if ($(this).prop('checked')) {
        $('#ddlHolderType option[value="02"]').show();
        $('#ddlDocHolderType option[value="02"]').show();
        //fatca
        $('.secondholdercls').show();
        $('#chkTHApplicable').prop('disabled', false);
    }
    else {
        $('#ddlHolderType option[value="02"]').hide();
        $('#ddlHolderType option[value="03"]').hide();
        $('#ddlDocHolderType option[value="02"]').hide();
        $('#ddlDocHolderType option[value="03"]').hide();
        $('.secondholdercls').hide();
        $('#chkTHApplicable').prop('disabled', true).prop('checked', false).change();

        BTP_OBJECT.mode = 'R';
        SHReset();
        THReset();
        BTP_OBJECT.mode = 'A';
    }
    $('#ddlHolderType').val('01').change();
});

$('#chkTHApplicable').change(function () {
    $('#btnTHsldFatca,#btnTHsldGreen').removeClass('active').change();

    if ($(this).prop('checked')) {
        $('#ddlHolderType option[value="03"]').show();
        $('#ddlDocHolderType option[value="03"]').show();
        //fatca
        $('.thirdholdercls').show();
    }
    else {
        $('#ddlHolderType option[value="03"]').hide();
        $('#ddlDocHolderType option[value="03"]').hide();
        $('.thirdholdercls').hide();

        BTP_OBJECT.mode = 'R';
        THReset();
        BTP_OBJECT.mode = 'A';
    }
    $('#ddlHolderType').val('01').change();
});

$('#chkNomApplicable').change(function () {
    if ($(this).prop('checked'))
        $('#IdBtnTabSwit06').prop('disabled', false).removeClass('DisabledControl');
    else
        $('#IdBtnTabSwit06').prop('disabled', true).addClass('DisabledControl');
});

$('#btnCancel02').bind('click', Reset_step2);

$('#btnsldFatca')
    .click(function () {
        if ($(this).hasClass('active'))
            $(this).removeClass('active');
        else
            $(this).addClass('active');

        if ($(this).hasClass('active') || $('#btnsldGreen').hasClass('active')) {
            $('#DV_FH_FATCA').show();
            $('#DV_TDS_FLAG,#DV_HNG').hide();
            $('#chkTDFFlag').prop('checked', false).change();
        }
        else {
            $('#DV_FH_FATCA').hide();
            $('#DV_TDS_FLAG').show();
            $('#chkTDFFlag').prop('checked', false).change();
        }
    })
    .change(function () {
        if ($(this).hasClass('active') || $('#btnsldGreen').hasClass('active')) {
            $('#DV_FH_FATCA').show();
            $('#DV_TDS_FLAG,#DV_HNG').hide();
            $('#chkTDFFlag').prop('checked', false).change();
        }
        else {
            $('#DV_FH_FATCA').hide();
            $('#DV_TDS_FLAG').show();
            $('#chkTDFFlag').prop('checked', false).change();
        }

    });

$('#btnsldGreen')
    .click(function () {
        if ($(this).hasClass('active'))
            $(this).removeClass('active');
        else
            $(this).addClass('active');

        if ($(this).hasClass('active') || $('#btnsldFatca').hasClass('active')) {
            $('#DV_FH_FATCA').show();
            $('#DV_TDS_FLAG,#DV_HNG').hide();
            $('#chkTDFFlag').prop('checked', false).change();
        }
        else {
            $('#DV_FH_FATCA').hide();
            $('#DV_TDS_FLAG').show();
            $('#chkTDFFlag').prop('checked', false).change();
        }
    })
    .change(function () {
        if ($(this).hasClass('active') || $('#btnsldFatca').hasClass('active')) {
            $('#DV_FH_FATCA').show();
            $('#DV_TDS_FLAG,#DV_HNG').hide();
            $('#chkTDFFlag').prop('checked', false).change();
        }
        else {
            $('#DV_FH_FATCA').hide();
            $('#chkTDFFlag').prop('checked', false).change();
        }
    });

$('#btnSHsldFatca')
    .click(function () {
        if ($(this).hasClass('active'))
            $(this).removeClass('active');
        else
            $(this).addClass('active');

        if ($(this).hasClass('active') || $('#btnSHsldGreen').hasClass('active'))
            $('#DV_SH_FATCA').show();
        else
            $('#DV_SH_FATCA').hide();
    })
    .change(function () {
        if ($(this).hasClass('active') || $('#btnSHsldGreen').hasClass('active'))
            $('#DV_SH_FATCA').show();
        else
            $('#DV_SH_FATCA').hide();
    });

$('#btnSHsldGreen')
    .click(function () {
        if ($(this).hasClass('active'))
            $(this).removeClass('active');
        else
            $(this).addClass('active');

        if ($(this).hasClass('active') || $('#btnSHsldFatca').hasClass('active'))
            $('#DV_SH_FATCA').show();
        else
            $('#DV_SH_FATCA').hide();
    })
    .change(function () {
        if ($(this).hasClass('active') || $('#btnSHsldFatca').hasClass('active'))
            $('#DV_SH_FATCA').show();
        else
            $('#DV_SH_FATCA').hide();
    });

$('#btnTHsldFatca')
    .click(function () {
        if ($(this).hasClass('active'))
            $(this).removeClass('active');
        else
            $(this).addClass('active');

        if ($(this).hasClass('active') || $('#btnTHsldGreen').hasClass('active'))
            $('#DV_TH_FATCA').show();
        else
            $('#DV_TH_FATCA').hide();
    })
    .change(function () {
        if ($(this).hasClass('active') || $('#btnTHsldGreen').hasClass('active'))
            $('#DV_TH_FATCA').show();
        else
            $('#DV_TH_FATCA').hide();
    });

$('#btnTHsldGreen')
    .click(function () {
        if ($(this).hasClass('active'))
            $(this).removeClass('active');
        else
            $(this).addClass('active');

        if ($(this).hasClass('active') || $('#btnTHsldFatca').hasClass('active'))
            $('#DV_TH_FATCA').show();
        else
            $('#DV_TH_FATCA').hide();
    })
    .change(function () {
        if ($(this).hasClass('active') || $('#btnTHsldFatca').hasClass('active'))
            $('#DV_TH_FATCA').show();
        else
            $('#DV_TH_FATCA').hide();
    });



//step3 submit
const SubmitStep3 = function () {

    try {
        let err_msg = isValidStep3();
        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, 'error');
            return false;
        }

        //Investment Details
        let InvestorDtl = getStep3Data();
        ExtendedAjaxCall('RenewInvestorDetailsSave/SubmitStep3', InvestorDtl, 'POST', function (result) {
            try {
                if (!$.isEmptyObject(result) && result.Status == 1)
                    BTP_OBJECT.InvestmentDetailsSave = true;
                else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg))
                    err_msg += '<p>' + result[0].Msg + '</p>';
                else
                    err_msg += '<p>Something went wrong..!</p>';

                $('#preloader').hide();

            } catch (e) {
                fnException(e);
            }
        }, null, true, false, false, ErrorFunction);

        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, 'error');
            return false;
        }

        return true;

    } catch (e) {
        fnException(e); return false;
    }
}

//step3 validations
const isValidStep3 = function () {
    let err_msg = "";
    try {
        $('.FD_DTLS').removeClass('InputBorderRed');

        //FDDetails
        let FDDetails = $('.FD_DTLS');
        for (let i = 0; i < FDDetails.length; i++) {
            let FDDetail = $(FDDetails[i]);
            if (FDDetail.prop('required') && ($.isEmptyObject(FDDetail.val()) || FDDetail.val() == 'select')) {
                err_msg += "<p>" + FDDetail.attr('errmsg') + "</p>";
                FDDetail.addClass('InputBorderRed');
            }
        }
    } catch (e) {
        fnException(e);
    }
    return err_msg;
}

//get step3 data for save
const getStep3Data = function () {
    let InvestorDtl = {};



    try {
        //Investment Details
        InvestorDtl.Appl_No = $('#lblApplicationNumber').text().trim();
        InvestorDtl.Depositor_Status_Code = $('#ddlDepositorsStatus').val() == 'select' ? null : $('#ddlDepositorsStatus').val();
        InvestorDtl.Category = $('#ddlCategory').val().trim();
        InvestorDtl.EmployeeCode = $('#ddlCategory').val() == 'EMPLOYEE' ? $('#txtEmpCode').val().trim() : '';
        InvestorDtl.Scheme = $('#ddlSchemes option:selected').text().trim();
        InvestorDtl.SchemeCode = $('#ddlSchemes').val().trim();
        InvestorDtl.IntRate = parseFloat($('#ddlTenure :Selected').attr('interest_rate'));
        InvestorDtl.IntFreq = $('#ddlInterestFrequency').val();
        InvestorDtl.Tenure = $('#ddlTenure').val();
        InvestorDtl.FDR_Dispatch_Mode = $('#ddlFdrDispatchMode').val();
        InvestorDtl.Renewal_For = $('#ddlRenewalFor').val() == 'select' ? null : $('#ddlRenewalFor').val();
        if (!$('#btnsldFatca').hasClass('active') && !$('#btnsldGreen').hasClass('active')) {
            InvestorDtl.TDS_Flag = $('#chkTDFFlag').prop('checked') ? 'Y' : 'N';
            InvestorDtl.HNG = $('#chkTDFFlag').prop('checked') ? $('#ddlHNG').val() : null;
        }
        InvestorDtl.Is_Auto_Renewal = $('#ddlAutoRenewal').val() == 'YES' ? true : false;
        InvestorDtl.Amount = isNaN(parseInt($('#lblAmount').text().trim())) ? 0 : parseInt($('#lblAmount').text().trim());
        InvestorDtl.Payment_Mode = $('#lblModeOfPayment').text().trim();
        InvestorDtl.Payment_Instruction = $('#ddlDepositPayable').val();
        InvestorDtl.Ind_Nind = BTP_OBJECT.IND_NIND;
        InvestorDtl.ApplicationDeclarationType = $('#lblApplicationType').text().trim();
        InvestorDtl.FolioNo = $('#lblFolioNumber').text().trim();
        InvestorDtl.FDRNo = $('#lblExistingFDRNumber').text().trim();
        InvestorDtl.LastInvDate = $('#lblLastInvestmentDate').text().trim();
        InvestorDtl.FutureRenewalFor = $('#ddlFutureRenewalFor').val() == 'select' ? null : $('#ddlFutureRenewalFor').val();
    } catch (e) {
        fnException(e);
    }
    return InvestorDtl;
}

//step3 reset
const Reset_step3 = function () {
    $('.errorbox').text('').hide();

    if (!$('#ddlCategory').prop('disabled')) {
        $('#ddlCategory').val('select').change();
    }

    if (!$('#ddlFdrDispatchMode').prop('disabled')) {
        $('#ddlFdrDispatchMode').val('select').change();
    }

    $('#ddlSchemes,#ddlInterestFrequency,#ddlTenure,#ddlDepositPayable,#ddlAutoRenewal,#ddlRenewalFor,#ddlHNG').val('select').change();
    $('#chkTDFFlag').prop('checked', false).change();
    $('#txtEmpCode').val('');
}

const ShowMessage = function () {

    let message = 'Please Select Renewal Option';
    if ($('#ddlRenewalFor').val() == 'P') {
        message = '<p>You have selected Renewal of Principal amount only, the interest amount after deduction of tax, if any, will be credited to registered bank account. </p> <p>Please verify FD application before proceeding.</p>';
        $('#dvModalMsg').empty().html(message);
        $('#ModelMessage').modal('show');
    }
    else if ($('#ddlRenewalFor').val() == 'F') {
        message = '<p>You have selected Renewal of Principal with interest amount, Fixed Deposit will be renewed accordingly. </p> <p>Please verify FD application before proceeding.</p>';
        $('#dvModalMsg').empty().html(message);
        $('#ModelMessage').modal('show');
    }

   
}

//const Save = function () {
//    SubmitStep3();
//}

//category change
$('#ddlCategory').change(function () {
    try {
        let lblAmount = $('#lblAmount').text();
        if ($(this).val() == 'select') {
            $('#ddlSchemes').empty().append('<option value="select">Select</option>').change();
            return;
        }

        let Amount = parseFloat(lblAmount);

        let data = {
            SCHEME: null,
            PERIOD: null,
            INTEREST_FREQ: null,
            CATEGORY: $(this).val(),
            Amount: Amount,
            Mode_Status: 'R'
        };

        BindDDLExtendedAjaxCall('#ddlSchemes', 'FDConfiguration/Get_FD_SchemeAsync', data, 'POST', null, null, true, false, false, ErrorFunction);

        $('#ddlSchemes').change();

        if (this.value == 'EMPLOYEE') {
            $('#DV_EMP_CODE').show();
            $('#txtEmpCode').prop('required', true);
        }
        else {
            $('#DV_EMP_CODE').hide();
            $('#txtEmpCode').prop('required', false);
        }

    } catch (e) {
        fnException(e); return false;
    }
});

//scheme change
$('#ddlSchemes').change(function () {
    try {
        if ($(this).val() == 'select') {
            $('#ddlInterestFrequency').empty().append('<option value="select">Select</option>').change();
            return;
        }

        let category = $('#ddlCategory').val();
        let lblAmount = $('#lblAmount').text();

        let Amount = parseFloat(lblAmount);
        let data = {
            SCHEME: $(this).val(),
            PERIOD: null,
            INTEREST_FREQ: null,
            CATEGORY: category,
            Amount: Amount,
            Mode_Status: 'R'
        };

        BindDDLExtendedAjaxCall('#ddlInterestFrequency', 'FDConfiguration/GetInterestFrequencyAsync', data, 'POST', null, null, true, false, false, ErrorFunction);

        if ($('#ddlSchemes').val() == 'CUMULATIVE')
            $('#ddlInterestFrequency').val('COMP. ANNUALY');

        $('#ddlInterestFrequency').change();

    } catch (e) {
        fnException(e); return false;
    }
});

//interest freq change
$('#ddlInterestFrequency').change(function () {
    try {
        if ($(this).val() == 'select') {
            $('#ddlTenure').empty().html('<option value="select">Select</option>').change();
            return;
        }

        let Category = $('#ddlCategory').val();
        let Scheme = $('#ddlSchemes').val();
        let InterestFreq = $('#ddlInterestFrequency').val();
        let lblAmount = $('#lblAmount').text();

        let Amount = parseFloat(lblAmount);
        let data = {
            SCHEME: Scheme,
            PERIOD: null,
            INTEREST_FREQ: InterestFreq,
            CATEGORY: Category,
            Amount: Amount,
            Mode_Status: 'R'
        };

        ExtendedAjaxCall('FDConfiguration/GetTenureAsync', data, 'POST', function (result) {
            $('#preloader').hide();
            let html = '<option value="select">Select</option>';
            if (result != null && result !== undefined && result.length > 0) {
                for (var i = 0; i < result.length; i++) {
                    html += '<option value="' + result[i].Code + '" interest_rate="' + (result[i].INTEREST_RATES).toFixed(2) + '">' + result[i].Desc + ' months - (' + (result[i].INTEREST_RATES).toFixed(2) + '%)</option>';
                }
            }
            $('#ddlTenure').html(html).change();
        }, null, true, false, false, ErrorFunction);


    } catch (e) {
        fnException(e); return false;
    }
});

$('#ddlAutoRenewal').change(function () {
    if (this.value == 'YES') {
        $('#DV_RENEWAL_FOR').show();
        $('#ddlFutureRenewalFor').prop('required', true);
    }
    else {
        $('#DV_RENEWAL_FOR').hide();
        $('#ddlFutureRenewalFor').prop('required', false);
    }
});

$('#chkTDFFlag').change(function () {
    try {

        if ($(this).prop('checked')) {
            $('#DV_HNG').show();
            $('#ddlHNG').prop('required', true);
        }
        else {
            $('#DV_HNG').hide();
            $('#ddlHNG').prop('required', false);
        }

        let txtInvDOB = $('#txtInvDOB').val();
        let age = GetAge(txtInvDOB);
        if (age >= 60)
            $('#ddlHNG').val("H").prop('disabled', true).addClass('DisabledControl').change();
        else
            $('#ddlHNG').val("G").prop('disabled', true).addClass('DisabledControl').change();

    } catch (e) {
        fnException(e); return false;
    }
});

$('#btnCancel03').bind('click', Reset_step3);

$('#ddlRenewalFor').change(function () {

    if (this.value == 'P' ) {
        $('#lblAmount').text($('#hdnPrincAmount').val());
        $('#txtAmount').val($('#hdnPrincAmount').val());
    }
    else if (this.value == 'F') {
        if ($('#hdnOldScheme').val() == 'C' || $('#hdnOldScheme').val()=='CUMULATIVE') {
            $('#lblAmount').text($('#hdnMatuAmount').val());
            $('#txtAmount').val($('#hdnMatuAmount').val());
        }
        else if ($('#hdnOldScheme').val() == 'N' || $('#hdnOldScheme').val() == 'NON-CUMULATIVE') {
            $('#lblAmount').text($('#hdnPrincAmount').val());
            $('#txtAmount').val($('#hdnPrincAmount').val());
        }
    }

    ShowMessage();
});






//step4 submit
const SubmitStep4 = function () {
    try {
        let err_msg = isValidStep4();

        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, 'error');
            return false;
        }

        //Investor Bank Details
        let Bank_Dtl = getStep4Data();

        ExtendedAjaxCall('RenewInvestorDetailsSave/SubmitStep4', Bank_Dtl, 'POST', function (result) {
            try {
                if (!$.isEmptyObject(result) && result.Status == 1)
                    BTP_OBJECT.BankDetailsSave = true;
                else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg))
                    err_msg += '<p>' + result[0].Msg + '</p>';
                else
                    err_msg += '<p>Something went wrong..!</p>';

                $('#preloader').hide();

            } catch (e) {
                fnException(e);
            }
        }, null, true, false, false, ErrorFunction);

        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, 'error');
            return false;
        }

        return true;
    } catch (e) {
        fnException(e); return false;
    }
}

//step4 save validations
const isValidStep4 = function () {
    let err_msg = "";
    try {
        $('.BANK_DTLS').removeClass('InputBorderRed');
        let BANK_DTLS = $('.BANK_DTLS');
        for (let i = 0; i < BANK_DTLS.length; i++) {
            let BANK_DTL = $(BANK_DTLS[i]);
            if (BANK_DTL.prop('required') && ($.isEmptyObject(BANK_DTL.val()) || BANK_DTL.val() == 'select')) {
                err_msg += "<p>" + BANK_DTL.attr('errmsg') + "</p>";
                BANK_DTL.addClass('InputBorderRed');
            }
        }

        let IsCancelChequeUploadedMsg = IsCancelChequeUploaded();
        if (!$.isEmptyObject(IsCancelChequeUploadedMsg) && !BTP_OBJECT.IsProvBank) {
            err_msg += IsCancelChequeUploadedMsg;
        }

    } catch (e) {
        fnException(e);
    }
    return err_msg;
}

//get step4 data for save
const getStep4Data = function () {
    let Bank_Dtl = {};
    try {

        Bank_Dtl.Appl_No = $('#lblApplicationNumber').text().trim();
        Bank_Dtl.MICRCode = $('#txtMICRCode').val().trim();
        Bank_Dtl.NEFTCode = $('#txtNEFTCode').val().trim();
        Bank_Dtl.BankName = $('#txtBankName').val().trim();
        Bank_Dtl.BranchName = $('#txtBranchName').val().trim();
        Bank_Dtl.BankAccountNo = $('#txtBankAccountNo').val().trim();
        Bank_Dtl.FolioNo = $('#hdrFolioNo').text().trim();
        Bank_Dtl.FDRNo = $('#hdrExistingFDRNo').text().trim();
        Bank_Dtl.LastInvDate = $('#hdrLastInvDate').text().trim();
        Bank_Dtl.FolioNo = $('#lblFolioNumber').text().trim();
        Bank_Dtl.FDRNo = $('#lblExistingFDRNumber').text().trim();
        Bank_Dtl.LastInvDate = $('#lblLastInvestmentDate').text().trim();
        Bank_Dtl.IsProvBank = BTP_OBJECT.IsProvBank;

    } catch (e) {
        fnException(e);
    }
    return Bank_Dtl;
}

//reset step4
const Reset_step4 = function () {
    BTP_OBJECT.IsProvBank = false;
    $('.errorbox').text('').hide();
    $('#ddlProvBank').val('select');
    $('#txtSearchBank,#txtBankName,#txtBranchName,#txtMICRCode,#txtNEFTCode,#txtBankAccountNo,#txtConfirmBankAccountNo').val('');

    $('#txtBankAccountNo').prop('disabled', false).removeClass('DisabledControl');
    $('#txtConfirmBankAccountNo').prop('disabled', false).removeClass('DisabledControl');

    if (!$.isEmptyObject($('#lblFolioNumber').text())) {
        $('#DV_PROV_BANK').show();
        $('#DV_Srch_Bank,.ClsUploadChqCopy').show();
        $('#DV_BANK_DTLS').hide();
    }
    else {
        $('#DV_PROV_BANK').hide();
        $('#DV_Srch_Bank,.ClsUploadChqCopy').show();
        $('#DV_BANK_DTLS').show();
    }
    $('#DV_OR_ADD_NEW').hide();
}

//application form upload validation
const ValidateFileUploadCancelledChequeCopy = function () {
    try {
        let isValid = true;
        let ErrorHtml = "";
        let ApplicationNumber = $('#lblApplicationNumber').text();

        if ($.isEmptyObject(ApplicationNumber)) {
            ErrorHtml += '<p>Application number is required..!</p>';;
            isValid = false;
        }

        if ($('#flvCancelledChequeCopy').get(0).files.length == 0 || $.isEmptyObject($('#flvCancelledChequeCopy').get(0).files)) {
            ErrorHtml += '<p>Please select file to upload..!</p>';;
            isValid = false;
        }

        if (!isValid) {
            BtpMessagePopup(ErrorHtml, 'error');
            return false;
        }
        return true;

    } catch (e) {
        fnException(e); return false;
    }
}

//OVD validations
const IsCancelChequeUploaded = function () {
    let err_msg = '';
    try {
        let IsCancelChequeUploaded = false;

        let appNo = $('#lblApplicationNumber').text().trim();
        if (!$.isEmptyObject(appNo)) {
            ExtendedAjaxCall('DocumentUpload/Get_KYCDocumentAsync?_ApplNo=' + appNo, null, 'GET', function (result) {
                if (!$.isEmptyObject(result)) {

                    $.each(result, function (i, row) {
                        if (row.Doc_Type == 'BANK')
                            IsCancelChequeUploaded = true;
                    });
                }

                $('#preloader').hide();
            }, null, true, false, false, ErrorFunction);
        }
        if (!IsCancelChequeUploaded && $('.ClsUploadChqCopy').css('display') == 'block')
            err_msg += "<p>Please Upload Cancelled Cheque Copy..!</p>";

    } catch (e) {
        fnException(e);
    }
    return err_msg;
}

//step4 click
$('#IdBtnTabSwit04').click(function () {
    try {
        if (!$.isEmptyObject($('#lblFolioNumber').text())) {
            $('#DV_Srch_Bank,.ClsUploadChqCopy').hide();
            let objBO = {
                Folio: $('#lblFolioNumber').text()
            };

            BindDDLExtendedAjaxCall('#ddlProvBank', 'HolderDetails/GetProvBankDtlsAsync', objBO, 'POST', null, null, true, false, false, ErrorFunction);

            if ($.isEmptyObject($('#txtBankName').val())) {
                $('#DV_PROV_BANK').show();
                $('#DV_Srch_Bank,.ClsUploadChqCopy').show();
                $('#DV_BANK_DTLS').hide();
            }
            else {
                $('#DV_PROV_BANK').hide();
                $('#DV_Srch_Bank,.ClsUploadChqCopy').hide();
                $('#DV_BANK_DTLS').show();
            }
        }
        else {
            $('#DV_Srch_Bank,.ClsUploadChqCopy').show();
            $('#DV_PROV_BANK').hide();
            $('#DV_BANK_DTLS').show();
        }

    } catch (e) {
        fnException(e); return false;
    }
});

//provisional bank change
$('#ddlProvBank').change(function () {
    try {
        if (!$.isEmptyObject(this.value) && this.value != 'select') {
            let objBO = {
                Id: this.value
            };

            ExtendedAjaxCall('HolderDetails/GetProvBankDtlsAsync', objBO, 'POST', function (result) {
                if (!$.isEmptyObject(result)) {
                    BTP_OBJECT.IsProvBank = true;
                    $('#txtMICRCode').val(result[0].MICR);
                    $('#txtNEFTCode').val(result[0].NEFT);
                    $('#txtBankName').val(result[0].BankName);
                    $('#txtBranchName').val(result[0].BranchName);
                    $('#txtBankAccountNo').val(result[0].AccNo).prop('disabled', true).addClass('DisabledControl');
                    $('#txtConfirmBankAccountNo').val(result[0].AccNo).prop('disabled', true).addClass('DisabledControl');

                    $('#DV_Srch_Bank,.ClsUploadChqCopy').hide();
                    $('#DV_PROV_BANK').hide();
                    $('#DV_BANK_DTLS').show();
                    $('#DV_OR_ADD_NEW').show();
                }

                $('#preloader').hide();
            }, null, true, false, false, ErrorFunction);
        }

    } catch (e) {
        fnException(e); return false;
    }
});

//add new bank
$('#btnAddNewBank').click(function () {
    $('#DV_Srch_Bank,.ClsUploadChqCopy').show();
    BTP_OBJECT.IsProvBank = false;
    $('#DV_PROV_BANK').hide();
    $('#DV_BANK_DTLS').show();
});

$('#txtBankAccountNo').keyup(function () {
    try {
        $(this).next().text('').hide();
        if (this.value.length < 8 && !$.isEmptyObject(this.value))
            $(this).next().text('Account Number cannot be less than 8 digit').show();

        let txtConfirmBankAccountNo = $('#txtConfirmBankAccountNo').val();
        if (!$.isEmptyObject(this.value) && !$.isEmptyObject(txtConfirmBankAccountNo) && this.value != txtConfirmBankAccountNo)
            $(this).next().text('Bank Account Number does not match').show();

    } catch (e) {
        fnException(e); return false;
    }
});

$('#txtConfirmBankAccountNo').keyup(function () {
    try {
        $(this).next().text('').hide();
        let txtBankAccountNo = $('#txtBankAccountNo').val();
        if (!$.isEmptyObject(this.value) && !$.isEmptyObject(txtBankAccountNo) && this.value != txtBankAccountNo)
            $(this).next().text('Bank Account Number does not match').show();

    } catch (e) {
        fnException(e); return false;
    }
});

$('#btnCancel04,#btnOrAddNewBank').bind('click', Reset_step4);

//Application form upload button
$('#btnUploadCancelledChequeCopy').click(function () {
    this.disabled = true;

    try {
        //$('#msgFormUpload').text('');

        if (ValidateFileUploadCancelledChequeCopy()) {
            let App_No = $('#lblApplicationNumber').text();
            let flvUpload = $('#flvCancelledChequeCopy').get(0).files;
            let FDRNo = $('#lblExistingFDRNumber').text();
            let FolioNo = $('#lblFolioNumber').text();
            let LastInvDate = $('#lblLastInvestmentDate').text();
            let Depositor_Status_Code = $('#ddlDepositorsStatus').val();

            let _DocUpload = new FormData();
            _DocUpload.append("App_No", App_No)
            _DocUpload.append("Doc_File", flvUpload[0])
            _DocUpload.append("State", State);
            _DocUpload.append("Status", Status);
            _DocUpload.append("FolioNo", FolioNo);
            _DocUpload.append("FDRNo", FDRNo);
            _DocUpload.append("LastInvDate", LastInvDate);
            _DocUpload.append("Depositor_Status_Code", Depositor_Status_Code);

            //document upload request log
            DocumentUploadLog('Request', $('#ddlDepositorsStatus').val(), App_No, '01', 'BANK', 'CANCEL_CHEQUE', FDRNo, FolioNo);

            $.ajax({
                url: WA_FD_BTP + 'DocumentUpload/SaveCancelledChequeCopy',
                type: "POST",
                data: _DocUpload,
                async: true,
                contentType: false,
                processData: false,
                beforeSend: OnBeforeSendCall,
                success: function (result) {
                    if (!$.isEmptyObject(result) && result.validResponse) {
                        //$('#msgFormUpload').hide().text(result.msg).fadeIn('slow').delay(5000).hide(1);
                        BtpMessagePopup(result.msg, 'success');
                    }
                    else if (!$.isEmptyObject(result) && !result.validResponse) {
                        let htmlMsg = '<p>' + result.msg + '</p>';
                        BtpMessagePopup(htmlMsg, 'error');
                        $('#flvCancelledChequeCopy').focus();
                    }
                    else {
                        BtpMessagePopup('<p>Something went wrong, Please upload again..!</p>', 'error');
                        $('#flvCancelledChequeCopy').focus();
                    }

                    $('#flvCancelledChequeCopy').val('');
                    $('#preloader').hide();
                    //refresh ovd details
                    BindOVD(App_No);
                    //document upload response log
                    DocumentUploadLog('Response', $('#ddlDepositorsStatus').val(), App_No, '01', 'BANK', 'CANCEL_CHEQUE', FDRNo, FolioNo);
                },
                error: ErrorFunction,
                complete: null
            });

        }

    } catch (e) {
        this.disabled = false;
        fnException(e); return false;
    }
    this.disabled = false;
});

//Application form file upload control
$('#flvCancelledChequeCopy').on('change', function (e) {
    try {
        let fileNameSplit = $(this)[0].files[0].name.split('.');
        if (!$.isEmptyObject(fileNameSplit)) {
            let isValidFileName = fileNameSplit.length != 2 ? false : true;
            if (isValidFileName) {
                let type = $(this)[0].files[0].type;
                let ext = $(this)[0].files[0].name.split('.')[1];

                if ($.inArray(type, ['image/jpg', 'image/jpeg', 'image/tiff', 'image/tif', 'application/pdf']) == -1
                    || $.inArray(ext.toLowerCase(), ['jpg', 'jpeg', 'pdf', 'tiff', 'tif']) == -1) {

                    $(this).val('');
                    BtpMessagePopup('<p>File should be jpg, jpeg, pdf, tiff, tif</p>', 'error');

                }
                else if (FileSizeValidation($(this).get(0).files)) {
                    $(this).text('');
                    let filename = '';
                    if (!$.isEmptyObject($(this)[0].files)) {
                        filename = $(this)[0].files['0'].name;
                    }
                }
            }
            else {
                $(this).val('');
                BtpMessagePopup('<p>Incorrect file name, Please upload valid file</p>', 'error');
            }
        }
    }
    catch (e) {
        fnException(e); return false;
    }
});
//hide not applicable controls
$('#DV_FH .NAME,#DV_FH #DV_PAN,#DV_FH #DV_DOB,#DV_FH #DV_CKYCNumber').hide();
$('#DV_FH_P_ADDR #DV_MOBILE,#DV_FH_P_ADDR #DV_EMAIL,#DV_FH_M_ADDR #DV_MOBILE,#DV_FH_M_ADDR #DV_EMAIL,#DV_FH_M_ADDR #DV_TELEPHONE').hide();
$('#DV_SH_M_ADDR #DV_MOBILE,#DV_SH_M_ADDR #DV_EMAIL,#DV_SH_M_ADDR #DV_TELEPHONE').hide();
$('#DV_TH_M_ADDR #DV_MOBILE,#DV_TH_M_ADDR #DV_EMAIL,#DV_TH_M_ADDR #DV_TELEPHONE').hide();
//step5 all validations
const SubmitStep5 = function () {
    try {
        $('#preloader').show();

        let errMessage = "";
        let isError = false;

        //FH save validations
        if ($('#ddlHolderType').val() == '01')
            errMessage = FH_Save_Validations();

        //SH save validations
        else if ($('#chkSHApplicable').prop('checked') && $('#ddlHolderType').val() == '02')
            errMessage = SH_Save_Validations();

        //TH save validations
        else if ($('#chkTHApplicable').prop('checked') && $('#ddlHolderType').val() == '03')
            errMessage = TH_Save_Validations();


        //all holder pan validation - 1:2
        if ($('#txtInvPan').val() == $('#DV_SH #txtPAN').val() && $('#txtInvDOB').val() == $('#DV_SH #txtDOB').val() && $('#txtInvPan').val() != '' && $('#txtInvDOB').val() != '')
            errMessage += "<p>Second Holder's PAN number can not be same as Investor's PAN..!</p>";

        //all holder pan validation - 1:3
        if ($('#txtInvPan').val() == $('#DV_TH #txtPAN').val() && $('#txtInvDOB').val() == $('#DV_TH #txtDOB').val() && $('#txtInvPan').val() != '' && $('#DV_TH #txtDOB').val() != '')
            errMessage += "<p>Third Holder's PAN number can not be same as Investor's PAN..!</p>";

        //all holder pan validation - 2:3
        if ($('#DV_SH #txtPAN').val() == $('#DV_TH #txtPAN').val() && $('#DV_SH #txtDOB').val() == $('#DV_TH #txtDOB').val() && $('#DV_SH #txtPAN').val() != '' && $('#DV_SH #txtDOB').val() != '')
            errMessage += "<p>Third Holder's PAN number can not be same Second Holder's PAN..!</p>";

        if (!$.isEmptyObject(errMessage)) {
            BtpMessagePopup(errMessage, 'error');
            return false;
        }

        //communication details validations
        var FH_age = GetAge($('#txtInvDOB').val());
        if (FH_age >= 18) {
            //all holder mobile validation - 1:2
            if ($('#txtMobile').val() == $('#DV_SH_P_ADDR #txtMobileNo').val() && $('#txtMobile').val() != '')
                isError = true;

            //all holder mobile validation - 1:3
            if ($('#txtMobile').val() == $('#DV_TH_P_ADDR #txtMobileNo').val() && $('#txtMobile').val() != '')
                isError = true;

            //all holder email validation - 1:2
            if ($('#txtEmail').val() == $('#DV_SH_P_ADDR #txtEmailId').val() && $('#txtEmail').val() != '')
                isError = true;

            //all holder email validation - 1:3
            if ($('#txtEmail').val() == $('#DV_TH_P_ADDR #txtEmailId').val() && $('#txtEmail').val() != '')
                isError = true;
        }


        if (isError) {
            $('#preloader').hide();
            $('#Model_COMM_VERIFICATION_Msg').modal('show');
            return false;
        }

        //save details----------------------------------------------------------------------------------
        return SaveStep5Details();

    } catch (e) {
        fnException(e); return false;
    }
}
//step5 save
const SaveStep5Details = function () {
    try {
        let InvestorDetailSaveStruct = {};
        let KYCList = [];
        let All_Kyc_Address = [];
        let FATCA_DTLS = [];
        InvestorDetailSaveStruct.IsFATCAApplicable = "N";

        //get first holder details
        if ($('#ddlHolderType').val() == '01') {
            //details
            let FH_GET_DATA = FH_GET_DATA_FOR_SAVE();
            KYCList.push(FH_GET_DATA);

            //permanent address
            let FH_GET_PER_ADDR = FH_GET_PER_ADDR_FOR_SAVE();
            All_Kyc_Address.push(FH_GET_PER_ADDR);

            //mailing address
            let FH_GET_MAIL_ADDR = FH_GET_MAIL_ADDR_FOR_SAVE();
            All_Kyc_Address.push(FH_GET_MAIL_ADDR);

            //overseas address
            if ($('#chkIdOverSeasAddress').prop('checked') && $('#txtOAdd1').val() != '') {
                let FH_GET_OVR_ADDR = FH_GET_OVR_ADDR_FOR_SAVE();
                All_Kyc_Address.push(FH_GET_OVR_ADDR);
            }

            //FATCA Details
            if ($('#btnsldFatca').hasClass('active') || $('#btnsldGreen').hasClass('active')) {
                InvestorDetailSaveStruct.IsFATCAApplicable = "Y";
                let FH_GET_FATCA_DTLS = FH_GET_FATCA_DTLS_FOR_SAVE();
                FATCA_DTLS.push(FH_GET_FATCA_DTLS);
            }
        }
        else if ($('#ddlHolderType').val() == '02') {
            //details
            let SH_GET_DATA = SH_GET_DATA_FOR_SAVE();
            KYCList.push(SH_GET_DATA);

            //permanent address
            let SH_GET_PER_ADDR = SH_GET_PER_ADDR_FOR_SAVE();
            All_Kyc_Address.push(SH_GET_PER_ADDR);

            //mailing address
            let SH_GET_MAIL_ADDR = SH_GET_MAIL_ADDR_FOR_SAVE();
            All_Kyc_Address.push(SH_GET_MAIL_ADDR);

            //FATCA Details
            if ($('#btnSHsldFatca').hasClass('active') || $('#btnSHsldGreen').hasClass('active')) {
                InvestorDetailSaveStruct.IsFATCAApplicable = "Y";
                let SH_GET_FATCA_DTLS = SH_GET_FATCA_DTLS_FOR_SAVE();
                FATCA_DTLS.push(SH_GET_FATCA_DTLS);
            }
        }
        else if ($('#ddlHolderType').val() == '03') {
            //details
            let TH_GET_DATA = TH_GET_DATA_FOR_SAVE();
            KYCList.push(TH_GET_DATA);

            //permanent address
            let TH_GET_PER_ADDR = TH_GET_PER_ADDR_FOR_SAVE();
            All_Kyc_Address.push(TH_GET_PER_ADDR);

            //mailing address
            let TH_GET_MAIL_ADDR = TH_GET_MAIL_ADDR_FOR_SAVE();
            All_Kyc_Address.push(TH_GET_MAIL_ADDR);

            //FATCA Details
            if ($('#btnTHsldFatca').hasClass('active') || $('#btnTHsldGreen').hasClass('active')) {
                InvestorDetailSaveStruct.IsFATCAApplicable = "Y";
                let TH_GET_FATCA_DTLS = TH_GET_FATCA_DTLS_FOR_SAVE();
                FATCA_DTLS.push(TH_GET_FATCA_DTLS);
            }
        }

        InvestorDetailSaveStruct.KYCDataDetails = KYCList;
        InvestorDetailSaveStruct.InvestorAddresses = All_Kyc_Address;
        InvestorDetailSaveStruct.FATCA_DTLS = FATCA_DTLS;

        let isError = true;
        ExtendedAjaxCall('RenewInvestorDetailsSave/SubmitStep5', InvestorDetailSaveStruct, 'POST', function (result) {
            try {
                if (!$.isEmptyObject(result) && result.Status == 1) {
                    if ($('#ddlHolderType').val() == '01')
                        BTP_OBJECT.FHDetailsSave = true;
                    else if ($('#ddlHolderType').val() == '02')
                        BTP_OBJECT.SHDetailsSave = true;
                    else if ($('#ddlHolderType').val() == '03')
                        BTP_OBJECT.THDetailsSave = true;

                    if ($('#ddlSchemes').val() == 'select')
                        $('#ddlCategory').change();

                    isError = false;
                }
                else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg)) {
                    isError = true;
                    BtpMessagePopup(result[0].Msg, "error");
                }
                else {
                    isError = true;
                    BtpMessagePopup('Something went wrong..!', "error");
                }

                $('#preloader').hide();

            } catch (e) {
                fnException(e);
            }
        }, null, true, false, false, ErrorFunction);

        if (isError)
            return false;
        else if ($('#chkSHApplicable').prop('checked') && $.isEmptyObject($('#DV_SH #txtFName').val())) {
            $('#ddlHolderType').val('02').change();
            return false;
        }
        else if ($('#chkTHApplicable').prop('checked') && $.isEmptyObject($('#DV_TH #txtFName').val())) {
            $('#ddlHolderType').val('03').change();
            return false;
        }


        return true;

    } catch (e) {
        fnException(e); return false;
    }
}
//get first holder data
const FH_GET_DATA_FOR_SAVE = function () {
    let FH_DTLS = {};
    try {
        FH_DTLS.Data_Source = BTP_OBJECT.FH_DATA_SOURCE;
        FH_DTLS.IsEditForCKYC = true;
        FH_DTLS.Appl_No = $('#lblApplicationNumber').text().trim();
        FH_DTLS.Holder_Type = '01';
        FH_DTLS.FolioNo = $('#lblFolioNumber').text().trim();
        FH_DTLS.FDRNo = $('#lblExistingFDRNumber').text().trim();
        FH_DTLS.LastInvDate = $('#lblLastInvestmentDate').text().trim();
        FH_DTLS.Kyc_Number = $('#txtInvCKYCNumber').val().trim();
        FH_DTLS.Kyc_NamePrefix = $('#ddlInvtitle').val() == 'select' ? null : $('#ddlInvtitle').val();
        FH_DTLS.Kyc_FirstName = $('#txtInvFirstName').val().trim();
        FH_DTLS.Kyc_MiddleName = $('#txtInvMiddleName').val().trim();
        FH_DTLS.Kyc_LastName = $('#txtInvLastName').val().trim();
        FH_DTLS.Kyc_FullName = $('#txtInvFirstName').val().trim() + ' ' + $('#txtInvMiddleName').val().trim() + ' ' + $('#txtInvLastName').val().trim();
        FH_DTLS.Kyc_DOB = BTP_OBJECT.IND_NIND == 'IND' ? $('#txtInvDOB').val() : $('#txtInvDOI').val();
        FH_DTLS.IsMinor = CheckIsMinor($('#txtInvDOB').val());
        FH_DTLS.Kyc_PAN = $('#txtInvPan').val().trim();
        FH_DTLS.Kyc_Gender = $('#DV_FH #ddlGender').val() == 'select' ? null : $('#DV_FH #ddlGender').val();

        //marital status
        FH_DTLS.Kyc_MaritalStatus = $('#DV_FH #ddlMaritalStatus').val() == 'select' ? null : $('#DV_FH #ddlMaritalStatus').val();

        //father name
        if ($('#DV_FH #txtFatherFName').val().trim() != '') {
            FH_DTLS.Kyc_FatherNamePrefix = $('#DV_FH #ddlFatherTitle').val() == 'select' ? null : $('#DV_FH #ddlFatherTitle').val();
            FH_DTLS.Kyc_FatherFirstName = $('#DV_FH #txtFatherFName').val().trim();
            FH_DTLS.Kyc_FatherMiddleName = $('#DV_FH #txtFatherMName').val().trim();
            FH_DTLS.Kyc_FatherLastName = $('#DV_FH #txtFatherLName').val().trim();
            FH_DTLS.Kyc_FatherFullName = $('#DV_FH #txtFatherFName').val().trim() + ' ' + $('#DV_FH #txtFatherMName').val().trim() + ' ' + $('#DV_FH #txtFatherLName').val().trim();
        }

        //mother name
        if ($('#DV_FH #txtMotherFName').val().trim() != '') {
            FH_DTLS.Kyc_MotherNamePrefix = $('#DV_FH #ddlMotherTitle').val() == 'select' ? null : $('#DV_FH #ddlMotherTitle').val();
            FH_DTLS.Kyc_MotherFirstName = $('#DV_FH #txtMotherFName').val().trim();
            FH_DTLS.Kyc_MotherMiddletName = $('#DV_FH #txtMotherMName').val().trim();
            FH_DTLS.Kyc_MotherLastName = $('#DV_FH #txtMotherLName').val().trim();
            FH_DTLS.Kyc_MotherFullName = $('#DV_FH #txtMotherFName').val().trim() + ' ' + $('#DV_FH #txtMotherMName').val().trim() + ' ' + $('#DV_FH #txtMotherLName').val().trim();
        }

        //spouse name
        if (!FH_DTLS.IsMinor && CheckIsMarried($('#DV_FH #ddlMaritalStatus').val()) && $('#DV_FH #txtSpouseFName').val().trim() != '') {
            FH_DTLS.Kyc_SpouseNamePrefix = $('#DV_FH #ddlSpouseTtitle').val() == 'select' ? null : $('#DV_FH #ddlSpouseTitle').val();
            FH_DTLS.Kyc_SpouseFirstName = $('#DV_FH #txtSpouseFName').val().trim();
            FH_DTLS.Kyc_SpouseMiddleName = $('#DV_FH #txtSpouseMName').val().trim();
            FH_DTLS.Kyc_SpouseLastName = $('#DV_FH #txtSpouseLName').val().trim();
            FH_DTLS.Kyc_SpouseFullName = $('#DV_FH #txtSpouseFName').val().trim() + ' ' + $('#DV_FH #txtSpouseMName').val().trim() + ' ' + $('#DV_FH #txtSpouseLName').val().trim();
        }

        //guardian name
        if (FH_DTLS.IsMinor && !CheckIsMarried($('#DV_FH #ddlMaritalStatus').val()) && $('#DV_FH #txtGuardianFName').val().trim() != '') {
            FH_DTLS.Kyc_GuardianNamePrefix = $('#DV_FH #ddlGuardianTitle').val() == 'select' ? null : $('#DV_FH #ddlGuardianTitle').val();
            FH_DTLS.Kyc_GuardianFirstName = $('#DV_FH #txtGuardianFName').val().trim();
            FH_DTLS.Kyc_GuardianMiddleName = $('#DV_FH #txtGuardianMName').val().trim();
            FH_DTLS.Kyc_GuardianLastName = $('#DV_FH #txtGuardianLName').val().trim();
            FH_DTLS.Kyc_GuardianFullName = $('#DV_FH #txtGuardianFName').val().trim() + ' ' + $('#DV_FH #txtGuardianMName').val().trim() + ' ' + $('#DV_FH #txtGuardianLName').val().trim();
            FH_DTLS.Kyc_Guardian_PAN = $('#DV_FH #txtGuardianPAN').val().trim();
        }

        FH_DTLS.Kyc_Occupation_Code = $('#DV_FH #ddlOccupation').val() == 'select' ? null : $('#DV_FH #ddlOccupation').val();
        FH_DTLS.Kyc_Occupation_Desc = $('#DV_FH #ddlOccupation').val() == 'select' ? null : $('#DV_FH #ddlOccupation :Selected').text().trim();
        FH_DTLS.Is_Tax_Resident = $('#btnsldFatca').hasClass('active');
        FH_DTLS.Is_Green_Card_Holder = $('#btnsldGreen').hasClass('active');
        FH_DTLS.MobilisationMode = $('#DV_FH #hdnMobilisationMode').val();
        FH_DTLS.IND_NIND = $('#ddlDepositorsStatus').val();
        FH_DTLS.Kyc_Annual_Income_Code = $('#DV_FH #ddlAnnualIncome').val() == 'select' ? null : $('#DV_FH #ddlAnnualIncome').val();
        FH_DTLS.Kyc_Annual_Income_Desc = $('#DV_FH #ddlAnnualIncome').val() == 'select' ? null : $('#DV_FH #ddlAnnualIncome :Selected').text().trim();

        //avinash added Occupation / sub - occupation changes
        FH_DTLS.Kyc_Occ_CustSegType = $('#DV_FH #ddlCustSegType').val() == 'select' ? null : $('#DV_FH #ddlCustSegType').val();
        FH_DTLS.Kyc_Occ_CustSegType_Desc = $('#DV_FH #ddlCustSegType').val() == 'select' ? null : $('#DV_FH #ddlCustSegType :Selected').text().trim();

        FH_DTLS.Kyc_Occ_CustSegSubType = $('#DV_FH #ddlCustSegSubType').val() == 'select' ? null : $('#DV_FH #ddlCustSegSubType').val();
        FH_DTLS.Kyc_Occ_CustSegSubType_Desc = $('#DV_FH #ddlCustSegSubType').val() == 'select' ? null : $('#DV_FH #ddlCustSegSubType :Selected').text().trim();





    } catch (e) {
        fnException(e);
    }
    return FH_DTLS;
}
//get first holder permanent address
const FH_GET_PER_ADDR_FOR_SAVE = function () {
    let FH_P_ADDR = {};
    try {
        FH_P_ADDR.Holder_Type = "01";//pass this value accordingly as passing for holder type in investor kyc detail
        FH_P_ADDR.Appl_No = $('#lblApplicationNumber').text().trim();
        FH_P_ADDR.AddType_Code = "PER"; //this will be hard coded value and will not change for any holder
        FH_P_ADDR.AddType_Desc = "Permanent Address";
        FH_P_ADDR.Address1 = $('#DV_FH_P_ADDR #txtAdd1').val().trim();
        FH_P_ADDR.Address2 = $('#DV_FH_P_ADDR #txtAdd2').val().trim();
        FH_P_ADDR.Address3 = $('#DV_FH_P_ADDR #txtAdd3').val().trim();
        FH_P_ADDR.Address_City_Desc = $('#DV_FH_P_ADDR #txtCity').val().trim();
        FH_P_ADDR.AddCountry_Code = $('#DV_FH_P_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_FH_P_ADDR #ddlCountry').val();
        FH_P_ADDR.AddCountry_Desc = $('#DV_FH_P_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_FH_P_ADDR #ddlCountry :Selected').text().trim();
        FH_P_ADDR.MobileNumber = $('#txtMobile').val().trim();
        FH_P_ADDR.ResTelNumber = $('#DV_FH_P_ADDR #txtTelephone').val().trim();
        FH_P_ADDR.EmailAdd = $('#txtEmail').val().trim();
        FH_P_ADDR.AddState_Desc = $('#DV_FH_P_ADDR #txtState').val().trim();
        FH_P_ADDR.Address_District_Desc = $('#DV_FH_P_ADDR #txtDistrict').val().trim();
        FH_P_ADDR.AddPin = $('#DV_FH_P_ADDR #txtPin').val();
        FH_P_ADDR.FolioNo = $('#lblFolioNumber').text().trim();
        FH_P_ADDR.FDRNo = $('#lblExistingFDRNumber').text().trim();
        FH_P_ADDR.LastInvDate = $('#lblLastInvestmentDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return FH_P_ADDR;
}
//get first holder mailing address
const FH_GET_MAIL_ADDR_FOR_SAVE = function () {
    let FH_M_ADDR = {};
    try {
        FH_M_ADDR.Holder_Type = "01";//pass this value accordingly as passing for holder type in investor kyc detail
        FH_M_ADDR.Appl_No = $('#lblApplicationNumber').text().trim();
        FH_M_ADDR.AddType_Code = "MAIL";//this will be hard coded value and will not change for any holder
        FH_M_ADDR.AddType_Desc = "Mailing Address";
        FH_M_ADDR.Address1 = $('#DV_FH_M_ADDR #txtAdd1').val().trim();
        FH_M_ADDR.Address2 = $('#DV_FH_M_ADDR #txtAdd2').val().trim();
        FH_M_ADDR.Address3 = $('#DV_FH_M_ADDR #txtAdd3').val().trim();
        FH_M_ADDR.Address_City_Desc = $('#DV_FH_M_ADDR #txtCity').val().trim();
        FH_M_ADDR.AddCountry_Code = $('#DV_FH_M_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_FH_M_ADDR #ddlCountry').val();
        FH_M_ADDR.AddCountry_Desc = $('#DV_FH_M_ADDR #ddlCountry :Selected').text().trim();
        FH_M_ADDR.AddState_Desc = $('#DV_FH_M_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_FH_M_ADDR #txtState').val().trim();
        FH_M_ADDR.Address_District_Desc = $('#DV_FH_M_ADDR #txtDistrict').val().trim();
        FH_M_ADDR.AddPin = $('#DV_FH_M_ADDR #txtPin').val();
        FH_M_ADDR.FolioNo = $('#lblFolioNumber').text().trim();
        FH_M_ADDR.FDRNo = $('#lblExistingFDRNumber').text().trim();
        FH_M_ADDR.LastInvDate = $('#lblLastInvestmentDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return FH_M_ADDR;
}
//get first holder overseas address
const FH_GET_OVR_ADDR_FOR_SAVE = function () {
    let FH_O_ADDR = {};
    try {
        FH_O_ADDR.Holder_Type = "01";//pass this value accordingly as passing for holder type in investor kyc detail
        FH_O_ADDR.Appl_No = $('#lblApplicationNumber').text().trim();
        FH_O_ADDR.AddType_Code = "OVR"; //this will be hard coded value and will not change for any holder
        FH_O_ADDR.AddType_Desc = "Overseas Address";
        FH_O_ADDR.Address1 = $('#txtOAdd1').val().trim();
        FH_O_ADDR.Address2 = $('#txtOAdd2').val().trim();
        FH_O_ADDR.Address3 = $('#txtOAdd3').val().trim();
        FH_O_ADDR.Address_City_Desc = $('#txtOCity').val().trim();
        FH_O_ADDR.AddCountry_Code = $('#ddlOCountry').val() == 'select' ? null : $('#ddlOCountry').val();
        FH_O_ADDR.AddCountry_Desc = $('#ddlOCountry').val() == 'select' ? null : $('#ddlOCountry :Selected').text().trim();
        FH_O_ADDR.AddState_Desc = $('#txtOState').val().trim();
        FH_O_ADDR.AddPin = $('#txtOPin').val().trim();
        FH_O_ADDR.FolioNo = $('#lblFolioNumber').text().trim();
        FH_O_ADDR.FDRNo = $('#lblExistingFDRNumber').text().trim();
        FH_O_ADDR.LastInvDate = $('#lblLastInvestmentDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return FH_O_ADDR;
}
//get first holder FATCA details
const FH_GET_FATCA_DTLS_FOR_SAVE = function () {
    let dataEntryBO = {};
    try {
        let ListTableBO = [];
        let FATCA_DATA_CITI = [];

        //FATCA details
        if ($('#DV_FH_FATCA #tblDetailList tbody tr').length > 0) {
            $('#DV_FH_FATCA #tblDetailList>tbody tr').each(function (i, tr) {
                var tableBO = {
                    TaxResident_CountryCode: tr.children[2].attributes['code'].nodeValue,//tr.children[2].attr('code'),
                    TaxResident_CountryName: tr.children[2].innerHTML,
                    TaxIdentificationTypeCode: tr.children[3].attributes['code'].nodeValue,// tr.children[3].attr('code'),
                    TaxIdentificationTypeDec: tr.children[3].innerHTML,
                    TaxIdentificationNumber: tr.children[4].innerHTML,
                    TRCExpiryDate: tr.children[5].innerHTML,
                    Address_TypeCode: tr.children[6].attributes['code'].nodeValue,// tr.children[6].attr('code'),
                    Address_TypeDesc: tr.children[6].innerHTML,
                    Address1: tr.children[7].innerHTML,
                    Address2: tr.children[8].innerHTML,
                    Landmark: tr.children[9].innerHTML,
                    State_Code: tr.children[10].attributes['code'].nodeValue,// tr.children[10].attr('code'),
                    State_Name: tr.children[10].innerHTML,
                    City: tr.children[11].innerHTML,
                    Postalcode: tr.children[12].innerHTML,
                    STD_Code_Primary: tr.children[13].innerHTML,
                    Telephone_Number_Primary: tr.children[14].innerHTML,
                    Mobile_Number_Primary: tr.children[15].innerHTML,
                    STD_Code_Other: tr.children[16].innerHTML,
                    Telephone_Number_Other: tr.children[17].innerHTML,
                    Mobile_Number_Other: tr.children[18].innerHTML,
                }

                ListTableBO.push(tableBO);

            });
        }

        //FATCA citizenship
        $('#DV_FH_FATCA #ddlCitizenShip_CitizenShip option:selected').each(function (i) {
            let FATCA_CITI_BO = {
                Citizen_Country_Code: $(this).val(),
                Citizen_Country_Name: $('#DV_FH_FATCA #ddlCitizenShip_CitizenShip option[value="' + $(this).val() + '"]').text()
            }
            FATCA_DATA_CITI.push(FATCA_CITI_BO);

        });

        dataEntryBO.HolderType = '01';
        dataEntryBO.Appl_No = $('#lblApplicationNumber').text().trim();
        dataEntryBO.Nationality_Code = $('#DV_FH_FATCA #ddlNationalityH').val();
        dataEntryBO.Nationality_Dec = $('#DV_FH_FATCA #ddlNationalityH :Selected').text();
        dataEntryBO.CountryOfBirth_Code = $('#DV_FH_FATCA #ddlcountryBirthHead').val();
        dataEntryBO.CountryOfBirth_Name = $('#DV_FH_FATCA #ddlcountryBirthHead :Selected').text();
        dataEntryBO.CityOfBirth_Name = $('#DV_FH_FATCA #txtcityBirthHead').val().trim();
        dataEntryBO.Father_Name = $('#DV_FH_FATCA #txtFathernameHead').val().trim();
        dataEntryBO.Spouse_Name = $('#DV_FH_FATCA #txtSpousenameHead').val().trim();
        dataEntryBO.Occupation_code = $('#DV_FH_FATCA #ddloccupationHead').val();
        dataEntryBO.Occupation_Name = $('#DV_FH_FATCA #ddloccupationHead :Selected').text();
        dataEntryBO.FATCA_Citizen = FATCA_DATA_CITI;
        dataEntryBO.FATCA_Detail = ListTableBO;
        dataEntryBO.FolioNo = $('#lblFolioNumber').text().trim();
        dataEntryBO.FDRNo = $('#lblExistingFDRNumber').text().trim();
        dataEntryBO.LastInvDate = $('#lblLastInvestmentDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return dataEntryBO;
}
const SH_GET_DATA_FOR_SAVE = function () {
    let SH_DTLS = {};
    try {
        SH_DTLS.Data_Source = BTP_OBJECT.SH_DATA_SOURCE;
        SH_DTLS.IsEditForCKYC = true;
        SH_DTLS.FolioNo = $('#hdrSHFolioNo').text().trim();
        SH_DTLS.FDRNo = $('#hdrSHExistingFDRNo').text().trim();
        SH_DTLS.LastInvDate = $('#hdrSHLastInvDate').text().trim();
        SH_DTLS.Kyc_DOB = $('#DV_SH #txtDOB').val();
        SH_DTLS.Kyc_MaritalStatus = $('#DV_SH #ddlMaritalStatus').val() == 'select' ? null : $('#DV_SH #ddlMaritalStatus').val();
        SH_DTLS.IsMinor = CheckIsMinor($('#DV_SH #txtDOB').val());
        SH_DTLS.Holder_Type = '02';
        SH_DTLS.Appl_No = $('#lblApplicationNumber').text().trim();
        SH_DTLS.Kyc_Number = $('#DV_SH #txtCKYCNumber').val().trim();
        SH_DTLS.Kyc_NamePrefix = $('#DV_SH #ddlTitle').val() == 'select' ? null : $('#DV_SH #ddlTitle').val();
        SH_DTLS.Kyc_FirstName = $('#DV_SH #txtFName').val().trim();
        SH_DTLS.Kyc_MiddleName = $('#DV_SH #txtMName').val().trim();
        SH_DTLS.Kyc_LastName = $('#DV_SH #txtLName').val().trim();
        SH_DTLS.Kyc_FullName = $('#DV_SH #txtFName').val().trim() + ' ' + $('#DV_SH #txtMName').val().trim() + ' ' + $('#DV_SH #txtLName').val().trim();

        if ($('#DV_SH #txtFatherFName').val().trim() != '') {
            SH_DTLS.Kyc_FatherNamePrefix = $('#DV_SH #ddlFatherTitle').val() == 'select' ? null : $('#DV_SH #ddlFatherTitle').val();
            SH_DTLS.Kyc_FatherFirstName = $('#DV_SH #txtFatherFName').val().trim();
            SH_DTLS.Kyc_FatherMiddleName = $('#DV_SH #txtFatherMName').val().trim();
            SH_DTLS.Kyc_FatherLastName = $('#DV_SH #txtFatherLName').val().trim();
            SH_DTLS.Kyc_FatherFullName = $('#DV_SH #txtFatherFName').val().trim() + ' ' + $('#DV_SH #txtFatherMName').val().trim() + ' ' + $('#DV_SH #txtFatherLName').val().trim();
        }

        if ($('#DV_SH #txtMotherFName').val().trim() != '') {
            SH_DTLS.Kyc_MotherNamePrefix = $('#DV_SH #ddlMotherTitle').val() == 'select' ? null : $('#DV_SH #ddlMotherTitle').val();
            SH_DTLS.Kyc_MotherFirstName = $('#DV_SH #txtMotherFName').val().trim();
            SH_DTLS.Kyc_MotherMiddletName = $('#DV_SH #txtMotherMName').val().trim();
            SH_DTLS.Kyc_MotherLastName = $('#DV_SH #txtMotherLName').val().trim();
            SH_DTLS.Kyc_MotherFullName = $('#DV_SH #txtMotherFName').val().trim() + ' ' + $('#DV_SH #txtMotherMName').val().trim() + ' ' + $('#DV_SH #txtMotherLName').val().trim();
        }

        if (!SH_DTLS.IsMinor && CheckIsMarried($('#DV_SH #ddlMaritalStatus').val()) && $('#DV_SH #txtSpouseFName').val().trim() != '') {
            SH_DTLS.Kyc_SpouseNamePrefix = $('#DV_SH #ddlSpouseTtitle').val() == 'select' ? null : $('#DV_SH #ddlSpouseTitle').val();
            SH_DTLS.Kyc_SpouseFirstName = $('#DV_SH #txtSpouseFName').val().trim();
            SH_DTLS.Kyc_SpouseMiddleName = $('#DV_SH #txtSpouseMName').val().trim();
            SH_DTLS.Kyc_SpouseLastName = $('#DV_SH #txtSpouseLName').val().trim();
            SH_DTLS.Kyc_SpouseFullName = $('#DV_SH #txtSpouseFName').val().trim() + ' ' + $('#DV_SH #txtSpouseMName').val().trim() + ' ' + $('#DV_SH #txtSpouseLName').val().trim();
        }

        if (SH_DTLS.IsMinor && !CheckIsMarried($('#DV_SH #ddlMaritalStatus').val()) && $('#DV_SH #txtGuardianFName').val().trim() != '') {
            SH_DTLS.Kyc_GuardianNamePrefix = $('#DV_SH #ddlGuardianTitle').val() == 'select' ? null : $('#DV_SH #ddlGuardianTitle').val();
            SH_DTLS.Kyc_GuardianFirstName = $('#DV_SH #txtGuardianFName').val().trim();
            SH_DTLS.Kyc_GuardianMiddleName = $('#DV_SH #txtGuardianMName').val().trim();
            SH_DTLS.Kyc_GuardianLastName = $('#DV_SH #txtGuardianLName').val().trim();
            SH_DTLS.Kyc_GuardianFullName = $('#DV_SH #txtGuardianFName').val().trim() + ' ' + $('#DV_SH #txtGuardianMName').val().trim() + ' ' + $('#DV_SH #txtGuardianLName').val().trim();
            SH_DTLS.Kyc_Guardian_PAN = $('#DV_SH #txtGuardianPAN').val().trim();
        }
        SH_DTLS.Kyc_Gender = $('#DV_SH #ddlGender').val() == 'select' ? null : $('#DV_SH #ddlGender').val();
        SH_DTLS.Kyc_Occupation_Code = $('#DV_SH #ddlOccupation').val() == 'select' ? null : $('#DV_SH #ddlOccupation').val();
        SH_DTLS.Kyc_Occupation_Desc = $('#DV_SH #ddlOccupation').val() == 'select' ? null : $('#DV_SH #ddlOccupation :Selected').text().trim();
        SH_DTLS.Kyc_PAN = $('#DV_SH #txtPAN').val().trim();
        SH_DTLS.Is_Tax_Resident = $('#btnSHsldFatca').hasClass('active');
        SH_DTLS.Is_Green_Card_Holder = $('#btnSHsldGreen').hasClass('active');
        SH_DTLS.MobilisationMode = $('#DV_SH #hdnMobilisationMode').val();
        SH_DTLS.SourceTableId = $('#hdnSHSourceTableId').val();
        SH_DTLS.IND_NIND = $('#ddlDepositorsStatus').val();
        SH_DTLS.Kyc_Annual_Income_Code = $('#DV_SH #ddlAnnualIncome').val() == 'select' ? null : $('#DV_SH #ddlAnnualIncome').val();
        SH_DTLS.Kyc_Annual_Income_Desc = $('#DV_SH #ddlAnnualIncome').val() == 'select' ? null : $('#DV_SH #ddlAnnualIncome :Selected').text().trim();

        //avinash added Occupation / sub - occupation changes
        SH_DTLS.Kyc_Occ_CustSegType = $('#DV_SH #ddlCustSegType').val() == 'select' ? null : $('#DV_SH #ddlCustSegType').val();
        SH_DTLS.Kyc_Occ_CustSegType_Desc = $('#DV_SH #ddlCustSegType').val() == 'select' ? null : $('#DV_SH #ddlCustSegType :Selected').text().trim();

        SH_DTLS.Kyc_Occ_CustSegSubType = $('#DV_SH #ddlCustSegSubType').val() == 'select' ? null : $('#DV_SH #ddlCustSegSubType').val();
        SH_DTLS.Kyc_Occ_CustSegSubType_Desc = $('#DV_SH #ddlCustSegSubType').val() == 'select' ? null : $('#DV_SH #ddlCustSegSubType :Selected').text().trim();

        $('#HdnCustSeg_typeCode_SH').val($('#DV_SH #ddlCustSegType').val());


    } catch (e) {
        fnException(e);
    }
    return SH_DTLS;
}
const SH_GET_PER_ADDR_FOR_SAVE = function () {
    let SH_P_ADDR = {};
    try {
        SH_P_ADDR.Holder_Type = '02';//pass this value accordingly as passing for holder type in investor kyc detail
        SH_P_ADDR.Appl_No = $('#lblApplicationNumber').text().trim();
        SH_P_ADDR.AddType_Code = "PER"; //this will be hard coded value and will not change for any holder
        SH_P_ADDR.AddType_Desc = "Permanent Address";
        SH_P_ADDR.Address1 = $('#DV_SH_P_ADDR #txtAdd1').val().trim();
        SH_P_ADDR.Address2 = $('#DV_SH_P_ADDR #txtAdd2').val().trim();
        SH_P_ADDR.Address3 = $('#DV_SH_P_ADDR #txtAdd3').val().trim();
        SH_P_ADDR.Address_City_Desc = $('#DV_SH_P_ADDR #txtCity').val().trim();
        SH_P_ADDR.AddCountry_Code = $('#DV_SH_P_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_SH_P_ADDR #ddlCountry').val();
        SH_P_ADDR.AddCountry_Desc = $('#DV_SH_P_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_SH_P_ADDR #ddlCountry :Selected').text().trim();
        SH_P_ADDR.MobileNumber = $('#txtMobileNo').val().trim();
        SH_P_ADDR.ResTelNumber = $('#DV_SH_P_ADDR #txtTelephone').val().trim();
        SH_P_ADDR.EmailAdd = $('#txtEmailId').val().trim();
        SH_P_ADDR.AddState_Desc = $('#DV_SH_P_ADDR #txtState').val().trim();
        SH_P_ADDR.Address_District_Desc = $('#DV_SH_P_ADDR #txtDistrict').val().trim();
        SH_P_ADDR.AddPin = $('#DV_SH_P_ADDR #txtPin').val();
        SH_P_ADDR.FolioNo = $('#hdrSHFolioNo').text().trim();
        SH_P_ADDR.FDRNo = $('#hdrSHExistingFDRNo').text().trim();
        SH_P_ADDR.LastInvDate = $('#hdrSHLastInvDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return SH_P_ADDR;
}
const SH_GET_MAIL_ADDR_FOR_SAVE = function () {
    let SH_M_ADDR = {};
    try {
        SH_M_ADDR.Holder_Type = '02';//pass this value accordingly as passing for holder type in investor kyc detail
        SH_M_ADDR.Appl_No = $('#lblApplicationNumber').text().trim();
        SH_M_ADDR.AddType_Code = "MAIL";//this will be hard coded value and will not change for any holder
        SH_M_ADDR.AddType_Desc = "Mailing Address";
        SH_M_ADDR.Address1 = $('#DV_SH_M_ADDR #txtAdd1').val().trim();
        SH_M_ADDR.Address2 = $('#DV_SH_M_ADDR #txtAdd2').val().trim();
        SH_M_ADDR.Address3 = $('#DV_SH_M_ADDR #txtAdd3').val().trim();
        SH_M_ADDR.Address_City_Desc = $('#DV_SH_M_ADDR #txtCity').val().trim();
        SH_M_ADDR.AddCountry_Code = $('#DV_SH_M_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_SH_M_ADDR #ddlCountry').val();
        SH_M_ADDR.AddCountry_Desc = $('#DV_SH_M_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_SH_M_ADDR #ddlCountry :Selected').text().trim();
        SH_M_ADDR.AddState_Desc = $('#DV_SH_M_ADDR #txtState').val().trim();
        SH_M_ADDR.Address_District_Desc = $('#DV_SH_M_ADDR #txtDistrict').val().trim();
        SH_M_ADDR.AddPin = $('#DV_SH_M_ADDR #txtPin').val();
        SH_M_ADDR.FolioNo = $('#hdrSHFolioNo').text().trim();
        SH_M_ADDR.FDRNo = $('#hdrSHExistingFDRNo').text().trim();
        SH_M_ADDR.LastInvDate = $('#hdrSHLastInvDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return SH_M_ADDR;
}
const SH_GET_FATCA_DTLS_FOR_SAVE = function () {
    let dataEntryBO = {};
    try {
        let ListTableBO = [];
        let FATCA_DATA_CITI = [];

        if ($('#DV_SH_FATCA #tblDetailList tbody tr').length > 0) {
            $('#DV_SH_FATCA #tblDetailList>tbody tr').each(function (i, tr) {
                let tableBO = {
                    TaxResident_CountryCode: tr.children[2].attributes['code'].nodeValue,//tr.children[2].attr('code'),
                    TaxResident_CountryName: tr.children[2].innerHTML,
                    TaxIdentificationTypeCode: tr.children[3].attributes['code'].nodeValue,// tr.children[3].attr('code'),
                    TaxIdentificationTypeDec: tr.children[3].innerHTML,
                    TaxIdentificationNumber: tr.children[4].innerHTML,
                    TRCExpiryDate: tr.children[5].innerHTML,
                    Address_TypeCode: tr.children[6].attributes['code'].nodeValue,// tr.children[6].attr('code'),
                    Address_TypeDesc: tr.children[6].innerHTML,
                    Address1: tr.children[7].innerHTML,
                    Address2: tr.children[8].innerHTML,
                    Landmark: tr.children[9].innerHTML,
                    State_Code: tr.children[10].attributes['code'].nodeValue,// tr.children[10].attr('code'),
                    State_Name: tr.children[10].innerHTML,
                    City: tr.children[11].innerHTML,
                    Postalcode: tr.children[12].innerHTML,
                    STD_Code_Primary: tr.children[13].innerHTML,
                    Telephone_Number_Primary: tr.children[14].innerHTML,
                    Mobile_Number_Primary: tr.children[15].innerHTML,
                    STD_Code_Other: tr.children[16].innerHTML,
                    Telephone_Number_Other: tr.children[17].innerHTML,
                    Mobile_Number_Other: tr.children[18].innerHTML,
                }

                ListTableBO.push(tableBO);
            });
        }

        $('#DV_SH_FATCA #ddlCitizenShip_CitizenShip option:selected').each(function (i) {
            let FATCA_CITI_BO = {
                Citizen_Country_Code: $(this).val(),
                Citizen_Country_Name: $('#DV_SH_FATCA #ddlCitizenShip_CitizenShip option[value="' + $(this).val() + '"]').text()
            }
            FATCA_DATA_CITI.push(FATCA_CITI_BO);
        });

        dataEntryBO.HolderType = '02';
        dataEntryBO.Appl_No = $('#lblApplicationNumber').val().trim();
        dataEntryBO.Nationality_Code = $('#DV_SH_FATCA #ddlNationalityH').val();
        dataEntryBO.Nationality_Dec = $('#DV_SH_FATCA #ddlNationalityH Selected').text();
        dataEntryBO.CountryOfBirth_Code = $('#DV_SH_FATCA #ddlcountryBirthHead').val();
        dataEntryBO.CountryOfBirth_Name = $('#DV_SH_FATCA #ddlcountryBirthHead Selected').text();
        dataEntryBO.CityOfBirth_Name = $('#DV_SH_FATCA #txtcityBirthHead').val().trim();
        dataEntryBO.Father_Name = $('#DV_SH_FATCA #txtFathernameHead').val().trim();
        dataEntryBO.Spouse_Name = $('#DV_SH_FATCA #txtSpousenameHead').val().trim();
        dataEntryBO.Occupation_code = $('#DV_SH_FATCA #ddloccupationHead').val();
        dataEntryBO.Occupation_Name = $('#DV_SH_FATCA #ddloccupationHead Selected').text();
        dataEntryBO.FATCA_Citizen = FATCA_DATA_CITI;
        dataEntryBO.FATCA_Detail = ListTableBO;
        dataEntryBO.FolioNo = $('#lblFolioNumber').text().trim();
        dataEntryBO.FDRNo = $('#lblExistingFDRNumber').text().trim();
        dataEntryBO.LastInvDate = $('#lblLastInvestmentDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return dataEntryBO;
}
const TH_GET_DATA_FOR_SAVE = function () {
    let TH_DTLS = {};
    try {
        TH_DTLS.Data_Source = BTP_OBJECT.TH_DATA_SOURCE;
        TH_DTLS.IsEditForCKYC = true;
        TH_DTLS.FolioNo = $('#hdrTHFolioNo').text().trim();
        TH_DTLS.FDRNo = $('#hdrTHExistingFDRNo').text().trim();
        TH_DTLS.LastInvDate = $('#hdrTHLastInvDate').text().trim();
        TH_DTLS.Kyc_DOB = $('#DV_TH #txtDOB').val();
        TH_DTLS.Kyc_MaritalStatus = $('#DV_TH #ddlMaritalStatus').val() == 'select' ? null : $('#DV_TH #ddlMaritalStatus').val();
        TH_DTLS.IsMinor = CheckIsMinor($('#DV_TH #txtDOB').val());
        TH_DTLS.Holder_Type = '03';
        TH_DTLS.Appl_No = $('#lblApplicationNumber').text().trim();
        TH_DTLS.Kyc_Number = $('#DV_TH #txtCKYCNumber').val().trim();
        TH_DTLS.Kyc_NamePrefix = $('#DV_TH #ddlTitle').val() == 'select' ? null : $('#DV_TH #ddlTitle').val();
        TH_DTLS.Kyc_FirstName = $('#DV_TH #txtFName').val().trim();
        TH_DTLS.Kyc_MiddleName = $('#DV_TH #txtMName').val().trim();
        TH_DTLS.Kyc_LastName = $('#DV_TH #txtLName').val().trim();
        TH_DTLS.Kyc_FullName = $('#DV_TH #txtFName').val().trim() + ' ' + $('#DV_TH #txtMName').val().trim() + ' ' + $('#DV_TH #txtLName').val().trim();

        if ($('#DV_TH #txtFatherFName').val().trim() != '') {
            TH_DTLS.Kyc_FatherNamePrefix = $('#DV_TH #ddlFatherTitle').val() == 'select' ? null : $('#DV_TH #ddlFatherTitle').val();
            TH_DTLS.Kyc_FatherFirstName = $('#DV_TH #txtFatherFName').val().trim();
            TH_DTLS.Kyc_FatherMiddleName = $('#DV_TH #txtFatherMName').val().trim();
            TH_DTLS.Kyc_FatherLastName = $('#DV_TH #txtFatherLName').val().trim();
            TH_DTLS.Kyc_FatherFullName = $('#DV_TH #txtFatherFName').val().trim() + ' ' + $('#DV_TH #txtFatherMName').val().trim() + ' ' + $('#DV_TH #txtFatherLName').val().trim();
        }

        if ($('#DV_TH #txtMotherFName').val().trim() != '') {
            TH_DTLS.Kyc_MotherNamePrefix = $('#DV_TH #ddlMotherTitle').val() == 'select' ? null : $('#DV_TH #ddlMotherTitle').val();
            TH_DTLS.Kyc_MotherFirstName = $('#DV_TH #txtMotherFName').val().trim();
            TH_DTLS.Kyc_MotherMiddletName = $('#DV_TH #txtMotherMName').val().trim();
            TH_DTLS.Kyc_MotherLastName = $('#DV_TH #txtMotherLName').val().trim();
            TH_DTLS.Kyc_MotherFullName = $('#DV_TH #txtMotherFName').val().trim() + ' ' + $('#DV_TH #txtMotherMName').val().trim() + ' ' + $('#DV_TH #txtMotherLName').val().trim();
        }

        if (!TH_DTLS.IsMinor && CheckIsMarried($('#DV_TH #ddlMaritalStatus').val()) && $('#DV_TH #txtSpouseFName').val().trim() != '') {
            TH_DTLS.Kyc_SpouseNamePrefix = $('#DV_TH #ddlSpouseTtitle').val() == 'select' ? null : $('#DV_TH #ddlSpouseTitle').val();
            TH_DTLS.Kyc_SpouseFirstName = $('#DV_TH #txtSpouseFName').val().trim();
            TH_DTLS.Kyc_SpouseMiddleName = $('#DV_TH #txtSpouseMName').val().trim();
            TH_DTLS.Kyc_SpouseLastName = $('#DV_TH #txtSpouseLName').val().trim();
            TH_DTLS.Kyc_SpouseFullName = $('#DV_TH #txtSpouseFName').val().trim() + ' ' + $('#DV_TH #txtSpouseMName').val().trim() + ' ' + $('#DV_TH #txtSpouseLName').val().trim();
        }

        if (TH_DTLS.IsMinor && !CheckIsMarried($('#DV_TH #ddlMaritalStatus').val()) && $('#DV_TH #txtGuardianFName').val().trim() != '') {
            TH_DTLS.Kyc_GuardianNamePrefix = $('#DV_TH #ddlGuardianTitle').val() == 'select' ? null : $('#DV_TH #ddlGuardianTitle').val();
            TH_DTLS.Kyc_GuardianFirstName = $('#DV_TH #txtGuardianFName').val().trim();
            TH_DTLS.Kyc_GuardianMiddleName = $('#DV_TH #txtGuardianMName').val().trim();
            TH_DTLS.Kyc_GuardianLastName = $('#DV_TH #txtGuardianLName').val().trim();
            TH_DTLS.Kyc_GuardianFullName = $('#DV_TH #txtGuardianFName').val().trim() + ' ' + $('#DV_TH #txtGuardianMName').val().trim() + ' ' + $('#DV_TH #txtGuardianLName').val().trim();
            TH_DTLS.Kyc_Guardian_PAN = $('#DV_TH #txtGuardianPAN').val().trim();
        }

        TH_DTLS.Kyc_Gender = $('#DV_TH #ddlGender').val() == 'select' ? null : $('#DV_TH #ddlGender').val();
        TH_DTLS.Kyc_Occupation_Code = $('#DV_TH #ddlOccupation').val() == 'select' ? null : $('#DV_TH #ddlOccupation').val();
        TH_DTLS.Kyc_Occupation_Desc = $('#DV_TH #ddlOccupation').val() == 'select' ? null : $('#DV_TH #ddlOccupation :Selected').text().trim();
        TH_DTLS.Kyc_PAN = $('#DV_TH #txtPAN').val().trim();
        TH_DTLS.Is_Tax_Resident = $('#btnTHsldFatca').hasClass('active');
        TH_DTLS.Is_Green_Card_Holder = $('#btnTHsldGreen').hasClass('active');
        TH_DTLS.MobilisationMode = $('#DV_TH #hdnMobilisationMode').val();
        TH_DTLS.SourceTableId = $('#hdnTHSourceTableId').val();
        TH_DTLS.IND_NIND = $('#ddlDepositorsStatus').val();
        TH_DTLS.Kyc_Annual_Income_Code = $('#DV_TH #ddlAnnualIncome').val() == 'select' ? null : $('#DV_TH #ddlAnnualIncome').val();
        TH_DTLS.Kyc_Annual_Income_Desc = $('#DV_TH #ddlAnnualIncome').val() == 'select' ? null : $('#DV_TH #ddlAnnualIncome :Selected').text().trim();

        //avinash added Occupation / sub - occupation changes
        TH_DTLS.Kyc_Occ_CustSegType = $('#DV_TH #ddlCustSegType').val() == 'select' ? null : $('#DV_TH #ddlCustSegType').val();
        TH_DTLS.Kyc_Occ_CustSegType_Desc = $('#DV_TH #ddlCustSegType').val() == 'select' ? null : $('#DV_TH #ddlCustSegType :Selected').text().trim();

        TH_DTLS.Kyc_Occ_CustSegSubType = $('#DV_TH #ddlCustSegSubType').val() == 'select' ? null : $('#DV_TH #ddlCustSegSubType').val();
        TH_DTLS.Kyc_Occ_CustSegSubType_Desc = $('#DV_TH #ddlCustSegSubType').val() == 'select' ? null : $('#DV_TH #ddlCustSegSubType :Selected').text().trim();

        $('#HdnCustSeg_typeCode_TH').val($('#DV_TH #ddlCustSegType').val());


    } catch (e) {
        fnException(e);
    }
    return TH_DTLS;
}
const TH_GET_PER_ADDR_FOR_SAVE = function () {
    let TH_P_ADDR = {};
    try {
        TH_P_ADDR.Holder_Type = '03';//pass this value accordingly as passing for holder type in investor kyc detail
        TH_P_ADDR.Appl_No = $('#lblApplicationNumber').text().trim();
        TH_P_ADDR.AddType_Code = "PER"; //this will be hard coded value and will not change for any holder
        TH_P_ADDR.AddType_Desc = "Permanent Address";
        TH_P_ADDR.Address1 = $('#DV_TH_P_ADDR #txtAdd1').val().trim();
        TH_P_ADDR.Address2 = $('#DV_TH_P_ADDR #txtAdd2').val().trim();
        TH_P_ADDR.Address3 = $('#DV_TH_P_ADDR #txtAdd3').val().trim();
        TH_P_ADDR.Address_City_Desc = $('#DV_TH_P_ADDR #txtCity').val().trim();
        TH_P_ADDR.AddCountry_Code = $('#DV_TH_P_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_TH_P_ADDR #ddlCountry').val();
        TH_P_ADDR.AddCountry_Desc = $('#DV_TH_P_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_TH_P_ADDR #ddlCountry :Selected').text().trim();
        TH_P_ADDR.MobileNumber = $('#txtMobileNo').val().trim();
        TH_P_ADDR.ResTelNumber = $('#DV_TH_P_ADDR #txtTelephone').val().trim();
        TH_P_ADDR.EmailAdd = $('#txtEmailId').val().trim();
        TH_P_ADDR.AddState_Desc = $('#DV_TH_P_ADDR #txtState').val().trim();
        TH_P_ADDR.Address_District_Desc = $('#DV_TH_P_ADDR #txtDistrict').val().trim();
        TH_P_ADDR.AddPin = $('#DV_TH_P_ADDR #txtPin').val();
        TH_P_ADDR.FolioNo = $('#hdrTHFolioNo').text().trim();
        TH_P_ADDR.FDRNo = $('#hdrTHExistingFDRNo').text().trim();
        TH_P_ADDR.LastInvDate = $('#hdrTHLastInvDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return TH_P_ADDR;
}
const TH_GET_MAIL_ADDR_FOR_SAVE = function () {
    let TH_M_ADDR = {};
    try {
        TH_M_ADDR.Holder_Type = '03';//pass this value accordingly as passing for holder type in investor kyc detail
        TH_M_ADDR.Appl_No = $('#lblApplicationNumber').text().trim();
        TH_M_ADDR.AddType_Code = "MAIL";//this will be hard coded value and will not change for any holder
        TH_M_ADDR.AddType_Desc = "Mailing Address";
        TH_M_ADDR.Address1 = $('#DV_TH_M_ADDR #txtAdd1').val().trim();
        TH_M_ADDR.Address2 = $('#DV_TH_M_ADDR #txtAdd2').val().trim();
        TH_M_ADDR.Address3 = $('#DV_TH_M_ADDR #txtAdd3').val().trim();
        TH_M_ADDR.Address_City_Desc = $('#DV_TH_M_ADDR #txtCity').val().trim();
        TH_M_ADDR.AddCountry_Code = $('#DV_TH_M_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_TH_M_ADDR #ddlCountry').val();
        TH_M_ADDR.AddCountry_Desc = $('#DV_TH_M_ADDR #ddlCountry').val() == 'select' ? null : $('#DV_TH_M_ADDR #ddlCountry :Selected').text().trim();
        TH_M_ADDR.AddState_Desc = $('#DV_TH_M_ADDR #txtState').val().trim();
        TH_M_ADDR.Address_District_Desc = $('#DV_TH_M_ADDR #txtDistrict').val().trim();
        TH_M_ADDR.AddPin = $('#DV_TH_M_ADDR #txtPin').val();
        TH_M_ADDR.FolioNo = $('#hdrTHFolioNo').text().trim();
        TH_M_ADDR.FDRNo = $('#hdrTHExistingFDRNo').text().trim();
        TH_M_ADDR.LastInvDate = $('#hdrTHLastInvDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return TH_M_ADDR;
}
const TH_GET_FATCA_DTLS_FOR_SAVE = function () {
    let dataEntryBO = {};
    try {
        let ListTableBO = [];
        let FATCA_DATA_CITI = [];

        if ($('#DV_TH_FATCA #tblDetailList tbody tr').length > 0) {
            $('#DV_TH_FATCA #tblDetailList>tbody tr').each(function (i, tr) {
                let tableBO = {
                    TaxResident_CountryCode: tr.children[2].attributes['code'].nodeValue,//tr.children[2].attr('code'),
                    TaxResident_CountryName: tr.children[2].innerHTML,
                    TaxIdentificationTypeCode: tr.children[3].attributes['code'].nodeValue,// tr.children[3].attr('code'),
                    TaxIdentificationTypeDec: tr.children[3].innerHTML,
                    TaxIdentificationNumber: tr.children[4].innerHTML,
                    TRCExpiryDate: tr.children[5].innerHTML,
                    Address_TypeCode: tr.children[6].attributes['code'].nodeValue,// tr.children[6].attr('code'),
                    Address_TypeDesc: tr.children[6].innerHTML,
                    Address1: tr.children[7].innerHTML,
                    Address2: tr.children[8].innerHTML,
                    Landmark: tr.children[9].innerHTML,
                    State_Code: tr.children[10].attributes['code'].nodeValue,// tr.children[10].attr('code'),
                    State_Name: tr.children[10].innerHTML,
                    City: tr.children[11].innerHTML,
                    Postalcode: tr.children[12].innerHTML,
                    STD_Code_Primary: tr.children[13].innerHTML,
                    Telephone_Number_Primary: tr.children[14].innerHTML,
                    Mobile_Number_Primary: tr.children[15].innerHTML,
                    STD_Code_Other: tr.children[16].innerHTML,
                    Telephone_Number_Other: tr.children[17].innerHTML,
                    Mobile_Number_Other: tr.children[18].innerHTML,
                }

                ListTableBO.push(tableBO);
            });
        }

        $('#DV_TH_FATCA #ddlCitizenShip_CitizenShip option:selected').each(function (i) {
            let FATCA_CITI_BO = {
                Citizen_Country_Code: $(this).val(),
                Citizen_Country_Name: $('#DV_TH_FATCA #ddlCitizenShip_CitizenShip option[value="' + $(this).val() + '"]').text()
            }
            FATCA_DATA_CITI.push(FATCA_CITI_BO);
        });

        dataEntryBO.HolderType = '03';
        dataEntryBO.Appl_No = $('#lblApplicationNumber').val().trim();
        dataEntryBO.Nationality_Code = $('#DV_TH_FATCA #ddlNationalityH').val();
        dataEntryBO.Nationality_Dec = $('#DV_TH_FATCA #ddlNationalityH Selected').text();
        dataEntryBO.CountryOfBirth_Code = $('#DV_TH_FATCA #ddlcountryBirthHead').val();
        dataEntryBO.CountryOfBirth_Name = $('#DV_TH_FATCA #ddlcountryBirthHead Selected').text();
        dataEntryBO.CityOfBirth_Name = $('#DV_TH_FATCA #txtcityBirthHead').val().trim();
        dataEntryBO.Father_Name = $('#DV_TH_FATCA #txtFathernameHead').val().trim();
        dataEntryBO.Spouse_Name = $('#DV_TH_FATCA #txtSpousenameHead').val().trim();
        dataEntryBO.Occupation_code = $('#DV_TH_FATCA #ddloccupationHead').val();
        dataEntryBO.Occupation_Name = $('#DV_TH_FATCA #ddloccupationHead Selected').text();
        dataEntryBO.FATCA_Citizen = FATCA_DATA_CITI;
        dataEntryBO.FATCA_Detail = ListTableBO;
        dataEntryBO.FolioNo = $('#lblFolioNumber').text().trim();
        dataEntryBO.FDRNo = $('#lblExistingFDRNumber').text().trim();
        dataEntryBO.LastInvDate = $('#lblLastInvestmentDate').text().trim();


    } catch (e) {
        fnException(e);
    }
    return dataEntryBO;
}
//first holder save validations
const FH_Save_Validations = function () {
    let err_msg = '';
    try {
        $('.HOLD_DTL').removeClass('InputBorderRed');
        $('.MORE_DTL').removeClass('InputBorderRed');
        $('.D_T_E').parent().removeClass('InputBorderRed');

        let txtDOB = $('#txtInvDOB').val();
        let IsInvMinor = CheckIsMinor(txtDOB);
        let IsInvMarried = CheckIsMarried($('#DV_FH #ddlMaritalStatus').val());


        //name
        if ($.isEmptyObject($('#txtInvFirstName').val())) {
            err_msg += "<p>Investor's name is required..!</p>";
            $('#ddlInvtitle').addClass('InputBorderRed');
        }

        //pan
        if ($.isEmptyObject($('#txtInvPan').val()) && (!IsMinor(txtDOB) && BTP_OBJECT.IND_NIND != 'IND')) {
            err_msg += "<p>Investor's PAN is required..!</p>";
            $('#txtInvPan').addClass('InputBorderRed');
        }

        if (BTP_OBJECT.IND_NIND == 'IND') {
            //title  
            if ($('#ddlInvtitle').val() == 'select') {
                err_msg += "<p>Investor's name prefix is required..!</p>";
                $('#ddlInvtitle').addClass('InputBorderRed');
            }

            //dob
            if ($.isEmptyObject(txtDOB)) {
                err_msg += "<p>Investor's date of birth is required..!</p>";
                $('#txtInvDOB').addClass('InputBorderRed');
            }

            //gender
            if ($('#DV_FH #ddlGender').val() == 'select') {
                err_msg += "<p>Investor's gender is required..!</p>";
                $('#DV_FH #ddlGender').addClass('InputBorderRed');
            }

            let $InvFatherName = $('#DV_FH #txtFatherFName');
            let $InvMotherName = $('#DV_FH #txtMotherFName');
            let $InvSpouseName = $('#DV_FH #txtSpouseFName');
            //if ($InvFatherName.val() == '' && $InvMotherName.val() == '' && ($InvSpouseName.val() == '' && IsInvMarried && !IsInvMinor)) {
            if ($InvFatherName.val() == '' && $InvMotherName.val() == '' && $InvSpouseName.val() == '') {
                err_msg += "<p>Investor's father/mother/spouse name is required..!</p>";
            }
            //else if ($InvFatherName.val() == '' && $InvMotherName.val() == '') {
            //    err_msg += "<p>Investor's father/mother Name is required..!</p>";
            //}
            else {
                if ($InvFatherName.val() != '' && $('#DV_FH #ddlFatherTitle').val() == 'select') {
                    err_msg += "<p>Investor's father name prefix is required..!</p>";
                }

                if ($InvMotherName.val() != '' && $('#DV_FH #ddlMotherTitle').val() == 'select') {
                    err_msg += "<p>Investor's mother name prefix is required..!</p>";
                }

                if ($InvSpouseName.val() != '' && $('#DV_FH #ddlSpouseTitle').val() == 'select') {
                    err_msg += "<p>Investor's spouse name prefix is required..!</p>";
                }
            }

            //marital status
            if ($('#DV_FH #ddlMaritalStatus').val() == 'select') {
                err_msg += "<p>Investor's marital status is required..!</p>";
                $('#DV_FH #ddlMaritalStatus').addClass('InputBorderRed');
            }

            ////Annual Income
            //if ($('#DV_FH #ddlAnnualIncome').val() == 'select') {
            //    err_msg += "<p>Investor's annual income is required..!</p>";
            //    $('#DV_FH #ddlAnnualIncome').addClass('InputBorderRed');
            //}

            ////occupation
            //if ($('#DV_FH #ddlOccupation').val() == 'select') {
            //    err_msg += "<p>Investor's occupation is required..!</p>";
            //    $('#DV_FH #ddlOccupation').addClass('InputBorderRed');
            //}

        }
        else {
            //title
            $('#ddlInvtitle').val("M/S").prop('disabled', true).addClass('DisabledControl');

            //doi
            if ($.isEmptyObject($('#txtInvDOI').val())) {
                err_msg += "<p>Investor's date on incorporation is required..!</p>";
                $('#txtInvDOI').addClass('InputBorderRed');
            }
        }

        //Guard pan 
        if ($.isEmptyObject($('#DV_FH #txtGuardianPAN').val()) && (IsMinor(txtDOB) && BTP_OBJECT.IND_NIND == 'IND')) {
            err_msg += "<p>Investor's guardian PAN is required..!</p>";
            $('#DV_FH #txtGuardianPAN').addClass('InputBorderRed');
        }

        //Guard title 
        if ($.isEmptyObject($('#DV_FH #ddlGuardianTitle').val()) && (IsMinor(txtDOB) && BTP_OBJECT.IND_NIND == 'IND')) {
            err_msg += "<p>Investor's guardian name prefix is required..!</p>";
            $('#DV_FH #ddlGuardianTitle').addClass('InputBorderRed');
        }

        //Guard name 
        if ($.isEmptyObject($('#DV_FH #txtGuardianFName').val()) && (IsMinor(txtDOB) && BTP_OBJECT.IND_NIND == 'IND')) {
            err_msg += "<p>Investor's guardian name is required..!</p>";
            $('#DV_FH #txtGuardianFName').addClass('InputBorderRed');
        }

        //Annual Income
        if ($('#DV_FH #ddlAnnualIncome').val() == 'select') {
            err_msg += "<p>Investor's annual income is required..!</p>";
            $('#DV_FH #ddlAnnualIncome').addClass('InputBorderRed');
        }

        //occupation
        if ($('#DV_FH #ddlOccupation').val() == 'select') {
            err_msg += "<p>Investor's occupation is required..!</p>";
            $('#DV_FH #ddlOccupation').addClass('InputBorderRed');
        }


        //Sub-Occupation avinash added Occupation/sub-occupation changes
        if ($('#DV_FH #ddlCustSegType').val() == "select") {
            err_msg += "<p>Customer Segment Type is required..!</p>";
            $('#DV_FH #ddlCustSegType').addClass('InputBorderRed');
        }
        if ($('#DV_FH #ddlCustSegType').val() != 'select' && ($('#DV_FH #ddlCustSegSubType').val() == "select")) {
            err_msg += "<p>Customer Segment SubType is required..!</p>";
            $('#DV_FH #ddlCustSegSubType').addClass('InputBorderRed');
        }

        //mobile
        if ($.isEmptyObject($('#txtMobile').val())) {
            err_msg += "<p>Investor's mobile number is required..!</p>";
            $('#txtMobile').addClass('InputBorderRed');
        }

        //email
        if ($.isEmptyObject($('#txtEmail').val())) {
            err_msg += "<p>Investor's email address is required..!</p>";
            $('#txtEmail').addClass('InputBorderRed');
        }

        //permanent address1
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtAdd1').val())) {
            err_msg += "<p>Investor's permanent address is required..!</p>";
            $('#DV_FH_P_ADDR #txtAdd1').addClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_FH_P_ADDR #ddlCountry').val() == 'select') {
            err_msg += "<p>Investor's permanent country is required..!</p>";
            $('#DV_FH_P_ADDR #ddlCountry').addClass('InputBorderRed');
        }

        //permanent pincode
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtPin').val())) {
            err_msg += "<p>Investor's permanent pincode is required..!</p>";
            $('#DV_FH_P_ADDR #txtPin').addClass('InputBorderRed');
        }

        //permanent state
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtState').val())) {
            err_msg += "<p>Investor's permanent state is required..!</p>";
            $('#DV_FH_P_ADDR #txtState').addClass('InputBorderRed');
        }

        //permanent district
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtDistrict').val())) {
            err_msg += "<p>Investor's permanent district is required..!</p>";
            $('#DV_FH_P_ADDR #txtDistrict').addClass('InputBorderRed');
        }

        //permanent city
        if ($.isEmptyObject($('#DV_FH_P_ADDR #txtCity').val())) {
            err_msg += "<p>Investor's permanent city is required..!</p>";
            $('#DV_FH_P_ADDR #txtCity').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtAdd1').val())) {
            err_msg += "<p>Investor's mailing address is required..!</p>";
            $('#DV_FH_M_ADDR #txtAdd1').addClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_FH_M_ADDR #ddlCountry').val() == 'select') {
            err_msg += "<p>Investor's mailing country is required..!</p>";
            $('#DV_FH_M_ADDR #ddlCountry').addClass('InputBorderRed');
        }

        //mailing pincode
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtPin').val())) {
            err_msg += "<p>Investor's mailing pincode is required..!</p>";
            $('#DV_FH_M_ADDR #txtPin').addClass('InputBorderRed');
        }

        //mailing state
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtState').val())) {
            err_msg += "<p>Investor's mailing state is required..!</p>";
            $('#DV_FH_M_ADDR #txtState').addClass('InputBorderRed');
        }

        //mailing district
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtDistrict').val())) {
            err_msg += "<p>Investor's mailing district is required..!</p>";
            $('#DV_FH_M_ADDR #txtDistrict').addClass('InputBorderRed');
        }

        //mailing city
        if ($.isEmptyObject($('#DV_FH_M_ADDR #txtCity').val())) {
            err_msg += "<p>Investor's mailing city is required..!</p>";
            $('#DV_FH_M_ADDR #txtCity').addClass('InputBorderRed');
        }

        //overseas address1
        if ($('#chkIdOverSeasAddress').prop('checked')) {
            if ($.isEmptyObject($('#txtOAdd1').val())) {
                err_msg += "<p>Investor's overseas address is required..!</p>";
                $('#txtOAdd1').addClass('InputBorderRed');
            }

            //overseas country
            if ($('#ddlOCountry').val() == 'select') {
                err_msg += "<p>Investor's overseas country is required..!</p>";
                $('#ddlOCountry').addClass('InputBorderRed');
            }

            //overseas state
            if ($.isEmptyObject($('#txtOState').val())) {
                err_msg += "<p>Investor's overseas state is required..!</p>";
                $('#txtOState').addClass('InputBorderRed');
            }

            //overseas city
            if ($.isEmptyObject($('#txtOCity').val())) {
                err_msg += "<p>Investor's overseas city is required..!</p>";
                $('#txtOCity').addClass('InputBorderRed');
            }

            //overseas pincode
            if ($.isEmptyObject($('#txtOPin').val())) {
                err_msg += "<p>Investor's overseas pincode is required..!</p>";
                $('#txtOPin').addClass('InputBorderRed');
            }


        }

        //FH FATCA Details
        if ($('#btnsldFatca').hasClass('active') || $('#btnsldGreen').hasClass('active')) {
            $('#DV_FH_FATCA .requiredFatcaDtl').each(function () {
                if ($.isEmptyObject($(this).val()) || $(this).val() == "-1" || $(this).val().toString().toLowerCase() == "select") {
                    if ($(this).attr('errmsg') != "" && $(this).attr('errmsg') != undefined) {
                        err_msg += "<p>" + $(this).attr('errmsg') + "</p>";
                    }
                    $(this).addClass('InputBorderRed');
                }
            });

            if ($('#DV_FH_FATCA #tblDetailList tbody tr').hasClass('empty_table') || $('#DV_FH_FATCA #tblDetailList tbody tr').length == 0) {
                err_msg += "<p>Investor's FATCA details are required..!</p>";
            }
        }
       

    } catch (e) {
        fnException(e);
    }
    return err_msg;
}
//second holder save validations
const SH_Save_Validations = function () {
    let err_msg = '';
    try {
        $('.HOLD_DTL').removeClass('InputBorderRed');
        $('.MORE_DTL').removeClass('InputBorderRed');
        $('.D_T_E').parent().removeClass('InputBorderRed');

        let txtDOB = $('#DV_SH #txtDOB').val();
        let IsSHMinor = CheckIsMinor(txtDOB);
        let IsSHMarried = CheckIsMarried($('#DV_SH #ddlMaritalStatus').val());

        //title  
        if ($('#DV_SH #ddlTitle').val() == 'select' || $('#DV_SH #ddlTitle').val() == '' || $('#DV_SH #ddlTitle').val() == null) {
            err_msg += "<p>Second holder's name prefix is required..!</p>";
            $('#DV_SH #ddlTitle').addClass('InputBorderRed');
        }

        //name
        if ($.isEmptyObject($('#DV_SH #txtFName').val())) {
            err_msg += "<p>Second holder's name is required..!</p>";
            $('#DV_SH #txtFName').addClass('InputBorderRed');
        }

        //dob
        if ($.isEmptyObject(txtDOB)) {
            err_msg += "<p>Second holder's date of birth is required..!</p>";
            $('#txtInvDOB').addClass('InputBorderRed');
        }

        //pan
        if ($('#DV_SH #txtPAN').val() == '' && !IsSHMinor) {
            err_msg += "<p>Second holder's PAN is required..!</p>";
            $('#DV_SH #txtPAN').addClass('InputBorderRed');
        }

        //gender
        if ($('#DV_SH #ddlGender').val() == 'select') {
            err_msg += "<p>Second holder's gender is required..!</p>";
            $('#DV_SH #ddlGender').addClass('InputBorderRed');
        }

        //Guard pan 
        if ($.isEmptyObject($('#DV_SH #txtGuardianPAN').val()) && IsSHMinor) {
            err_msg += "<p>Second holder's guardian PAN is required..!</p>";
            $('#DV_SH #txtGuardianPAN').addClass('InputBorderRed');
        }

        //Guard title 
        if ($.isEmptyObject($('#DV_SH #ddlGuardianTitle').val()) && IsSHMinor) {
            err_msg += "<p>Second holder's guardian name prefix is required..!</p>";
            $('#DV_SH #ddlGuardianTitle').addClass('InputBorderRed');
        }

        //Guard name 
        if ($.isEmptyObject($('#DV_SH #txtGuardianFName').val()) && IsSHMinor) {
            err_msg += "<p>Second holder's guardian name is required..!</p>";
            $('#DV_SH #txtGuardianFName').addClass('InputBorderRed');
        }

        let $SHFatherName = $('#DV_SH #txtFatherFName');
        let $SHMotherName = $('#DV_SH #txtMotherFName');
        let $SHSpouseName = $('#DV_SH #txtSpouseFName');
        //if ($SHFatherName.val() == '' && $SHMotherName.val() == '' && ($SHSpouseName.val() == '' && IsSHMarried && !IsSHMinor)) {
        if ($SHFatherName.val() == '' && $SHMotherName.val() == '' && $SHSpouseName.val() == '') {
            err_msg += "<p>Second holder's father/mother/spouse Name is required..!</p>";
        }
        //else if ($SHFatherName.val() == '' && $SHMotherName.val() == '') {
        //    err_msg += "<p>Second holder's father/mother name is required..!</p>";
        //}
        else {
            if ($SHFatherName.val() != '' && $('#DV_SH #ddlFatherTitle').val() == 'select') {
                err_msg += "<p>Second holder's father name prefix is required..!</p>";
            }

            if ($SHMotherName.val() != '' && $('#DV_SH #ddlMotherTitle').val() == 'select') {
                err_msg += "<p>Second holder's mother name prefix is required..!</p>";
            }

            if ($SHSpouseName.val() != '' && $('#DV_SH #ddlSpouseTitle').val() == 'select') {
                err_msg += "<p>Second holder's spouse name prefix is required..!</p>";
            }
        }

        //marital status
        if ($('#DV_SH #ddlMaritalStatus').val() == 'select') {
            err_msg += "<p>Second holder's marital status is required..!</p>";
            $('#DV_SH #ddlMaritalStatus').addClass('InputBorderRed');
        }

        //Annual Income
        if ($('#DV_SH #ddlAnnualIncome').val() == 'select') {
            err_msg += "<p>Second holder's annual income is required..!</p>";
            $('#DV_SH #ddlAnnualIncome').addClass('InputBorderRed');
        }

        //occupation
        if ($('#DV_SH #ddlOccupation').val() == 'select') {
            err_msg += "<p>Second holder's occupation is required..!</p>";
            $('#DV_SH #ddlOccupation').addClass('InputBorderRed');
        }

        //Sub-Occupation avinash added Occupation/sub-occupation changes

        if ($('#DV_SH #ddlCustSegType').val() == "select" || $('#DV_SH #ddlCustSegType').val() == "" || $('#DV_SH #ddlCustSegType').val() == null) {
            err_msg += "<p>Second holder's Customer Segment Type is required..!</p>";
            $('#DV_SH #ddlCustSegType').addClass('InputBorderRed');
        }
        if ($('#DV_SH #ddlCustSegType').val() != 'select' && ($('#DV_SH #ddlCustSegSubType').val() == "select")) {
            err_msg += "<p>Second holder's Customer Segment SubType is required..!</p>";
            $('#DV_SH #ddlCustSegSubType').addClass('InputBorderRed');
        }

        //permanent address1
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtAdd1').val())) {
            err_msg += "<p>Second holder's permanent address is required..!</p>";
            $('#DV_SH_P_ADDR #txtAdd1').addClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_SH_P_ADDR #ddlCountry').val() == 'select') {
            err_msg += "<p>Second holder's permanent country is required..!</p>";
            $('#DV_SH_P_ADDR #ddlCountry').addClass('InputBorderRed');
        }

        //permanent pincode
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtPin').val())) {
            err_msg += "<p>Second holder's permanent pincode is required..!</p>";
            $('#DV_SH_P_ADDR #txtPin').addClass('InputBorderRed');
        }

        //permanent state
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtState').val())) {
            err_msg += "<p>Second holder's permanent state is required..!</p>";
            $('#DV_SH_P_ADDR #txtState').addClass('InputBorderRed');
        }

        //permanent district
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtDistrict').val())) {
            err_msg += "<p>Second holder's permanent district is required..!</p>";
            $('#DV_SH_P_ADDR #txtDistrict').addClass('InputBorderRed');
        }

        //permanent city
        if ($.isEmptyObject($('#DV_SH_P_ADDR #txtCity').val())) {
            err_msg += "<p>Second holder's permanent city is required..!</p>";
            $('#DV_SH_P_ADDR #txtCity').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtAdd1').val())) {
            err_msg += "<p>Second holder's mailing address is required..!</p>";
            $('#DV_SH_M_ADDR #txtAdd1').addClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_SH_M_ADDR #ddlCountry').val() == 'select') {
            err_msg += "<p>Second holder's mailing country is required..!</p>";
            $('#DV_SH_M_ADDR #ddlCountry').addClass('InputBorderRed');
        }

        //mailing pincode
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtPin').val())) {
            err_msg += "<p>Second holder's mailing pincode is required..!</p>";
            $('#DV_SH_M_ADDR #txtPin').addClass('InputBorderRed');
        }

        //mailing state
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtState').val())) {
            err_msg += "<p>Second holder's mailing state is required..!</p>";
            $('#DV_SH_M_ADDR #txtState').addClass('InputBorderRed');
        }

        //mailing district
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtDistrict').val())) {
            err_msg += "<p>Second holder's mailing district is required..!</p>";
            $('#DV_SH_M_ADDR #txtDistrict').addClass('InputBorderRed');
        }

        //mailing city
        if ($.isEmptyObject($('#DV_SH_M_ADDR #txtCity').val())) {
            err_msg += "<p>Second holder's mailing city is required..!</p>";
            $('#DV_SH_M_ADDR #txtCity').addClass('InputBorderRed');
        }

        //FATCA Details
        if ($('#btnSHsldFatca').hasClass('active') || $('#btnSHsldGreen').hasClass('active')) {
            $('#DV_SH_FATCA .requiredFatcaDtl').each(function () {
                if ($.isEmptyObject($(this).val()) || $(this).val() == "-1" || $(this).val().toString().toLowerCase() == "select") {
                    if ($(this).attr('errmsg') != "" && $(this).attr('errmsg') != undefined) {
                        err_msg += "<p>" + $(this).attr('errmsg') + "</p>";
                    }
                    $(this).addClass('InputBorderRed');
                }


            });

            if ($('#DV_SH_FATCA #tblDetailList tbody tr').hasClass('empty_table') || $('#DV_SH_FATCA #tblDetailList tbody tr').length == 0) {
                err_msg += "<p>Second holder's FATCA details are required..!</p>";
                isError = true;
            }
        }

        //SH PEP Details
        if ($('input[name="rdoInvPEP"]:checked').val() == undefined)
            err_msg += "<p>Please provide PEP declaration..!</p>";

        if ($('input[name="rdoInvPEPRelated"]:checked').val() == undefined)
            err_msg += "<p>Please provide PEP relative declaration..!</p>";

    } catch (e) {
        fnException(e);
    }
    return err_msg;
}
//third holder save validations
const TH_Save_Validations = function () {
    let err_msg = '';
    try {
        $('.HOLD_DTL').removeClass('InputBorderRed');
        $('.MORE_DTL').removeClass('InputBorderRed');
        $('.D_T_E').parent().removeClass('InputBorderRed');

        let txtDOB = $('#DV_TH #txtDOB').val();
        let IsTHMinor = CheckIsMinor(txtDOB);
        let IsTHMarried = CheckIsMarried($('#DV_TH #ddlMaritalStatus').val());

        //title  
        if ($('#DV_TH #ddlTitle').val() == 'select' || $('#DV_TH #ddlTitle').val() == '' || $('#DV_TH #ddlTitle').val() == null) {
            err_msg += "<p>Third holder's name prefix is required..!</p>";
            $('#DV_TH #ddlTitle').addClass('InputBorderRed');
        }

        //name
        if ($.isEmptyObject($('#DV_TH #txtFName').val())) {
            err_msg += "<p>Third holder's name is required..!</p>";
            $('#DV_TH #txtFName').addClass('InputBorderRed');
        }

        //dob
        if ($.isEmptyObject(txtDOB)) {
            err_msg += "<p>Third holder's date of birth is required..!</p>";
            $('#txtInvDOB').addClass('InputBorderRed');
        }

        //pan
        if ($('#DV_TH #txtPAN').val() == '' && !IsTHMinor) {
            err_msg += "<p>Third holder's PAN is required..!</p>";
            $('#DV_TH #txtPAN').addClass('InputBorderRed');
        }

        //gender
        if ($('#DV_TH #ddlGender').val() == 'select') {
            err_msg += "<p>Third holder's gender is required..!</p>";
            $('#DV_TH #ddlGender').addClass('InputBorderRed');
        }

        //Guard pan 
        if ($.isEmptyObject($('#DV_TH #txtGuardianPAN').val()) && IsTHMinor) {
            err_msg += "<p>Third holder's guardian PAN is required..!</p>";
            $('#DV_TH #txtGuardianPAN').addClass('InputBorderRed');
        }

        //Guard title 
        if ($.isEmptyObject($('#DV_TH #ddlGuardianTitle').val()) && IsTHMinor) {
            err_msg += "<p>Third holder's guardian name prefix is required..!</p>";
            $('#DV_TH #ddlGuardianTitle').addClass('InputBorderRed');
        }

        //Guard name 
        if ($.isEmptyObject($('#DV_TH #txtGuardianFName').val()) && IsTHMinor) {
            err_msg += "<p>Third holder's guardian name is required..!</p>";
            $('#DV_TH #txtGuardianFName').addClass('InputBorderRed');
        }

        let $THFatherName = $('#DV_TH #txtFatherFName');
        let $THMotherName = $('#DV_TH #txtMotherFName');
        let $THSpouseName = $('#DV_TH #txtSpouseFName');
        //if ($THFatherName.val() == '' && $THMotherName.val() == '' && ($THSpouseName.val() == '' && IsTHMarried && !IsTHMinor)) {
        if ($THFatherName.val() == '' && $THMotherName.val() == '' && $THSpouseName.val() == '') {
            err_msg += "<p>Third holder's father/mother/spouse Name is required..!</p>";
        }
        //else if ($THFatherName.val() == '' && $THMotherName.val() == '') {
        //    err_msg += "<p>Third holder's father/mother name is required..!</p>";
        //}
        else {
            if ($THFatherName.val() != '' && $('#DV_TH #ddlFatherTitle').val() == 'select') {
                err_msg += "<p>Third holder's father name prefix is required..!</p>";
            }

            if ($THMotherName.val() != '' && $('#DV_TH #ddlMotherTitle').val() == 'select') {
                err_msg += "<p>Third holder's mother name prefix is required..!</p>";
            }

            if ($THSpouseName.val() != '' && $('#DV_TH #ddlSpouseTitle').val() == 'select') {
                err_msg += "<p>Third holder's spouse name prefix is required..!</p>";
            }
        }

        //marital status
        if ($('#DV_TH #ddlMaritalStatus').val() == 'select') {
            err_msg += "<p>Third holder's marital status is required..!</p>";
            $('#DV_TH #ddlMaritalStatus').addClass('InputBorderRed');
        }

        //Annual Income
        if ($('#DV_TH #ddlAnnualIncome').val() == 'select') {
            err_msg += "<p>Third holder's annual income is required..!</p>";
            $('#DV_TH #ddlAnnualIncome').addClass('InputBorderRed');
        }

        //occupation
        if ($('#DV_TH #ddlOccupation').val() == 'select') {
            err_msg += "<p>Third holder's occupation is required..!</p>";
            $('#DV_TH #ddlOccupation').addClass('InputBorderRed');
        }

        //Sub-Occupation avinash added Occupation/sub-occupation changes

        if ($('#DV_TH #ddlCustSegType').val() == "select" || $('#DV_TH #ddlCustSegType').val() == "" || $('#DV_TH #ddlCustSegType').val() == null) {
            err_msg += "<p>Third holder's Customer Segment Type is required..!</p>";
            $('#DV_TH #ddlCustSegType').addClass('InputBorderRed');
        }
        if ($('#DV_TH #ddlCustSegType').val() != 'select' && ($('#DV_TH #ddlCustSegSubType').val() == "select")) {
            err_msg += "<p>Third holder's Customer Segment SubType is required..!</p>";
            $('#DV_TH #ddlCustSegSubType').addClass('InputBorderRed');
        }

        //permanent address1
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtAdd1').val())) {
            err_msg += "<p>Third holder's permanent address is required..!</p>";
            $('#DV_TH_P_ADDR #txtAdd1').addClass('InputBorderRed');
        }

        //permanent country
        if ($('#DV_TH_P_ADDR #ddlCountry').val() == 'select') {
            err_msg += "<p>Third holder's permanent country is required..!</p>";
            $('#DV_TH_P_ADDR #ddlCountry').addClass('InputBorderRed');
        }

        //permanent pincode
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtPin').val())) {
            err_msg += "<p>Third holder's permanent pincode is required..!</p>";
            $('#DV_TH_P_ADDR #txtPin').addClass('InputBorderRed');
        }

        //permanent state
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtState').val())) {
            err_msg += "<p>Third holder's permanent state is required..!</p>";
            $('#DV_TH_P_ADDR #txtState').addClass('InputBorderRed');
        }

        //permanent district
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtDistrict').val())) {
            err_msg += "<p>Third holder's permanent district is required..!</p>";
            $('#DV_TH_P_ADDR #txtDistrict').addClass('InputBorderRed');
        }

        //permanent city
        if ($.isEmptyObject($('#DV_TH_P_ADDR #txtCity').val())) {
            err_msg += "<p>Third holder's permanent city is required..!</p>";
            $('#DV_TH_P_ADDR #txtCity').addClass('InputBorderRed');
        }

        //mailing address1
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtAdd1').val())) {
            err_msg += "<p>Third holder's mailing address is required..!</p>";
            $('#DV_TH_M_ADDR #txtAdd1').addClass('InputBorderRed');
        }

        //mailing country
        if ($('#DV_TH_M_ADDR #ddlCountry').val() == 'select') {
            err_msg += "<p>Third holder's mailing country is required..!</p>";
            $('#DV_TH_M_ADDR #ddlCountry').addClass('InputBorderRed');
        }

        //mailing pincode
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtPin').val())) {
            err_msg += "<p>Third holder's mailing pincode is required..!</p>";
            $('#DV_TH_M_ADDR #txtPin').addClass('InputBorderRed');
        }

        //mailing state
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtState').val())) {
            err_msg += "<p>Third holder's mailing state is required..!</p>";
            $('#DV_TH_M_ADDR #txtState').addClass('InputBorderRed');
        }

        //mailing district
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtDistrict').val())) {
            err_msg += "<p>Third holder's mailing district is required..!</p>";
            $('#DV_TH_M_ADDR #txtDistrict').addClass('InputBorderRed');
        }

        //mailing city
        if ($.isEmptyObject($('#DV_TH_M_ADDR #txtCity').val())) {
            err_msg += "<p>Third holder's mailing city is required..!</p>";
            $('#DV_TH_M_ADDR #txtCity').addClass('InputBorderRed');
        }

        //FATCA Details
        if ($('#btnTHsldFatca').hasClass('active') || $('#btnTHsldGreen').hasClass('active')) {
            $('#DV_TH_FATCA .requiredFatcaDtl').each(function () {
                if ($.isEmptyObject($(this).val()) || $(this).val() == "-1" || $(this).val().toString().toLowerCase() == "select") {
                    if ($(this).attr('errmsg') != "" && $(this).attr('errmsg') != undefined) {
                        err_msg += "<p>" + $(this).attr('errmsg') + "</p>";
                    }
                    $(this).addClass('InputBorderRed');
                }


            });

            if ($('#DV_TH_FATCA #tblDetailList tbody tr').hasClass('empty_table') || $('#DV_TH_FATCA #tblDetailList tbody tr').length == 0) {
                err_msg += "<p>Third holder's FATCA details are required..!</p>";
                isError = true;
            }
        }

    } catch (e) {
        fnException(e);
    }
    return err_msg;
}
const SHDOBChange = function () {
    try {
        let $SHDOB = $('#DV_SH #txtDOB');
        let SH_Age = GetAge($SHDOB.val());

        $('#DV_SH #txtPAN').prop('required', true);
        $('#DV_SH #ddlMaritalStatus option[value="01"]').prop('disabled', false);

        if (SH_Age < 18) {

            $('#DV_SH #ddlGuardianTitle').prop('required', true).prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtGuardianFName').prop('required', true).prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtGuardianMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtGuardianLName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #txtGuardianPAN').prop('required', true).prop('disabled', false).removeClass('DisabledControl');
            $('#DV_SH #ddlMaritalStatus option[value="01"]').prop('disabled', true);
            $('#DV_SH #txtPAN').prop('required', false);
            $('#DV_SH .GUARDIAN').show();
            $('#DV_SH #DV_PAN').hide();
            //$('#DV_SH .SPOUSE').hide();
        }
        else if ($('#DV_SH #ddlMaritalStatus').val() == '01') {
            $('#DV_SH #ddlGuardianTitle').prop('required', false);
            $('#DV_SH #txtGuardianFName').prop('required', false);
            $('#DV_SH #txtGuardianPAN').prop('required', false);

            $('#DV_SH #DV_PAN').show();
            $('#DV_SH .GUARDIAN').hide();
            $('#DV_SH .SPOUSE').show();
        }
        else {
            $('#DV_SH #ddlGuardianTitle').prop('required', false);
            $('#DV_SH #txtGuardianFName').prop('required', false);
            $('#DV_SH #txtGuardianPAN').prop('required', false);

            $('#DV_SH #DV_PAN').show();
            $('#DV_SH .GUARDIAN').hide();
            //$('#DV_SH .SPOUSE').hide();
        }

        if ($SHDOB.val() != "" && $SHDOB.val() != null)
            $SHDOB.parent().removeClass('InputBorderRed');
        else
            $SHDOB.parent().addClass('InputBorderRed');

    } catch (e) {
        fnException(e); return false;
    }
}
const THDOBChange = function () {
    try {

        let $THDOB = $('#DV_TH #txtDOB');
        let TH_Age = GetAge($THDOB.val());

        $('#DV_TH #txtPAN').prop('required', true);
        $('#DV_TH #ddlMaritalStatus option[value="01"]').prop('disabled', false);

        if (TH_Age < 18) {
            $('#DV_TH #ddlGuardianTitle').prop('required', true).prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtGuardianFName').prop('required', true).prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtGuardianMName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #txtGuardianLName').prop('disabled', false).removeClass('DisabledControl');
            $('#DV_TH #ddlMaritalStatus option[value="01"]').prop('disabled', true);
            $('#DV_TH #txtPAN').prop('required', false);
            $('#DV_TH .GUARDIAN').show();
            $('#DV_TH #DV_PAN').hide();
            //$('#DV_TH .SPOUSE').hide();
        }
        else if ($('#DV_TH #ddlMaritalStatus').val() == '01') {
            $('#DV_TH #ddlGuardianTitle').prop('required', false);
            $('#DV_TH #txtGuardianFName').prop('required', false);
            $('#DV_TH #txtGuardianPAN').prop('required', false);

            $('#DV_TH #DV_PAN').show();
            $('#DV_TH .GUARDIAN').hide();
            $('#DV_TH .SPOUSE').show();
        }
        else {
            $('#DV_TH #ddlGuardianTitle').prop('required', false);
            $('#DV_TH #txtGuardianFName').prop('required', false);
            $('#DV_TH #txtGuardianPAN').prop('required', false);

            $('#DV_TH #DV_PAN').show();
            $('#DV_TH .GUARDIAN').hide();
            //$('#DV_TH .SPOUSE').hide();
        }

        if ($THDOB.val() != "" && $THDOB.val() != null)
            $THDOB.parent().removeClass('InputBorderRed');
        else
            $THDOB.parent().addClass('InputBorderRed');
    } catch (e) {
        fnException(e); return false;
    }
}
const Reset_step5 = function () {
    if ($('#ddlHolderType').val() == '01') {

    }
    else if ($('#ddlHolderType').val() == '02') {
        BTP_OBJECT.mode = 'R';
        SHReset();
        BTP_OBJECT.mode = 'A';
    }
    else if ($('#ddlHolderType').val() == '03') {
        BTP_OBJECT.mode = 'R';
        THReset();
        BTP_OBJECT.mode = 'A';
    }
}
//second holder dob
$('#DV_SH #txtDOB').datetextentry({
    min_year: '1915',
    max_date: function () { return this.get_today(); },
    max_date_message: 'Date cannot be future date',
    on_blur: SHDOBChange
});
//third holder dob
$('#DV_TH #txtDOB').datetextentry({
    min_year: '1915',
    max_date: function () { return this.get_today(); },
    max_date_message: 'Date cannot be future date',
    on_blur: THDOBChange
});
//holder type dropdown
$('#ddlHolderType').change(function () {
    try {
        $('#btnCancel05').show();
        if (this.value == '01') {
            $('#btnCancel05').hide();
            $('#DV_SH').slideUp();
            $('#DV_SH_HEAD').slideUp();
            $('#DV_TH').slideUp();
            $('#DV_TH_HEAD').slideUp();
            $('#DV_FH').slideDown();
        }
        else if (this.value == '02') {
            if (BTP_OBJECT.FHDetailsSave) {
                BindProvSH();
                $('#DV_FH').slideUp();
                $('#DV_TH').slideUp();
                $('#DV_TH_HEAD').slideUp();
                $('#DV_SH').slideDown();
                if (!$.isEmptyObject($('#hdrSHFolioNo').text()))
                    $('#DV_SH_HEAD').slideDown();
            }
            else {
                $('#ddlHolderType').val('01').change();
                BtpMessagePopup('Please save first holder details', 'error');
            }
        }
        else if (this.value == '03') {
            if (BTP_OBJECT.SHDetailsSave) {
                BindProvTH();
                $('#DV_FH').slideUp();
                $('#DV_SH').slideUp();
                $('#DV_SH_HEAD').slideUp();
                $('#DV_TH').slideDown();
                if (!$.isEmptyObject($('#hdrTHFolioNo').text()))
                    $('#DV_TH_HEAD').slideDown();
            }
            else {
                $('#ddlHolderType').val('02').change();
                BtpMessagePopup('Please save second holder details', 'error');
            }
        }

    } catch (e) {
        fnException(e);
    }
});
//add new second holder 
$('#btnAddNewSH').click(function () {
    $('#DV_PROV_SH').hide();
    $('#DV_SH_SEARCH').hide();
    $('#DV_SH_CKYC_SEARCH').show();
    $('#DV_SH_DTLS').hide();
});
//add new third holder 
$('#btnAddNewTH').click(function () {
    $('#DV_PROV_TH').hide();
    $('#DV_TH_SEARCH').hide();
    $('#DV_TH_CKYC_SEARCH').show();
    $('#DV_TH_DTLS').hide();
});
//$('#DV_FH #ddlMaritalStatus').change(function ()
//{
//    if (this.value == '01')
//        $('#DV_FH .SPOUSE').slideDown();
//    else
//        $('#DV_FH .SPOUSE').slideUp();
//});

//$('#DV_SH #ddlMaritalStatus').change(function ()
//{
//    if (this.value == '01')
//        $('#DV_SH .SPOUSE').show();
//    else
//        $('#DV_SH .SPOUSE').hide();
//});

//$('#DV_TH #ddlMaritalStatus').change(function ()
//{
//    if (this.value == '01')
//        $('#DV_TH .SPOUSE').show();
//    else
//        $('#DV_TH .SPOUSE').hide();
//});
$('#DV_SH #txtPAN')
    .keyup(function () {
        $(this).next().text('').removeClass('successBox').hide();

        if (!$.isEmptyObject(this.value) && !IsValidPAN(this.value))
            $(this).next().text('PAN is not valid').show();
    })
    .change(function () {
        if (!$.isEmptyObject(this.value) && IsValidPAN(this.value) && BTP_OBJECT.SH_DATA_SOURCE == 'CKYC') {
            let objReqBO = {};
            objReqBO.Source_Type = "CPTP_UNI";
            objReqBO.Holder_Type = '02';
            objReqBO.User_Name = $('#DV_SH #txtFName').val().trim() + ' ' + $('#DV_SH #txtMName').val().trim() + ' ' + $('#DV_SH #txtLName').val().trim();
            objReqBO.Remarks = "CPTP_UNI";
            objReqBO.PAN_Holder_Name = $('#DV_SH #txtFName').val().trim() + ' ' + $('#DV_SH #txtMName').val().trim() + ' ' + $('#DV_SH #txtLName').val().trim();
            objReqBO.PAN_Holder_DOB = $('#DV_SH #txtDOB').val().trim();
            objReqBO.PAN_No = $(this).val();


            ExtendedAjaxCall('PAN_Verification', objReqBO, 'POST', function (result) {
                if (!$.isEmptyObject(result) && result.PAN_DOB_Match_Status == '1') {
                    //$('#DV_SH #txtPAN').next().addClass('successBox').text('PAN verified successfully.').fadeIn('slow').delay(5000).hide(1);
                }
                else {
                    $('#Model_SH_PAN_VERIFICATION_Msg').modal('show');
                }

                $('#preloader').hide();

            }, null, true, true, false);
        }
    });
$('#DV_TH #txtPAN')
    .keyup(function () {
        $(this).next().text('').removeClass('successBox').hide();
        if (!$.isEmptyObject(this.value) && !IsValidPAN(this.value))
            $(this).next().text('PAN is not valid').show();
    })
    .change(function () {
        if (!$.isEmptyObject(this.value) && IsValidPAN(this.value) && BTP_OBJECT.SH_DATA_SOURCE == 'CKYC') {
            let objReqBO = {};
            objReqBO.Source_Type = "CPTP_UNI";
            objReqBO.Holder_Type = '03';
            objReqBO.User_Name = $('#DV_TH #txtFName').val().trim() + ' ' + $('#DV_TH #txtMName').val().trim() + ' ' + $('#DV_TH #txtLName').val().trim();
            objReqBO.Remarks = "CPTP_UNI";
            objReqBO.PAN_Holder_Name = $('#DV_TH #txtFName').val().trim() + ' ' + $('#DV_TH #txtMName').val().trim() + ' ' + $('#DV_TH #txtLName').val().trim();
            objReqBO.PAN_Holder_DOB = $('#DV_TH #txtDOB').val().trim();
            objReqBO.PAN_No = $(this).val();


            ExtendedAjaxCall('PAN_Verification', objReqBO, 'POST', function (result) {
                if (!$.isEmptyObject(result) && result.PAN_DOB_Match_Status == '1') {
                    //$('#DV_SH #txtPAN').next().addClass('successBox').text('PAN verified successfully.').fadeIn('slow').delay(5000).hide(1);
                }
                else {
                    $('#Model_TH_PAN_VERIFICATION_Msg').modal('show');
                }

                $('#preloader').hide();

            }, null, true, true, false);
        }
    });
//FH MAIL addr same as FH PER
$('#chkIsFHAddrSameAsPermanent').change(function () {
    if ($(this).prop('checked')) {
        $('#DV_FH_M_ADDR #txtAdd1').val($('#DV_FH_P_ADDR #txtAdd1').val());
        $('#DV_FH_M_ADDR #txtAdd2').val($('#DV_FH_P_ADDR #txtAdd2').val());
        $('#DV_FH_M_ADDR #txtAdd3').val($('#DV_FH_P_ADDR #txtAdd3').val());
        $('#DV_FH_M_ADDR #txtCity').val($('#DV_FH_P_ADDR #txtCity').val());
        $('#DV_FH_M_ADDR #ddlCountry').val($('#DV_FH_P_ADDR #ddlCountry').val()).change();

        if ($('#DV_FH_M_ADDR #ddlCountry').val() == 'IN') {
            $('#DV_FH_M_ADDR #txtPin').val($('#DV_FH_P_ADDR #txtPin').val()).keyup();
        }
        else {
            $('#DV_FH_M_ADDR #txtState').val($('#DV_FH_P_ADDR #txtState').val());
            $('#DV_FH_M_ADDR #txtDistrict').val($('#DV_FH_P_ADDR #txtDistrict').val());
            $('#DV_FH_M_ADDR #txtPin').val($('#DV_FH_P_ADDR #txtPin').val());
        }
    }
    else {
        if (BTP_OBJECT.mode == 'A') {
            if (confirm('Are you sure you want to clear Mailing Address..?')) {
                $('#DV_FH_M_ADDR #txtAdd1').val('');
                $('#DV_FH_M_ADDR #txtAdd2').val('');
                $('#DV_FH_M_ADDR #txtAdd3').val('');
                $('#DV_FH_M_ADDR #txtCity').val('');
                $('#DV_FH_M_ADDR #txtState').val('');
                $('#DV_FH_M_ADDR #txtDistrict').val('');
                $('#DV_FH_M_ADDR #txtPin').val('');

                $('#DV_FH_M_ADDR #ddlCountry').val('IN').change();
            }
            else
                $(this).prop('checked', true);
        }
        else {
            $('#DV_FH_M_ADDR #txtAdd1').val('');
            $('#DV_FH_M_ADDR #txtAdd2').val('');
            $('#DV_FH_M_ADDR #txtAdd3').val('');
            $('#DV_FH_M_ADDR #txtCity').val('');
            $('#DV_FH_M_ADDR #txtState').val('');
            $('#DV_FH_M_ADDR #txtDistrict').val('');
            $('#DV_FH_M_ADDR #txtPin').val('');

            $('#DV_FH_M_ADDR #ddlCountry').val('IN').change();
        }
    }
});
//SH MAIL addr same as SH PER
$('#chkIsSHAddrSameAsPermanent').change(function () {
    if ($(this).prop('checked')) {
        $('#DV_SH_M_ADDR #txtAdd1').val($('#DV_SH_P_ADDR #txtAdd1').val());
        $('#DV_SH_M_ADDR #txtAdd2').val($('#DV_SH_P_ADDR #txtAdd2').val());
        $('#DV_SH_M_ADDR #txtAdd3').val($('#DV_SH_P_ADDR #txtAdd3').val());
        $('#DV_SH_M_ADDR #txtCity').val($('#DV_SH_P_ADDR #txtCity').val());
        $('#DV_SH_M_ADDR #ddlCountry').val($('#DV_SH_P_ADDR #ddlCountry').val()).change();

        if ($('#DV_SH_M_ADDR #ddlCountry').val() == 'IN')
            $('#DV_SH_M_ADDR #txtPin').val($('#DV_SH_P_ADDR #txtPin').val()).keyup();
        else {
            $('#DV_SH_M_ADDR #txtState').val($('#DV_SH_P_ADDR #txtState').val());
            $('#DV_SH_M_ADDR #txtDistrict').val($('#DV_SH_P_ADDR #txtDistrict').val());
            $('#DV_SH_M_ADDR #txtPin').val($('#DV_SH_P_ADDR #txtPin').val());
        }
    }
    else {
        if (BTP_OBJECT.mode == 'A') {
            if (confirm('Are you sure you want to clear Mailing Address..?')) {
                $('#DV_SH_M_ADDR #txtAdd1').val('');
                $('#DV_SH_M_ADDR #txtAdd2').val('');
                $('#DV_SH_M_ADDR #txtAdd3').val('');
                $('#DV_SH_M_ADDR #txtCity').val('');
                $('#DV_SH_M_ADDR #txtState').val('');
                $('#DV_SH_M_ADDR #txtDistrict').val('');
                $('#DV_SH_M_ADDR #txtPin').val('');

                $('#DV_SH_M_ADDR #ddlCountry').val('IN').change();
            }
            else
                $(this).prop('checked', true);
        }
        else {
            $('#DV_SH_M_ADDR #txtAdd1').val('');
            $('#DV_SH_M_ADDR #txtAdd2').val('');
            $('#DV_SH_M_ADDR #txtAdd3').val('');
            $('#DV_SH_M_ADDR #txtCity').val('');
            $('#DV_SH_M_ADDR #txtState').val('');
            $('#DV_SH_M_ADDR #txtDistrict').val('');
            $('#DV_SH_M_ADDR #txtPin').val('');

            $('#DV_SH_M_ADDR #ddlCountry').val('IN').change();
        }
    }
});
//TH MAIL addr same as TH PER
$('#chkIsTHAddrSameAsPermanent').change(function () {
    if ($(this).prop('checked')) {
        $('#DV_TH_M_ADDR #txtAdd1').val($('#DV_TH_P_ADDR #txtAdd1').val());
        $('#DV_TH_M_ADDR #txtAdd2').val($('#DV_TH_P_ADDR #txtAdd2').val());
        $('#DV_TH_M_ADDR #txtAdd3').val($('#DV_TH_P_ADDR #txtAdd3').val());
        $('#DV_TH_M_ADDR #txtCity').val($('#DV_TH_P_ADDR #txtCity').val());
        $('#DV_TH_M_ADDR #ddlCountry').val($('#DV_TH_P_ADDR #ddlCountry').val()).change();

        if ($('#DV_TH_M_ADDR #ddlCountry').val() == 'IN')
            $('#DV_TH_M_ADDR #txtPin').val($('#DV_TH_P_ADDR #txtPin').val()).keyup();
        else {
            $('#DV_TH_M_ADDR #txtState').val($('#DV_TH_P_ADDR #txtState').val());
            $('#DV_TH_M_ADDR #txtDistrict').val($('#DV_TH_P_ADDR #txtDistrict').val());
            $('#DV_TH_M_ADDR #txtPin').val($('#DV_TH_P_ADDR #txtPin').val());
        }
    }
    else {
        if (BTP_OBJECT.mode == 'A') {
            if (confirm('Are you sure you want to clear Mailing Address..?')) {
                $('#DV_TH_M_ADDR #txtAdd1').val('');
                $('#DV_TH_M_ADDR #txtAdd2').val('');
                $('#DV_TH_M_ADDR #txtAdd3').val('');
                $('#DV_TH_M_ADDR #txtCity').val('');
                $('#DV_TH_M_ADDR #txtState').val('');
                $('#DV_TH_M_ADDR #txtDistrict').val('');
                $('#DV_TH_M_ADDR #txtPin').val('');

                $('#DV_TH_M_ADDR #ddlCountry').val('IN').change();
            }
            else
                $(this).prop('checked', true);
        }
        else {
            $('#DV_TH_M_ADDR #txtAdd1').val('');
            $('#DV_TH_M_ADDR #txtAdd2').val('');
            $('#DV_TH_M_ADDR #txtAdd3').val('');
            $('#DV_TH_M_ADDR #txtCity').val('');
            $('#DV_TH_M_ADDR #txtState').val('');
            $('#DV_TH_M_ADDR #txtDistrict').val('');
            $('#DV_TH_M_ADDR #txtPin').val('');

            $('#DV_TH_M_ADDR #ddlCountry').val('IN').change();
        }
    }
});
//SH PER/MAIL addr same as FH PER/MAIL addr
$('#chkIsSHAddrSameAsFH').change(function () {
    if ($(this).prop('checked')) {
        $('#DV_SH_P_ADDR #txtAdd1').val($('#DV_FH_P_ADDR #txtAdd1').val());
        $('#DV_SH_P_ADDR #txtAdd2').val($('#DV_FH_P_ADDR #txtAdd2').val());
        $('#DV_SH_P_ADDR #txtAdd3').val($('#DV_FH_P_ADDR #txtAdd3').val());
        $('#DV_SH_P_ADDR #txtCity').val($('#DV_FH_P_ADDR #txtCity').val());
        $('#DV_SH_P_ADDR #ddlCountry').val($('#DV_FH_P_ADDR #ddlCountry').val()).change();
        if ($('#DV_SH_P_ADDR #ddlCountry').val() == 'IN')
            $('#DV_SH_P_ADDR #txtPin').val($('#DV_FH_P_ADDR #txtPin').val()).keyup();
        else {
            $('#DV_SH_P_ADDR #txtState').val($('#DV_FH_P_ADDR #txtState').val());
            $('#DV_SH_P_ADDR #txtDistrict').val($('#DV_FH_P_ADDR #txtDistrict').val());
            $('#DV_SH_P_ADDR #txtPin').val($('#DV_FH_P_ADDR #txtPin').val());
        }


        $('#DV_SH_M_ADDR #txtAdd1').val($('#DV_FH_M_ADDR #txtAdd1').val());
        $('#DV_SH_M_ADDR #txtAdd2').val($('#DV_FH_M_ADDR #txtAdd2').val());
        $('#DV_SH_M_ADDR #txtAdd3').val($('#DV_FH_M_ADDR #txtAdd3').val());
        $('#DV_SH_M_ADDR #txtCity').val($('#DV_FH_M_ADDR #txtCity').val());
        $('#DV_SH_M_ADDR #ddlCountry').val($('#DV_FH_M_ADDR #ddlCountry').val()).change();
        if ($('#DV_SH_M_ADDR #ddlCountry').val() == 'IN') {
            $('#DV_SH_M_ADDR #txtPin').val($('#DV_FH_M_ADDR #txtPin').val()).keyup();
        }
        else {
            $('#DV_SH_M_ADDR #txtState').val($('#DV_FH_M_ADDR #txtState').val());
            $('#DV_SH_M_ADDR #txtDistrict').val($('#DV_FH_M_ADDR #txtDistrict').val());
            $('#DV_SH_M_ADDR #txtPin').val($('#DV_FH_M_ADDR #txtPin').val());
        }

    }
    else {
        if (BTP_OBJECT.mode == 'A') {
            if (confirm('Are you sure you want to clear address..?')) {
                $('#DV_SH_P_ADDR #txtAdd1').val('');
                $('#DV_SH_P_ADDR #txtAdd2').val('');
                $('#DV_SH_P_ADDR #txtAdd3').val('');
                $('#DV_SH_P_ADDR #txtCity').val('');
                $('#DV_SH_P_ADDR #txtState').val('');
                $('#DV_SH_P_ADDR #txtDistrict').val('');
                $('#DV_SH_P_ADDR #txtPin').val('');
                $('#DV_SH_P_ADDR #ddlCountry').val('IN').change();

                $('#DV_SH_M_ADDR #txtAdd1').val('');
                $('#DV_SH_M_ADDR #txtAdd2').val('');
                $('#DV_SH_M_ADDR #txtAdd3').val('');
                $('#DV_SH_M_ADDR #txtCity').val('');
                $('#DV_SH_M_ADDR #txtState').val('');
                $('#DV_SH_M_ADDR #txtDistrict').val('');
                $('#DV_SH_M_ADDR #txtPin').val('');
                $('#DV_SH_M_ADDR #ddlCountry').val('IN').change();
            }
            else
                $(this).prop('checked', true);
        }
        else {
            $('#DV_SH_P_ADDR #txtAdd1').val('');
            $('#DV_SH_P_ADDR #txtAdd2').val('');
            $('#DV_SH_P_ADDR #txtAdd3').val('');
            $('#DV_SH_P_ADDR #txtCity').val('');
            $('#DV_SH_P_ADDR #txtState').val('');
            $('#DV_SH_P_ADDR #txtDistrict').val('');
            $('#DV_SH_P_ADDR #txtPin').val('');
            $('#DV_SH_P_ADDR #ddlCountry').val('IN').change();

            $('#DV_SH_M_ADDR #txtAdd1').val('');
            $('#DV_SH_M_ADDR #txtAdd2').val('');
            $('#DV_SH_M_ADDR #txtAdd3').val('');
            $('#DV_SH_M_ADDR #txtCity').val('');
            $('#DV_SH_M_ADDR #txtState').val('');
            $('#DV_SH_M_ADDR #txtDistrict').val('');
            $('#DV_SH_M_ADDR #txtPin').val('');
            $('#DV_SH_M_ADDR #ddlCountry').val('IN').change();
        }
    }
});
//TH PER/MAIL addr same as FH PER/MAIL addr
$('#chkIsTHAddrSameAsFH').change(function () {
    if ($(this).prop('checked')) {
        $('#DV_TH_P_ADDR #txtAdd1').val($('#DV_FH_P_ADDR #txtAdd1').val());
        $('#DV_TH_P_ADDR #txtAdd2').val($('#DV_FH_P_ADDR #txtAdd2').val());
        $('#DV_TH_P_ADDR #txtAdd3').val($('#DV_FH_P_ADDR #txtAdd3').val());
        $('#DV_TH_P_ADDR #txtCity').val($('#DV_FH_P_ADDR #txtCity').val());
        $('#DV_TH_P_ADDR #ddlCountry').val($('#DV_FH_P_ADDR #ddlCountry').val()).change();
        if ($('#DV_TH_P_ADDR #ddlCountry').val() == 'IN')
            $('#DV_TH_P_ADDR #txtPin').val($('#DV_FH_P_ADDR #txtPin').val()).keyup();
        else {
            $('#DV_TH_P_ADDR #txtState').val($('#DV_FH_P_ADDR #txtState').val());
            $('#DV_TH_P_ADDR #txtDistrict').val($('#DV_FH_P_ADDR #txtDistrict').val());
            $('#DV_TH_P_ADDR #txtPin').val($('#DV_FH_P_ADDR #txtPin').val());
        }


        $('#DV_TH_M_ADDR #txtAdd1').val($('#DV_FH_M_ADDR #txtAdd1').val());
        $('#DV_TH_M_ADDR #txtAdd2').val($('#DV_FH_M_ADDR #txtAdd2').val());
        $('#DV_TH_M_ADDR #txtAdd3').val($('#DV_FH_M_ADDR #txtAdd3').val());
        $('#DV_TH_M_ADDR #txtCity').val($('#DV_FH_M_ADDR #txtCity').val());
        $('#DV_TH_M_ADDR #ddlCountry').val($('#DV_FH_M_ADDR #ddlCountry').val()).change();
        if ($('#DV_TH_M_ADDR #ddlCountry').val() == 'IN')
            $('#DV_TH_M_ADDR #txtPin').val($('#DV_FH_M_ADDR #txtPin').val()).keyup();
        else {
            $('#DV_TH_M_ADDR #txtState').val($('#DV_FH_M_ADDR #txtState').val());
            $('#DV_TH_M_ADDR #txtDistrict').val($('#DV_FH_M_ADDR #txtDistrict').val());
            $('#DV_TH_M_ADDR #txtPin').val($('#DV_FH_M_ADDR #txtPin').val());
        }

    }
    else {
        if (BTP_OBJECT.mode == 'A') {
            if (confirm('Are you sure you want to clear address..?')) {
                $('#DV_TH_P_ADDR #txtAdd1').val('');
                $('#DV_TH_P_ADDR #txtAdd2').val('');
                $('#DV_TH_P_ADDR #txtAdd3').val('');
                $('#DV_TH_P_ADDR #txtCity').val('');
                $('#DV_TH_P_ADDR #txtState').val('');
                $('#DV_TH_P_ADDR #txtDistrict').val('');
                $('#DV_TH_P_ADDR #txtPin').val('');
                $('#DV_TH_P_ADDR #ddlCountry').val('IN').change();
                $('#DV_TH_M_ADDR #txtAdd1').val('');
                $('#DV_TH_M_ADDR #txtAdd2').val('');
                $('#DV_TH_M_ADDR #txtAdd3').val('');
                $('#DV_TH_M_ADDR #txtCity').val('');
                $('#DV_TH_M_ADDR #txtState').val('');
                $('#DV_TH_M_ADDR #txtDistrict').val('');
                $('#DV_TH_M_ADDR #txtPin').val('');
                $('#DV_TH_M_ADDR #ddlCountry').val('IN').change();
            }
            else
                $(this).prop('checked', true);
        }
        else {
            $('#DV_TH_P_ADDR #txtAdd1').val('');
            $('#DV_TH_P_ADDR #txtAdd2').val('');
            $('#DV_TH_P_ADDR #txtAdd3').val('');
            $('#DV_TH_P_ADDR #txtCity').val('');
            $('#DV_TH_P_ADDR #txtState').val('');
            $('#DV_TH_P_ADDR #txtDistrict').val('');
            $('#DV_TH_P_ADDR #txtPin').val('');
            $('#DV_TH_P_ADDR #ddlCountry').val('IN').change();
            $('#DV_TH_M_ADDR #txtAdd1').val('');
            $('#DV_TH_M_ADDR #txtAdd2').val('');
            $('#DV_TH_M_ADDR #txtAdd3').val('');
            $('#DV_TH_M_ADDR #txtCity').val('');
            $('#DV_TH_M_ADDR #txtState').val('');
            $('#DV_TH_M_ADDR #txtDistrict').val('');
            $('#DV_TH_M_ADDR #txtPin').val('');
            $('#DV_TH_M_ADDR #ddlCountry').val('IN').change();
        }
    }
});
$('#chkIdOverSeasAddress').change(function () {
    if ($(this).prop('checked'))
        $('#DV_FH_O_ADDR').slideDown();
    else
        $('#DV_FH_O_ADDR').slideUp();
});
//Investor other than india selection
$('#DV_FH_P_ADDR #ddlCountry').change(function () {
    if ($(this).val() == 'IN') {
        $('#DV_FH_P_ADDR #txtState').prop('disabled', true);
        $('#DV_FH_P_ADDR #txtDistrict').prop('disabled', true);
    }
    else {
        $('#DV_FH_P_ADDR #txtState').prop('disabled', false);
        $('#DV_FH_P_ADDR #txtDistrict').prop('disabled', false);
    }
});
//Investor same as above other than india selection
$('#DV_FH_M_ADDR #ddlCountry').change(function () {
    if ($(this).val() == 'IN') {
        $('#DV_FH_P_ADDR #txtState').prop('disabled', true);
        $('#DV_FH_P_ADDR #txtDistrict').prop('disabled', true);
    }
    else {
        $('#DV_FH_P_ADDR #txtState').prop('disabled', false);
        $('#DV_FH_P_ADDR #txtDistrict').prop('disabled', false);
    }
});
//Nominee other than india selection
$('#DV_NOM #ddlNomPermanent_Country').change(function () {
    if (ApplicationType == 'F') {
        if ($('#ddlNomPermanent_Country').val() == 'IN') {
            $('#ddlNomPermanent_State,#ddlNomPermanent_District,#ddlNomPermanent_Pin').prop('required', true).show();
            $('#State,#District,#txtNomPin').prop('required', false).hide();
        }
        else {
            $('#ddlNomPermanent_State,#ddlNomPermanent_District,#ddlNomPermanent_Pin').prop('required', false).hide();
            $('#State,#District,#txtNomPin').prop('required', true).show();
        }
    }
    else if ($('#chkSHEdit').prop('checked')) {
        if ($('#ddlNomPermanent_Country').val() == 'IN') {
            $('#ddlNomPermanent_State,#ddlNomPermanent_District,#ddlNomPermanent_Pin').prop('required', true).show();
            $('#State,#District,#txtNomPin').prop('required', false).hide();
        }
        else {
            $('#ddlNomPermanent_State,#ddlNomPermanent_District,#ddlNomPermanent_Pin').prop('required', false).hide();
            $('#State,#District,#txtNomPin').prop('required', true).show();
        }
    }
    else if (ApplicationType == 'A') {
        if ($('#ddlNomPermanent_Country').val() == 'IN') {
            $('#ddlNomPermanent_State,#ddlNomPermanent_District,#ddlNomPermanent_Pin').show();
            $('#State,#District,#txtNomPin').hide();
        }
        else {
            $('#ddlNomPermanent_State,#ddlNomPermanent_District,#ddlNomPermanent_Pin').hide();
            $('#State,#District,#txtNomPin').show();
        }
    }
});
//Second Holder Details other than india selection
$('#DV_SH_P_ADDR #ddlCountry').change(function () {
    if ($(this).val() == 'IN') {
        $('#DV_SH_P_ADDR #txtState').prop('disabled', true);
        $('#DV_SH_P_ADDR #txtDistrict').prop('disabled', true);
    }
    else {
        $('#DV_SH_P_ADDR #txtState').prop('disabled', false);
        $('#DV_SH_P_ADDR #txtDistrict').prop('disabled', false);
    }
});
//Second Holder same as Details other than india selection
$('#DV_SH_M_ADDR #ddlCountry').change(function () {
    if ($(this).val() == 'IN') {
        $('#DV_SH_M_ADDR #txtState').prop('disabled', true);
        $('#DV_SH_M_ADDR #txtDistrict').prop('disabled', true);
    }
    else {
        $('#DV_SH_M_ADDR #txtState').prop('disabled', false);
        $('#DV_SH_M_ADDR #txtDistrict').prop('disabled', false);
    }
});
//Third Holder Details other than india selection
$('#DV_TH_P_ADDR #ddlCountry').change(function () {
    if ($(this).val() == 'IN') {
        $('#DV_TH_P_ADDR #txtState').prop('disabled', true);
        $('#DV_TH_P_ADDR #txtDistrict').prop('disabled', true);
    }
    else {
        $('#DV_TH_P_ADDR #txtState').prop('disabled', false);
        $('#DV_TH_P_ADDR #txtDistrict').prop('disabled', false);
    }
});
//Third Holder same  as Details other than india selection
$('#DV_TH_M_ADDR #ddlCountry').change(function () {
    if ($(this).val() == 'IN') {
        $('#DV_TH_M_ADDR #txtState').prop('disabled', true);
        $('#DV_TH_M_ADDR #txtDistrict').prop('disabled', true);
    }
    else {
        $('#DV_TH_M_ADDR #txtState').prop('disabled', false);
        $('#DV_TH_M_ADDR #txtDistrict').prop('disabled', false);
    }
});
$('#DV_FH_P_ADDR #txtPin').keyup(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value)) {
        if (this.value.length >= 6 && $('#DV_FH_P_ADDR #ddlCountry').val() == 'IN') {
            ExtendedAjaxCall('DataEntry/SearchPincode/' + this.value, null, 'GET', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.length > 0) {
                        $('#DV_FH_P_ADDR #txtState').val(result[0].State).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_FH_P_ADDR #txtDistrict').val(result[0].District).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_FH_P_ADDR #txtCity').val(result[0].District);
                    }
                    else
                        $('#DV_FH_P_ADDR #txtPin').next().text('Please enter valid Pincode').show();
                } catch (e) {
                    fnException(e);
                }
                $('#preloader').hide();

            }, null, true, false, false, ErrorFunction);
        }
        else
            $(this).next().text('Please enter valid Pincode').show();
    }
    else if ($('#DV_FH_P_ADDR #ddlCountry').val() == 'IN') {
        $('#DV_FH_P_ADDR #txtState').val('');
        $('#DV_FH_P_ADDR #txtDistrict').val('');
    }
});
$('#DV_FH_M_ADDR #txtPin').keyup(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value)) {
        if (this.value.length >= 6 && $('#DV_FH_M_ADDR #ddlCountry').val() == 'IN') {
            ExtendedAjaxCall('DataEntry/SearchPincode/' + this.value, null, 'GET', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.length > 0) {
                        $('#DV_FH_M_ADDR #txtState').val(result[0].State).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_FH_M_ADDR #txtDistrict').val(result[0].District).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_FH_M_ADDR #txtCity').val(result[0].District);
                    }
                    else {
                        $('#DV_FH_M_ADDR #txtPin').next().text('Please enter valid Pincode').show();
                    }
                } catch (e) {
                    fnException(e);
                }
                $('#preloader').hide();

            }, null, true, false, false, ErrorFunction);
        }
        else {
            $(this).next().text('Please enter valid Pincode').show();
        }
    }
    else if ($('#DV_FH_M_ADDR #ddlCountry').val() == 'IN') {
        $('#DV_FH_M_ADDR #txtState').val('');
        $('#DV_FH_M_ADDR #txtDistrict').val('');
    }
});
$('#DV_SH_P_ADDR #txtPin').keyup(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value)) {
        if (this.value.length >= 6 && $('#DV_SH_P_ADDR #ddlCountry').val() == 'IN') {
            ExtendedAjaxCall('DataEntry/SearchPincode/' + this.value, null, 'GET', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.length > 0) {
                        $('#DV_SH_P_ADDR #txtState').val(result[0].State).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_SH_P_ADDR #txtDistrict').val(result[0].District).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_SH_P_ADDR #txtCity').val(result[0].District).removeClass('InputBorderRed');
                    }
                    else {
                        $('#DV_SH_P_ADDR #txtPin').next().text('Please enter valid Pincode').show();
                    }
                } catch (e) {
                    fnException(e);
                }
                $('#preloader').hide();

            }, null, true, false, false, ErrorFunction);
        }
        else {
            $(this).next().text('Please enter valid Pincode').show();
        }
    }
    else if ($('#DV_SH_P_ADDR #ddlCountry').val() == 'IN') {
        $('#DV_SH_P_ADDR #txtState').val('');
        $('#DV_SH_P_ADDR #txtDistrict').val('');
    }
});
$('#DV_SH_M_ADDR #txtPin').keyup(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value)) {
        if (this.value.length >= 6 && $('#DV_SH_M_ADDR #ddlCountry').val() == 'IN') {
            ExtendedAjaxCall('DataEntry/SearchPincode/' + this.value, null, 'GET', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.length > 0) {
                        $('#DV_SH_M_ADDR #txtState').val(result[0].State).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_SH_M_ADDR #txtDistrict').val(result[0].District).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_SH_M_ADDR #txtCity').val(result[0].District).removeClass('InputBorderRed');
                    }
                    else {
                        $('#DV_SH_M_ADDR #txtPin').next().text('Please enter valid Pincode').show();
                    }
                } catch (e) {
                    fnException(e);
                }
                $('#preloader').hide();

            }, null, true, false, false, ErrorFunction);
        }
        else {
            $(this).next().text('Please enter valid Pincode').show();
        }
    }
    else if ($('#DV_SH_M_ADDR #ddlCountry').val() == 'IN') {
        $('#DV_SH_M_ADDR #txtState').val('');
        $('#DV_SH_M_ADDR #txtDistrict').val('');
    }
});
$('#DV_TH_P_ADDR #txtPin').keyup(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value)) {
        if (this.value.length >= 6 && $('#DV_TH_P_ADDR #ddlCountry').val() == 'IN') {
            ExtendedAjaxCall('DataEntry/SearchPincode/' + this.value, null, 'GET', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.length > 0) {
                        $('#DV_TH_P_ADDR #txtState').val(result[0].State).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_TH_P_ADDR #txtDistrict').val(result[0].District).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_TH_P_ADDR #txtCity').val(result[0].District).removeClass('InputBorderRed');
                    }
                    else {
                        $('#DV_TH_P_ADDR #txtPin').next().text('Please enter valid Pincode').show();
                    }
                } catch (e) {
                    fnException(e);
                }
                $('#preloader').hide();

            }, null, true, false, false, ErrorFunction);
        }
        else {
            $(this).next().text('Please enter valid Pincode').show();
        }
    }
    else if ($('#DV_TH_P_ADDR #ddlCountry').val() == 'IN') {
        $('#DV_TH_P_ADDR #txtState').val('');
        $('#DV_TH_P_ADDR #txtDistrict').val('');
    }
});
$('#DV_TH_M_ADDR #txtPin').keyup(function () {
    $(this).next().text('').hide();

    if (!$.isEmptyObject(this.value)) {
        if (!$.isEmptyObject(this.value) && this.value.length >= 6 && $('#DV_TH_M_ADDR #ddlCountry').val() == 'IN') {
            ExtendedAjaxCall('DataEntry/SearchPincode/' + this.value, null, 'GET', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.length > 0) {
                        $('#DV_TH_M_ADDR #txtState').val(result[0].State).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_TH_M_ADDR #txtDistrict').val(result[0].District).prop('disabled', true).addClass('DisabledControl').removeClass('InputBorderRed');
                        $('#DV_TH_M_ADDR #txtCity').val(result[0].District).removeClass('InputBorderRed');
                    }
                    else {
                        $('#DV_TH_M_ADDR #txtPin').next().text('Please enter valid Pincode').show();
                    }
                } catch (e) {
                    fnException(e);
                }
                $('#preloader').hide();

            }, null, true, false, false, ErrorFunction);
        }
        else {
            $(this).next().text('Please enter valid Pincode').show();
        }
    }
    else if ($('#DV_TH_M_ADDR #ddlCountry').val() == 'IN') {
        $('#DV_TH_M_ADDR #txtState').val('');
        $('#DV_TH_M_ADDR #txtDistrict').val('');
    }
});
$('#btn_COMM_YES').click(function () {
    if (SaveStep5Details()) {
        if ($('#chkNomApplicable').prop('checked')) {
            if (stepper.maxTabIndex == stepper.activeTabIndex)
                stepper.maxTabIndex += 1

            $('#IdBtnTabSwit06').click();
            $('#IdBtnTabSwit05').css('border-color', '#047904');
        }
        else {
            if (stepper.maxTabIndex == stepper.activeTabIndex)
                stepper.maxTabIndex += 2

            $('#IdBtnTabSwit07').click();
            $('#IdBtnTabSwit05').css('border-color', '#047904');
        }
    }
});
//step5 clear
$('#btnCancel05').bind('click', Reset_step5);
$('#btn_SH_PAN_Match_No').click(function () {
    Reset_step5();
});
$('#btn_TH_PAN_Match_No').click(function () {
    Reset_step5();
});

//avinash added Occupation/sub-occupation changes
$('#ddlCustSegType').change(function () {
    var CustSegType_Code = $("#ddlCustSegType").val();
    if (CustSegType_Code > 0) {
        $("#Occ_Cus_SegSubtype_Div").show();
    }
    else {
        $("#Occ_Cus_SegSubtype_Div").hide();
    }
    //BindDDLExtendedAjaxCall('#ddlCustSegSubType', 'DataEntry/Get_ddl_Occ_CustSegSubTypeList?CustSegType_Code=' + CustSegType_Code, null, 'POST', null, null, true, false, false, ErrorFunction);

    ExtendedAjaxCall('DataEntry/Get_ddl_Occ_CustSegSubTypeList', CustSegType_Code, 'POST', function (result) {
        try {
            if (!$.isEmptyObject(result) && result.length > 0) {
                $("#Occ_Cus_SegSubtype_Div").show();
                $('#ddlCustSegSubType').empty();
                $('#ddlCustSegSubType').append("<option value='select' data-row='0'>Select</option>");
                $.each(result, function (i, row) {
                    $('#ddlCustSegSubType').append("<option value='" + row['Code'] + "' data-row='" + JSON.stringify(row) + "'>" + row['Desc'] + "</option>");
                });
            }
            else {
                $("#Occ_Cus_SegSubtype_Div").hide();
            }
        } catch (e) {
            fnException(e);
        }
    }, null, true, false, false, ErrorFunction);
});

$('#DV_SH #ddlCustSegType').change(function () {
    var CustSegType_Code = $("#DV_SH #ddlCustSegType").val();
    if (CustSegType_Code > 0) {
        $("#DV_SH #Occ_Cus_SegSubtype_Div").show();
    }
    else {
        $("#DV_SH #Occ_Cus_SegSubtype_Div").hide();
    }
    ExtendedAjaxCall('DataEntry/Get_ddl_Occ_CustSegSubTypeList', CustSegType_Code, 'POST', function (result) {
        try {
            if (!$.isEmptyObject(result) && result.length > 0) {
                $("#DV_SH #Occ_Cus_SegSubtype_Div").show();
                $('#DV_SH #ddlCustSegSubType').empty();
                $('#DV_SH #ddlCustSegSubType').append("<option value='select' data-row='0'>Select</option>");
                $.each(result, function (i, row) {
                    $('#DV_SH #ddlCustSegSubType').append("<option value='" + row['Code'] + "' data-row='" + JSON.stringify(row) + "'>" + row['Desc'] + "</option>");
                });
            }
            else {
                $("#DV_SH #Occ_Cus_SegSubtype_Div").hide();
            }
        } catch (e) {
            fnException(e);
        }
    }, null, true, false, false, ErrorFunction);
});

$('#DV_TH #ddlCustSegType').change(function () {
    var CustSegType_Code = $("#DV_TH #ddlCustSegType").val();
    if (CustSegType_Code > 0) {
        $("#DV_TH #Occ_Cus_SegSubtype_Div").show();
    }
    else {
        $("#DV_TH #Occ_Cus_SegSubtype_Div").hide();
    }
    ExtendedAjaxCall('DataEntry/Get_ddl_Occ_CustSegSubTypeList', CustSegType_Code, 'POST', function (result) {
        try {
            if (!$.isEmptyObject(result) && result.length > 0) {
                $("#DV_TH #Occ_Cus_SegSubtype_Div").show();
                $('#DV_TH #ddlCustSegSubType').empty();
                $('#DV_TH #ddlCustSegSubType').append("<option value='select' data-row='0'>Select</option>");
                $.each(result, function (i, row) {
                    $('#DV_TH #ddlCustSegSubType').append("<option value='" + row['Code'] + "' data-row='" + JSON.stringify(row) + "'>" + row['Desc'] + "</option>");
                });
            }
            else {
                $("#DV_TH #Occ_Cus_SegSubtype_Div").hide();
            }
        } catch (e) {
            fnException(e);
        }
    }, null, true, false, false, ErrorFunction);
});

//step6 submit
function SubmitStep6() {
    try {
        let err_msg = isValidStep6();
        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, "error");
            return false;
        }

        //Nominee Dtls            
        let Nominee_Dtl = getStep6Data();

        ExtendedAjaxCall('RenewInvestorDetailsSave/SubmitStep6', Nominee_Dtl, 'POST', function (result) {
            try {
                if (!$.isEmptyObject(result) && result.Status == 1)
                    BTP_OBJECT.NomDetailsSave = true;
                else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg))
                    err_msg += '<p>' + result[0].Msg + '</p>';
                else
                    err_msg += '<p>Something went wrong..!</p>';

                $('#preloader').hide();

            } catch (e) {
                fnException(e);
            }
        }, null, true, false, false, ErrorFunction);

        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, "error");
            return false;
        }

        return true;
    } catch (e) {
        fnException(e); return false;
    }
}

//step6 save validations
function isValidStep6() {
    let err_msg = "";

    try {
        $('.form-control').removeClass('InputBorderRed');

        let $ddlNomTitle = $('#ddlNomTitle');
        let $txtNomFName = $('#txtNomFName');
        let $ddlNomRelation = $('#ddlNomRelation');
        let $txtNomDOB = $('#txtNomDOB');
        let $ddlNomGuardianTitle = $('#ddlNomGuardianTitle');
        let $txtNomGuardianFName = $('#txtNomGuardianFName');
        let $txtAdd1 = $('#DV_NOM #txtAdd1');
        let $ddlCountry = $('#DV_NOM #ddlCountry');
        let $txtPin = $('#DV_NOM #txtPin');
        let $txtState = $('#DV_NOM #txtState');
        let $txtDistrict = $('#DV_NOM #txtDistrict');
        let $txtCity = $('#DV_NOM #txtCity');
        let $txtMobileNo = $('#DV_NOM #txtMobileNo');
        let $txtEmailId = $('#DV_NOM #txtEmailId');

        if ($ddlNomTitle.val() == 'select') {
            err_msg += '<p>Nominee Salutation is required..!</p>';
            $ddlNomTitle.addClass('InputBorderRed');
        }

        if ($txtNomFName.val() == '') {
            err_msg += '<p>Nominee First Name is required..!</p>';
            $txtNomFName.addClass('InputBorderRed');
        }

        if ($ddlNomRelation.val() == 'select') {
            err_msg += '<p>Nominee Relation is required..!</p>';
            $ddlNomRelation.addClass('InputBorderRed');
        }

        if ($('#chkIsNomMinor').prop('checked')) {
            if ($txtNomDOB.val() == '') {
                err_msg += '<p>Nominee DOB is required..!</p>';
                $txtNomDOB.parent().addClass('InputBorderRed');
            }
            else {
                $txtNomDOB.parent().removeClass('InputBorderRed');
            }

            if ($ddlNomGuardianTitle.val() == 'select') {
                err_msg += "<p>Nominee Guardian's Prefix is required..!</p>";
                $ddlNomGuardianTitle.addClass('InputBorderRed');
            }

            if ($txtNomGuardianFName.val() == '') {
                err_msg += "<p>Nominee Giardian's Name is required..!</p>";
                $txtNomGuardianFName.addClass('InputBorderRed');
            }
        }

        if ($.isEmptyObject($('#lblFolioNumber').text())) {
            if ($txtAdd1.val() == '') {
                err_msg += '<p>Nominee Address Line 1 is required..!</p>';
                $txtAdd1.addClass('InputBorderRed');
            }

            if ($ddlCountry.val() == 'select') {
                err_msg += '<p>Nominee Country is required..!</p>';
                $ddlCountry.addClass('InputBorderRed');
            }

            if ($txtPin.val() == '') {
                err_msg += '<p>Nominee Postal Code is required..!</p>';
                $txtPin.addClass('InputBorderRed');
            }

            if ($txtState.val() == '') {
                err_msg += '<p>Nominee State is required..!</p>';
                $txtState.addClass('InputBorderRed');
            }

            if ($ddlCountry.val() == 'IN' && $txtDistrict.val() == '') {
                err_msg += '<p>Nominee District is required..!</p>';
                $txtDistrict.addClass('InputBorderRed');
            }

            if ($txtCity.val() == '') {
                err_msg += '<p>Nominee City is required..!</p>';
                $txtCity.addClass('InputBorderRed');
            }
        }

        if (!$.isEmptyObject($txtMobileNo.val()) && !IsValidMobile($txtMobileNo.val())) {
            err_msg += "<p>Nominee Mobile No is not valid..!</p>";
            $txtMobileNo.addClass('InputBorderRed');
        }

        if (!$.isEmptyObject($txtEmailId.val()) && !IsValidEmail($txtEmailId.val())) {
            err_msg += "<p>Nominee Email Address is not valid..!</p>";
            $txtEmailId.addClass('InputBorderRed');
        }

    } catch (e) {
        fnException(e);
    }
    return err_msg;
}

//get step6 data for save
function getStep6Data() {
    let Nominee_Dtl = {};
    try {
        //Nominee Dtls            
        Nominee_Dtl.Appl_No = $('#lblApplicationNumber').text().trim();
        Nominee_Dtl.Nominee_Salutation = $("#ddlNomTitle").val() == 'select' ? null : $("#ddlNomTitle").val();
        Nominee_Dtl.Nominee_First_Name = $("#txtNomFName").val().trim();
        Nominee_Dtl.Nominee_Middle_Name = $("#txtNomMName").val().trim();
        Nominee_Dtl.Nominee_Last_Name = $("#txtNomLName").val().trim();
        Nominee_Dtl.Nominee_Name = $("#txtNomFName").val().trim() + ' ' + $("#txtNomMName").val().trim() + ' ' + $("#txtNomLName").val().trim();
        Nominee_Dtl.Nominee_Relations = $("#ddlNomRelation").val();
        Nominee_Dtl.Nominee_DOB = $("#txtNomDOB").val();
        Nominee_Dtl.Is_Nominee_Minor = $('#chkIsNomMinor').prop('checked');//Nominee_Dtl.IsMinor();
        Nominee_Dtl.Address1 = $("#DV_NOM #txtAdd1").val().trim();
        Nominee_Dtl.Address2 = $("#DV_NOM #txtAdd2").val().trim();
        Nominee_Dtl.Address3 = $("#DV_NOM #txtAdd3").val().trim();
        Nominee_Dtl.City = $("#DV_NOM #txtCity").val().trim();
        Nominee_Dtl.Country = $("#DV_NOM #ddlCountry").val();
        Nominee_Dtl.CountryCode = $("#DV_NOM #ddlCountry").val();
        Nominee_Dtl.CountryName = $("#DV_NOM #ddlCountry option:selected").text().trim();
        Nominee_Dtl.StateName = $("#DV_NOM #txtState").val().trim();
        Nominee_Dtl.DistrictName = $("#DV_NOM #txtDistrict").val().trim();
        Nominee_Dtl.PIN = $("#DV_NOM #txtPin").val();
        Nominee_Dtl.EmailID = $("#DV_NOM #txtEmailId").val().trim();
        Nominee_Dtl.MobileNo = $("#DV_NOM #txtMobileNo").val().trim();
        Nominee_Dtl.TelephoneNo = $("#DV_NOM #txtTelephone").val().trim();
        if ($('#chkIsNomMinor').prop('checked') && $("#txtNomGuardianFName").val().trim() != '') {
            Nominee_Dtl.Guardian_Salutation = $("#ddlNomGuardianTitle").val() == 'select' ? null : $("#ddlNomGuardianTitle").val();
            Nominee_Dtl.Guardian_First_Name = $("#txtNomGuardianFName").val().trim();
            Nominee_Dtl.Guardian_Middle_Name = $("#txtNomGuardianMName").val().trim();
            Nominee_Dtl.Guardian_Last_Name = $("#txtNomGuardianLName").val().trim();
            Nominee_Dtl.GuardianName = $("#txtNomGuardianFName").val().trim() + ' ' + $("#txtNomGuardianMName").val().trim() + ' ' + $("#txtNomGuardianLName").val().trim();
        }
        Nominee_Dtl.FolioNo = $('#lblFolioNumber').text().trim();
        Nominee_Dtl.FDRNo = $('#lblExistingFDRNumber').text().trim();
        Nominee_Dtl.LastInvDate = $('#lblLastInvestmentDate').text().trim();

    } catch (e) {
        fnException(e);
    }
    return Nominee_Dtl;
}

//step6 reset
function Reset_step6() {
    $('.errorbox').text('').hide();
    $('.form-control').removeClass('InputBorderRed');

    $('#ddlNomTitle').val('select');
    $('#txtNomFName').val('');
    $('#txtNomMName').val('');
    $('#txtNomLName').val('');
    $('#ddlNomRelation').val('select');
    $('#txtNomDOB').datetextentry('set_date', null);
    $('#ddlNomGuardianTitle').val('select');
    $('#txtNomGuardianFName').val('');
    $('#txtNomGuardianMName').val('');
    $('#txtNomGuardianLName').val('');

    $('#DV_NOM #txtAdd1').val('');
    $('#DV_NOM #txtAdd2').val('');
    $('#DV_NOM #txtAdd3').val('');
    $('#DV_NOM #txtCity').val('');
    $('#DV_NOM #ddlCountry').val('IN').change();
    $('#DV_NOM #txtPin').val('').keyup();
    $('#DV_NOM #txtState').val('');
    $('#DV_NOM #txtDistrict').val('');

    $('#DV_NOM #txtTelephone').val('');
    $('#DV_NOM #txtMobileNo').val('');
    $('#DV_NOM #txtEmailId').val('');

    $('#chkIsNomMinor').prop('checked', false);
    $('#chkNomAddrSameAsFH').prop('checked', false);

    if (!$.isEmptyObject($('#lblFolioNumber').text())) {
        $('#ddlProvNominee').val('select');
        $('#DV_PROV_NOM').show();
        $('#DV_NOM_DTLS').hide();
    }
    else {
        $('#DV_PROV_NOM').hide();
        $('#DV_NOM_DTLS').show();
    }
}


$('#IdBtnTabSwit06').click(function () {
    try {
        if (!$.isEmptyObject($('#lblFolioNumber').text())) {
            $('#DV_NOM_ADDR .red-text').text('');
            let objBO = {
                Folio: $('#lblFolioNumber').text()
            };

            BindDDLExtendedAjaxCall('#ddlProvNominee', 'HolderDetails/GetProvNomineeDtls', objBO, 'POST', null, null, true, false, false, ErrorFunction);
        }
        else {
            $('#DV_NOM_ADDR .red-text').text('*');
            $('#DV_PROV_NOM').hide();
            $('#DV_NOM_DTLS').show();
        }
    } catch (e) {
        fnException(e); return false;
    }
});

$('#ddlProvNominee').change(function () {
    try {
        if (!$.isEmptyObject(this.value) && this.value != 'select') {
            let objBO = {
                Id: this.value
            };

            ExtendedAjaxCall('HolderDetails/GetProvNomineeDtls', objBO, 'POST', function (result) {
                if (!$.isEmptyObject(result)) {
                    $('#ddlNomTitle').val(result[0].Nominee_Salutation);
                    $('#txtNomFName').val(result[0].Nominee_First_Name);
                    $('#txtNomMName').val(result[0].Nominee_Middle_Name);
                    $('#txtNomLName').val(result[0].Nominee_Last_Name);
                    $('#ddlNomRelation').val(result[0].Nominee_Relations);
                    $('#txtNomDOB').datetextentry('set_date', result[0].Nominee_DOB);
                    $('#ddlNomGuardianTitle').val(result[0].Guardian_Salutation);
                    $('#txtNomGuardianFName').val(result[0].Guardian_FirstName);
                    $('#txtNomGuardianMName').val(result[0].Guardian_MiddleName);
                    $('#txtNomGuardianLName').val(result[0].Guardian_LastName);

                    $('#DV_NOM #txtAdd1').val(result[0].Address1);
                    $('#DV_NOM #txtAdd2').val(result[0].Address2);
                    $('#DV_NOM #txtAdd3').val(result[0].Address3);
                    $('#DV_NOM #txtCity').val(result[0].City);
                    $('#DV_NOM #ddlCountry').val(result[0].CountryCode).change();
                    $('#DV_NOM #txtPin').val(result[0].PIN).keyup();
                    $('#DV_NOM #txtTelephone').val(result[0].EmailID);
                    $('#DV_NOM #txtMobileNo').val(result[0].MobileNo);
                    $('#DV_NOM #txtEmailId').val(result[0].Telephone_No);
                    if (result[0].Is_Nominee_Minor)
                        $('#chkIsNomMinor').prop('checked', true);
                    else
                        $('#chkIsNomMinor').prop('checked', false);
                    $('#DV_PROV_NOM').hide();
                    $('#DV_NOM_DTLS').show();
                }

                $('#preloader').hide();
            }, null, true, false, false, ErrorFunction);
        }
    } catch (e) {
        fnException(e); return false;
    }
});

$('#btnAddNewNominee').click(function () {
    $('#DV_PROV_NOM').hide();
    $('#DV_NOM_DTLS').show();
});

$('#txtNomDOB').datetextentry({
    min_year: '1915',
    max_date: function () { return this.get_today(); },
    max_date_message: 'Date cannot be future date',
});

$('#chkIsNomMinor').change(function () {
    if ($(this).prop('checked')) {
        $('#SPN_DOB').text('*');
        $('.N_GUARDIAN').slideDown();
        $('#txtNomDOB, #ddlNomGuardianTitle, #txtNomGuardianFName').prop('required', true);
    }
    else {
        $('#SPN_DOB').text('');
        $('.N_GUARDIAN').slideUp();
        $('#txtNomDOB, #ddlNomGuardianTitle, #txtNomGuardianFName').prop('required', false).removeClass('InputBorderRed');
    }
});

$('#chkNomAddrSameAsFH').change(function () {
    if ($(this).prop('checked')) {
        $('#DV_NOM #txtAdd1').val($('#DV_FH_P_ADDR #txtAdd1').val());
        $('#DV_NOM #txtAdd2').val($('#DV_FH_P_ADDR #txtAdd2').val());
        $('#DV_NOM #txtAdd3').val($('#DV_FH_P_ADDR #txtAdd3').val());
        $('#DV_NOM #txtCity').val($('#DV_FH_P_ADDR #txtCity').val());
        $('#DV_NOM #ddlCountry').val($('#DV_FH_P_ADDR #ddlCountry').val()).change();
        $('#DV_NOM #txtPin').val($('#DV_FH_P_ADDR #txtPin').val()).keyup();
        $('#DV_NOM #txtState').val($('#DV_FH_P_ADDR #txtState').val());
        $('#DV_NOM #txtDistrict').val($('#DV_FH_P_ADDR #txtDistrict').val());
    }
    else {
        if (BTP_OBJECT.mode == 'A') {
            if (confirm('Are you sure you want to clear Nominee\'s Address..?')) {
                $('#DV_NOM #txtAdd1').val('');
                $('#DV_NOM #txtAdd2').val('');
                $('#DV_NOM #txtAdd3').val('');
                $('#DV_NOM #txtCity').val('');
                $('#DV_NOM #ddlCountry').val('IN').change();
                $('#DV_NOM #txtPin').val('').keyup();
                $('#DV_NOM #txtState').val('');
                $('#DV_NOM #txtDistrict').val('');
            }
            else
                $(this).prop('checked', true);
        }
        else {
            $('#DV_NOM #txtAdd1').val('');
            $('#DV_NOM #txtAdd2').val('');
            $('#DV_NOM #txtAdd3').val('');
            $('#DV_NOM #txtCity').val('');
            $('#DV_NOM #ddlCountry').val('IN').change();
            $('#DV_NOM #txtPin').val('').keyup();
            $('#DV_NOM #txtState').val('');
            $('#DV_NOM #txtDistrict').val('');
        }

    }
});

$('#DV_NOM #ddlCountry').change(function () {
    if (this.value == 'IN') {
        $('#DV_NOM #txtState').prop('disabled', true).addClass('DisabledControl');
        $('#DV_NOM #txtDistrict').prop('disabled', true).addClass('DisabledControl');
    }
    else {
        $('#DV_NOM #txtState').prop('disabled', false).removeClass('DisabledControl');
        $('#DV_NOM #txtDistrict').prop('disabled', false).removeClass('DisabledControl');
    }
});

$('#DV_NOM #txtPin').keyup(function () {
    $(this).next().text('').hide();
    if (!$.isEmptyObject(this.value) && $('#DV_NOM #ddlCountry').val('IN')) {
        if (this.value.length >= 6) {
            ExtendedAjaxCall('DataEntry/SearchPincode/' + this.value, null, 'GET', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.length > 0) {
                        $('#DV_NOM #txtState').val(result[0].State).prop('disabled', true).addClass('DisabledControl');
                        $('#DV_NOM #txtDistrict').val(result[0].District).prop('disabled', true).addClass('DisabledControl');
                        $('#DV_NOM #txtCity').val(result[0].District);
                    }
                    else {
                        $('#DV_NOM #txtState').val('');
                        $('#DV_NOM #txtDistrict').val('');
                        $('#DV_NOM #txtPin').next().text('Please enter valid Pincode').show();
                    }
                } catch (e) {
                    fnException(e);
                }
                $('#preloader').hide();

            }, null, true, false, false, ErrorFunction);
        }
        else {
            $('#DV_NOM #txtState').val('');
            $('#DV_NOM #txtDistrict').val('');
            $(this).next().text('Please enter valid Pincode').show();
        }
    }
});

$('#btnCancel06').bind('click', Reset_step6);

var PANUpload = false;
var SHPANUpload = false;
var THPANUpload = false;
var byteArr = null;
var filename = null;

//view uploaded document
function ViewDocument(btn) {
    try {
        byteArry = null;
        filename = null;

        $('#IdViewImageDiv').empty()

        let id = $(btn).prop('id');

        ExtendedAjaxCall('DocumentUpload/Get_ImgFullscreen?_id=' + id, null, 'GET', function (result) {
            if (result != null) {
                if (result.fileExt.toLowerCase() == 'pdf') {
                    if (navigator.appName == 'Microsoft Internet Explorer' || !!(navigator.userAgent.match(/Trident/) || navigator.userAgent.match(/rv:11/)) || (typeof $.browser !== "undefined" && $.browser.msie == 1)) {
                        //set byteArry and filename
                        byteArry = result.byteArry;
                        filename = result.filename;

                        let _html = "";
                        _html = _html + '<p>You don\'t have Adobe Reader or PDF support in this web browser. </ br> <a id="DocFullscreenOBJ_A" onclick="DownloadFile()">Click here to download the PDF</a>.</p>';

                        $('#IdViewImageDiv').html(_html);

                        let byteCharacters = atob(result.byteArry);
                        let byteNumbers = new Array(byteCharacters.length);
                        for (let i = 0; i < byteCharacters.length; i++) {
                            byteNumbers[i] = byteCharacters.charCodeAt(i);
                        }
                        let byteArray = new Uint8Array(byteNumbers);
                        let blob = new Blob([byteArray], { type: 'application/pdf' });
                        window.navigator.msSaveOrOpenBlob(blob, result.filename);
                    }
                    else {

                        let _html = '<object id="DocFullscreenOBJ"  type="application/pdf" height="450px" width="100%">';

                        $('#IdViewImageDiv').html(_html);
                        $('#DocFullscreenOBJ').attr('data', '');
                        $('#DocFullscreenOBJ').attr('data', result.doc_base64);
                        $('#Modal_View_Document').modal('show');
                    }
                }
                else {
                    let _html = '<object id="DocFullscreenOBJ"  type="application/pdf" height="auto" width="100%" style="max-width:800px;">';
                    $('#IdViewImageDiv').html(_html);

                    $('#DocFullscreenOBJ').attr('data', result.doc_base64);
                    $('#Modal_View_Document').modal('show');
                }
            }

            $('#preloader').hide();
        }, null, null, true, false, ErrorFunction);

        let DocumentLog = {};
        DocumentLog.Event = $(this).text() + ' Click';
        DocumentLog.Ref_No_1 = $('#lblApplicationNumber').text();
        DocumentLog.Ref_Type_1 = 'Internal View Button Clicked';   // $('#ddlFilterDocType').val()   $('#ddlUploadedImage').val()
        //DocumentLog.Ref_No_1_Desc =;
        //DocumentLog.Ref_No_2 =;
        DocumentLog.Ref_Type_2 = Status == 'APR' ? 'Checker' : 'Maker';
        //DocumentLog.Ref_No_2_Desc =;

        ViewDocumentLog(DocumentLog);

    } catch (e) {
        fnException(e); return false;
    }
}
//download file in IE
const DownloadFile = function () {
    try {
        let byteCharacters = atob(byteArry);
        let byteNumbers = new Array(byteCharacters.length);
        for (let i = 0; i < byteCharacters.length; i++) {
            byteNumbers[i] = byteCharacters.charCodeAt(i);
        }
        let byteArray = new Uint8Array(byteNumbers);
        let blob = new Blob([byteArray], { type: 'application/pdf' });
        window.navigator.msSaveOrOpenBlob(blob, filename);

    } catch (e) {
        fnException(e); return false;
    }
}
//delete uploaded file
const DeleteDocument = function (btn) {
    try {
        let App_No = $('#lblApplicationNumber').text().trim();
        let id = $(btn).prop('id');

        if (confirm('Are you sure you want to delete this..?')) {
            ExtendedAjaxCall('DocumentUpload/Delete_Doc?_id=' + id, null, 'GET', function (result) {
                $('#preloader').hide();
                $('#imageFullScreen').attr('src', '');
            }, null, true, false, false, ErrorFunction);
        }

        BindOVD(App_No);

    } catch (e) {
        fnException(e); return false;
    }
}
//bind ovd details
const BindOVD = function (appNo) {
    try {
        if (!$.isEmptyObject(appNo)) {
            ExtendedAjaxCall('DocumentUpload/Get_OVDAsync?_ApplNo=' + appNo, null, 'GET', function (result) {
                if (!$.isEmptyObject(result) && result.length > 0) {
                    let OVDList = [];

                    $('#tblOVDList > tbody tr').each(function () {

                        let $this = $(this);
                        let DOC_ID = Number($($this.find('td')[0]).text());
                        let OVD_Dtls = {
                            DOC_ID: DOC_ID,
                            HolderType_Desc: $($this.find('td')[1]).text(),
                            Document_Type_Desc: $($this.find('td')[2]).text(),
                            Document_Sub_Type_Desc: $($this.find('td')[3]).text(),
                            //Doc_Ref_No: Doc_Ref_No1,
                            Doc_Ref_No: $.isEmptyObject($this.find('#OVDRefNo_' + DOC_ID).val()) ? '' : $this.find('#OVDRefNo_' + DOC_ID).val(),
                            Doc_Exp_Date: $.isEmptyObject($this.find('#OVDExpDate_' + DOC_ID).val()) ? '' : $this.find('#OVDExpDate_' + DOC_ID).val(),
                        }
                        OVDList.push(OVD_Dtls);
                    });

                    $('#tblOVDList > tbody').empty();

                    $.each(result, function (i, data) {
                        let HTML = '';

                        HTML += '<tr>';
                        HTML += '<td id="' + data.Code + '" style="display:none">' + data.Code + '</td>';
                        HTML += '<td >' + data.HolderTypeDesc + '</td>';
                        HTML += '<td>' + data.DocTypeDesc + '</td>';
                        if (!$.isEmptyObject(data.DocSubTypeDesc))
                            HTML += '<td>' + data.DocSubTypeDesc + '</td>';
                        else
                            HTML += '<td></td>';

                        if (data.Is_Doc_Ref_No_Required == 1) {
                            if (data.Doc_Sub_Type == 'AADHARCARD_A') {
                                HTML += '<td><input type="text" id="OVDRefNo_' + data.Code
                                    + '" doc_id="' + data.Code
                                    + '" HolderTypeCode="' + data.HolderTypeCode
                                    + '" sub_doc_type="' + data.DocSubTypeDesc
                                    + '"  class="form-control uppercase txtOVDRef number_only AADHARCARD" onkeyup="refnoToUpper(this)" maxlength="4" />  <span class="errorbox" style="display:none;position:inherit !important"></span></td>';
                            }
                            else if (data.Doc_Sub_Type == 'PAN') {
                                HTML += '<td><input type="text" id="OVDRefNo_' + data.Code
                                    + '" doc_id="' + data.Code
                                    + '" HolderTypeCode="' + data.HolderTypeCode
                                    + '" sub_doc_type="' + data.DocSubTypeDesc
                                    + '"  class="form-control uppercase txtOVDRef OVDPAN number_only " onkeyup="refnoToUpper(this)" maxlength="10" />  <span class="errorbox" style="display:none;position:inherit !important"></span></td>';
                            }
                            else {
                                HTML += '<td><input type="text" id="OVDRefNo_' + data.Code
                                    + '" doc_id="' + data.Code
                                    + '" HolderTypeCode="' + data.HolderTypeCode
                                    + '" sub_doc_type="' + data.DocSubTypeDesc
                                    + '"  class="form-control uppercase txtOVDRef" onkeyup="refnoToUpper(this)" maxlength="20" />  <span class="errorbox" style="display:none;position:inherit !important"></span></td>';
                            }
                        }
                        else {
                            HTML += '<td></td>';
                        }

                        if (data.Is_Doc_Exp_Date_Required == 1) {
                            HTML += '<td class="text-center"><input type="text" id="OVDExpDate_' + data.Code + '" class="form-control OVD_ExpDate txtOVDExp" required regex="dob"  /> <span class="errorbox" style="display:none"></span></td>';
                        }
                        else {
                            HTML += '<td></td>';
                        }

                        //HTML += '<td style="text-align:center;"><button id="' + data.Code + '" type="button" class="comnBtn2 OVD_VIEW" style="margin:0;" onclick="ViewDocument(this)">View</button></td>';

                        if (data.HolderTypeCode == '01' && (BTP_OBJECT.FH_DATA_SOURCE == 'CKYC' || BTP_OBJECT.FH_DATA_SOURCE == 'FRESH')) {
                            HTML += '<td style="text-align:center;"><button id="' + data.Code + '" type="button" class="comnBtn2 OVD_VIEW" style="margin:0;" onclick="ViewDocument(this)">View</button></td>';
                        }
                        else if (data.HolderTypeCode == '02' && (BTP_OBJECT.SH_DATA_SOURCE == 'CKYC' || BTP_OBJECT.SH_DATA_SOURCE == 'FRESH')) {
                            HTML += '<td style="text-align:center;"><button id="' + data.Code + '" type="button" class="comnBtn2 OVD_VIEW" style="margin:0;" onclick="ViewDocument(this)">View</button></td>';
                        }
                        else if (data.HolderTypeCode == '03' && (BTP_OBJECT.TH_DATA_SOURCE == 'CKYC' || BTP_OBJECT.TH_DATA_SOURCE == 'FRESH')) {
                            HTML += '<td style="text-align:center;"><button id="' + data.Code + '" type="button" class="comnBtn2 OVD_VIEW" style="margin:0;" onclick="ViewDocument(this)">View</button></td>';
                        }
                        else {
                            HTML += '<td></td>';
                        }

                        if (data.Document_Source == 'CKYC') {
                            HTML += '<td></td>';
                        }
                        else {
                            HTML += '<td style="text-align:center;"><button id="' + data.Code + '" type="button" class="comnBtn2 OVD_DELETE" style="margin:0;" onclick="DeleteDocument(this)">Delete</button></td>';
                        }
                        HTML += '</tr>';

                        $('#tblOVDList > tbody').append(HTML);

                        BindAddProof_DatePicker($('.OVD_ExpDate'));

                        if (!$.isEmptyObject(data.Doc_Ref_No))
                            $("#OVDRefNo_" + data.Code).val(data.Doc_Ref_No);

                        if (!$.isEmptyObject(data.Doc_Exp_Date))
                            $("#OVDExpDate_" + data.Code).datetextentry('set_date', data.Doc_Exp_Date);


                        $.each(OVDList, function (i, row) {
                            if (row.DOC_ID == data.Code && row.HolderType_Desc == data.HolderTypeDesc && row.Document_Type_Desc == data.DocTypeDesc && row.Document_Sub_Type_Desc == data.DocSubTypeDesc) {
                                if (!$.isEmptyObject(row.Doc_Ref_No))
                                    $("#OVDRefNo_" + data.Code).val(row.Doc_Ref_No);

                                if (!$.isEmptyObject(row.Doc_Exp_Date))
                                    $("#OVDExpDate_" + data.Code).datetextentry('set_date', row.Doc_Exp_Date);
                            }
                        });
                    });

                    $('.AADHARCARD').on("input", function () {
                        var regexp = /[^0-9]/g;
                        if ($(this).val().match(regexp)) {
                            $(this).val($(this).val().replace(regexp, ''));
                        }
                    });
                    $('.OVDPAN').keyup(function () {
                        if (!$.isEmptyObject(this.value) && !IsValidPAN(this.value))
                            $(this).next().text('PAN is not valid').show();
                        else {
                            $(this).next().text('').hide();
                        }
                    });


                    $('#tblOVDList tbody').removeClass('clear_tbody');
                }
                else {

                    $('#tblOVDList>tbody').html('<tr class="empty_table"><td style="text-align:center;" colspan="7">No Record..!</td></tr>');
                }

                $('#preloader').hide();
            }, null, null, false, false, ErrorFunction);

            ////Data extraction----------------------------------------------------------------------------------------
            //$('#tblOVDList tbody tr').each(function (i, row)
            //{
            //    let refNo = $($(this).find('td')[4]).find('input');
            //    if (!$.isEmptyObject(refNo) && refNo.length > 0 && $.isEmptyObject(refNo.val()))
            //        Data_Extraction(refNo);
            //});
            //End Data extraction-----------------------------------------------------------------------------------------
        }
    } catch (e) {
        fnException(e); return false;
    }
}
//ref no to upper
const refnoToUpper = function (ref_no) {
    let refno = $(ref_no).val();
    $(ref_no).val(refno.toUpperCase());
}
//file size valdations
const FileSizeValidation = function (file) {
    try {
        if (!$.isEmptyObject(file) && Math.round((file.size / 1024 / 1024), 2) > 4.00) {
            MessagePopup('<p>Selecteddocumentcouldnotbeuploaded. Exceedingthemaximumfilesizeof4MB!!</p>', 'error');
            return false;
        }
        return true;

    } catch (e) {
        fnException(); return false;
    }
}
//kyc document upload validations
const isValidateFileUploadData = function () {
    try {
        let isValid = true;
        let ErrorHtml = "";

        let ApplicationNumber = $('#lblApplicationNumber').text();
        let DepositorsStatus = $('#ddlDepositorsStatus').val();
        let HolderType = $('#ddlDocHolderType').val();
        let DocType = $('#ddlDocType').val();

        $('#ddlDepositorsStatus,#ddlDocHolderType,#ddlDocType').removeClass('InputBorderRed');

        if ($.isEmptyObject(ApplicationNumber)) {
            ErrorHtml += '<p>Application no. is required..!</p>';
            isValid = false;
        }

        if (DepositorsStatus == 'select') {
            ErrorHtml += '<p>Depositors Status is required..!</p>';
            isValid = false;
        }

        if (HolderType == 'select') {
            ErrorHtml += '<p>Holder Type is required..!</p>';
            $('#ddlHolderType').addClass('InputBorderRed');
            isValid = false;
        }

        if (DocType == 'select') {
            ErrorHtml += '<p>Doc Type is required..!</p>';
            $('#ddlDocType').addClass('InputBorderRed');
            isValid = false;
        }

        if ($('#flvDocUpload')[0].files.length == 0) {
            ErrorHtml += '<p>Please select file to upload..!</p>';;
            isValid = false;
        }

        if (!isValid) {
            BtpMessagePopup(ErrorHtml, 'error');
            return false;
        }




        return true;
    } catch (e) {
        fnException(e); return false;
    }
}
//ovd ref no and ref date validations
const ValidateOVD = function () {
    try {
        $('.txtOVDRef').removeClass('InputBorderRed');
        $('.txtOVDExp').parent().removeClass('InputBorderRed');
        let isValid = 1;
        let setFocus = 0;
        $('.txtOVDRef').each(function () {
            if (this.value == '') {
                $(this).addClass('InputBorderRed');
                isValid = 0
                if (setFocus == 0) {
                    $(this).focus();
                    setFocus = 1
                }

            }

        });

        $('.txtOVDExp').each(function () {
            if (this.value == '') {
                $(this).parent().addClass('InputBorderRed');
                isValid = 0
                if (setFocus == 0) {
                    $(this).focus();
                    setFocus = 1
                }

            }
        });

        if (isValid == 0)
            return false;

        return true;
    } catch (e) {
        fnException(e); return false;
    }
}
//application form upload validation
const ValidateFileUploadApplicationForm = function () {
    try {
        let isValid = true;
        let ErrorHtml = "";
        let ApplicationNumber = $('#lblApplicationNumber').text();

        if ($.isEmptyObject(ApplicationNumber)) {
            ErrorHtml += '<p>Application number is required..!</p>';;
            isValid = false;
        }

        if ($('#flvApplicationFormUpload').get(0).files.length == 0 || $.isEmptyObject($('#flvApplicationFormUpload').get(0).files)) {
            ErrorHtml += '<p>Please select file to upload..!</p>';;
            isValid = false;
        }

        if (!isValid) {
            BtpMessagePopup(ErrorHtml, 'error');
            return false;
        }
        return true;

    } catch (e) {
        fnException(e); return false;
    }
}
//document upload log
const DocumentUploadLog = function (Event, Depositor_Status_Code, App_No, HolderType, DocType, DocSubType, FDRNo, FolioNo) {
    try {
        let DocUploadLog = {
            Depositor_Status_Code: Depositor_Status_Code,
            App_No: App_No,
            HolderType: HolderType,
            DocType: DocType,
            DocSubType: DocSubType,
            FDRNo: FDRNo,
            FolioNo: FolioNo,
            Event: Event
        }

        ExtendedAjaxCall('DocumentUpload/InsertDocumentUploadLogAsync', DocUploadLog, 'POST', null, function (request) {
            //beforeSend function to hide preloader
        }, true, true, false);
    } catch (e) {
        $('#preloader').hide();
        console.error(e);
    }
}
//OVD validations
const IsDocUploaded = function () {
    let err_msg = '';
    try {
        let IsFormUploaded = false;
        let IsFHIPUploaded = false;
        let IsFHAPUploaded = false;
        let IsFHPhotoUploaded = false;
        let IsFHPANUploaded = true;
        let IsFHFORM15GHUploaded = false;
        let IsFHFATCANRI_ADDPRFUploaded = false;
        let IsFHFATCANRI_IDENTPRFUploaded = false;
        let IsFHFATCANRI_PASSPORTUploaded = false;
        let IsFHFATCANRI_VISA_WPUploaded = false;
        let IsFHFATCA_PIO_OCRUploaded = false;

        let IsSHIPUploaded = false;
        let IsSHAPUploaded = false;
        let IsSHPhotoUploaded = false;
        let IsSHFATCANRI_ADDPRFUploaded = false;
        let IsSHFATCANRI_IDENTPRFUploaded = false;
        let IsSHFATCANRI_PASSPORTUploaded = false;
        let IsSHFATCANRI_VISA_WPUploaded = false;
        let IsSHFATCA_PIO_OCRUploaded = false;

        let IsTHIPUploaded = false;
        let IsTHAPUploaded = false;
        let IsTHPhotoUploaded = false;
        let IsTHFATCANRI_ADDPRFUploaded = false;
        let IsTHFATCANRI_IDENTPRFUploaded = false;
        let IsTHFATCANRI_PASSPORTUploaded = false;
        let IsTHFATCANRI_VISA_WPUploaded = false;
        let IsTHFATCA_PIO_OCRUploaded = false;

        let IsHUF_HUF_PAN = false;
        let IsHUF_KARTHA_PAN = false;
        let IsHUF_KARTHA = false;
        let IsHUF = false;
        let IsHUF_CANCEL_CHEQUE = false;

        let appNo = $('#lblApplicationNumber').text().trim();

        if (!$.isEmptyObject(appNo)) {
            ExtendedAjaxCall('DocumentUpload/Get_KYCDocumentAsync?_ApplNo=' + appNo, null, 'GET', function (result) {
                if (!$.isEmptyObject(result)) {
                    $.each(result, function (i, row) {
                        if (row.Doc_Type == 'APPFRM')
                            IsFormUploaded = true;

                        if (BTP_OBJECT.IND_NIND == 'IND') {

                            //FH
                            if (row.Doc_Type == 'IDENTPRF' && row.Holder_Type == '01')
                                IsFHIPUploaded = true;
                            if (row.Doc_Type == 'ADDPRF' && row.Holder_Type == '01')
                                IsFHAPUploaded = true;
                            if (row.Doc_Type == 'PHOTO' && row.Holder_Type == '01')
                                IsFHPhotoUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'PHOTOGRAPH' && row.Holder_Type == '01')
                                IsFHPhotoUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FORM15GH' && row.Holder_Type == '01')
                                IsFHFORM15GHUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'TAX_DOCS' && row.Holder_Type == '01')
                                IsFHFORM15GHUploaded = true;

                            if (row.Doc_Sub_Type.toUpperCase() == 'FATCANRI_ADDPRF' && row.Holder_Type == '01')
                                IsFHFATCANRI_ADDPRFUploaded = true;
                            if (row.Doc_Sub_Type.toUpperCase() == 'FATCANRI_IDENTPRF' && row.Holder_Type == '01')
                                IsFHFATCANRI_IDENTPRFUploaded = true;
                            if (row.Doc_Sub_Type.toUpperCase() == 'FATCANRI_PASSPORT' && row.Holder_Type == '01')
                                IsFHFATCANRI_PASSPORTUploaded = true;
                            if (row.Doc_Sub_Type.toUpperCase() == 'FATCANRI_VISA_WP' && row.Holder_Type == '01')
                                IsFHFATCANRI_VISA_WPUploaded = true;
                            if (row.Doc_Sub_Type.toUpperCase() == 'FATCA_PIO_OCR' && row.Holder_Type == '01')
                                IsFHFATCA_PIO_OCRUploaded = true;

                            //SH
                            if (row.Doc_Type == 'IDENTPRF' && row.Holder_Type == '02')
                                IsSHIPUploaded = true;
                            if (row.Doc_Type == 'ADDPRF' && row.Holder_Type == '02')
                                IsSHAPUploaded = true;
                            if (row.Doc_Type == 'PHOTO' && row.Holder_Type == '02')
                                IsSHPhotoUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'PHOTOGRAPH' && row.Holder_Type == '02')
                                IsSHPhotoUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FATCANRI_ADDPRF' && row.Holder_Type == '02')
                                IsSHFATCANRI_ADDPRFUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FATCANRI_IDENTPRF' && row.Holder_Type == '02')
                                IsSHFATCANRI_IDENTPRFUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FATCANRI_PASSPORT' && row.Holder_Type == '02')
                                IsSHFATCANRI_PASSPORTUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FORMFATCANRI_VISA_WP15GH' && row.Holder_Type == '02')
                                IsSHFATCANRI_VISA_WPUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FATCA_PIO_OCR' && row.Holder_Type == '02')
                                IsSHFATCA_PIO_OCRUploaded = true;

                            //TH
                            if (row.Doc_Type == 'IDENTPRF' && row.Holder_Type == '03')
                                IsTHIPUploaded = true;
                            if (row.Doc_Type == 'ADDPRF' && row.Holder_Type == '03')
                                IsTHAPUploaded = true;
                            if (row.Doc_Type == 'PHOTO' && row.Holder_Type == '03')
                                IsTHPhotoUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'PHOTOGRAPH' && row.Holder_Type == '03')
                                IsTHPhotoUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FATCANRI_ADDPRF' && row.Holder_Type == '03')
                                IsTHFATCANRI_ADDPRFUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FATCANRI_IDENTPRF' && row.Holder_Type == '03')
                                IsTHFATCANRI_IDENTPRFUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FATCANRI_PASSPORT' && row.Holder_Type == '03')
                                IsTHFATCANRI_PASSPORTUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FORMFATCANRI_VISA_WP15GH' && row.Holder_Type == '03')
                                IsTHFATCANRI_VISA_WPUploaded = true;
                            if (row.Doc_Type.toUpperCase() == 'FATCA_PIO_OCR' && row.Holder_Type == '03')
                                IsTHFATCA_PIO_OCRUploaded = true;

                        }
                        else if (BTP_OBJECT.IND_NIND == 'HUF') {
                            if (row.Doc_Type == 'IDENTPRF' && row.Doc_Sub_Type == 'HUF_PAN')
                                IsHUF_HUF_PAN = true;
                            if (row.Doc_Type == 'IDENTPRF' && row.Doc_Sub_Type == 'KARTHA_PAN')
                                IsHUF_KARTHA_PAN = true;
                            if (row.Doc_Type == 'ADDPRF' && row.Doc_Sub_Type == 'HUF')
                                IsHUF = true;
                            if (row.Doc_Type == 'ADDPRF' && row.Doc_Sub_Type == 'KARTHA')
                                IsHUF_KARTHA = true;
                            if (row.Doc_Type == 'BANK' && row.Doc_Sub_Type == 'CANCEL_CHEQUE')
                                IsHUF_CANCEL_CHEQUE = true;
                        }
                    });
                }

                $('#preloader').hide();
            }, null, true, false, false, ErrorFunction);
        }
        if (!IsFormUploaded && BTP_OBJECT.appl_dec_type == 'PHYSICAL')
            err_msg += "<p>Please Upload Application Form..!</p>";

        //individual validations
        if (BTP_OBJECT.IND_NIND == 'IND') {

            if (!IsFHIPUploaded)
                err_msg += "<p>Please Upload Investor's Identity Proof..!</p>";
            if (!IsFHAPUploaded)
                err_msg += "<p>Please Upload Investor's Address Proof..!</p>";
            if (!IsFHPhotoUploaded)
                err_msg += "<p>Please Upload Investor's Photo..!</p>";

            if ($('#btnsldFatca').hasClass('active') || $('#btnsldGreen').hasClass('active')) {
                if (!IsFHFATCANRI_ADDPRFUploaded)
                    err_msg += "<p>Please upload investor's FATCA address proof !</p>";
                if (!IsFHFATCANRI_IDENTPRFUploaded)
                    err_msg += "<p>Please upload investor's FATCA identity proof !</p>";
                if (!IsFHFATCANRI_PASSPORTUploaded)
                    err_msg += "<p>Please upload investor's Passport..!</p>";
                if (!IsFHFATCANRI_VISA_WPUploaded && !IsFHFATCA_PIO_OCRUploaded)
                    err_msg += "<p>Please upload investor's FATCA visa and work permit or FATCA proof of indian origin !</p>";
            }

            if ($('#chkTDFFlag').prop('checked') && !IsFHFORM15GHUploaded)
                err_msg += "<p>Please Upload Form15G/H..!</p>";

            //second holder
            if ($('#chkSHApplicable').prop('checked')) {
                if (!IsSHIPUploaded)
                    err_msg += "<p>Please Upload Second Holder's Identity Proof..!</p>";
                if (!IsSHAPUploaded)
                    err_msg += "<p>Please Upload Second Holder's Address Proof..!</p>";
                if (!IsSHPhotoUploaded)
                    err_msg += "<p>Please upload second holder's photo..!</p>";

                if ($('#btnSHsldFatca').hasClass('active') || $('#btnSHsldGreen').hasClass('active')) {
                    if (!IsSHFATCANRI_ADDPRFUploaded)
                        err_msg += "<p>Please upload second holder's FATCA address proof !</p>";
                    if (!IsSHFATCANRI_IDENTPRFUploaded)
                        err_msg += "<p>Please upload second holder's FATCA identity proof !</p>";
                    if (!IsSHFATCANRI_PASSPORTUploaded)
                        err_msg += "<p>Please upload second holder's Passport..!</p>";
                    if (!IsSHFATCANRI_VISA_WPUploaded && !IsSHFATCA_PIO_OCRUploaded)
                        err_msg += "<p>Please upload second holder's FATCA visa and work permit or FATCA proof of indian origin !</p>";
                }

            }

            //third holder           
            if ($('#chkTHApplicable').prop('checked'))// && BTP_OBJECT.TH_DATA_SOURCE != 'CKYC')
            {
                if (!IsTHIPUploaded)
                    err_msg += "<p>Please Upload Third Holder's Identity Proof..!</p>";
                if (!IsTHAPUploaded)
                    err_msg += "<p>Please Upload Third Holder's Address Proof..!</p>";
                if (!IsTHPhotoUploaded)
                    err_msg += "<p>Please upload third holder's photo..!</p>";

                if ($('#btnTHsldFatca').hasClass('active') || $('#btnTHsldGreen').hasClass('active')) {
                    if (!IsTHFATCANRI_ADDPRFUploaded)
                        err_msg += "<p>Please upload third holder's FATCA address proof !</p>";
                    if (!IsTHFATCANRI_IDENTPRFUploaded)
                        err_msg += "<p>Please upload third holder's FATCA identity proof !</p>";
                    if (!IsTHFATCANRI_PASSPORTUploaded)
                        err_msg += "<p>Please upload third holder's Passport..!</p>";
                    if (!IsTHFATCANRI_VISA_WPUploaded && !IsTHFATCA_PIO_OCRUploaded)
                        err_msg += "<p>Please upload third holder's FATCA visa and work permit or FATCA proof of indian origin !</p>";
                }

            }
        }
        else if (BTP_OBJECT.IND_NIND == 'HUF') {
            //additional purchase
            if (!$.isEmptyObject($('#lblFolioNumber').text())) {
            }
            //fresh purchase
            else {
                if (!IsHUF_HUF_PAN)
                    err_msg += "<p>Please Upload HUF Identity Proof..!</p>";

                if (!IsHUF_KARTHA_PAN)
                    err_msg += "<p>Please Upload KARTHA Identity Proof..!</p>";

                if (!IsHUF)
                    err_msg += "<p>Please Upload HUF Address Proof..!</p>";

                if (!IsHUF_KARTHA)
                    err_msg += "<p>Please Upload KARTHA Address Proof..!</p>";

                if (!IsHUF_CANCEL_CHEQUE)
                    err_msg += "<p>Please Upload Personalized canceled cheque of HUF..!</p>";
            }


        }

    } catch (e) {
        err_msg = 'Something went wrong..!';
        fnException(e);
    }
    return err_msg;
}

//step7 submit
const SubmitStep7 = function () {
    let err_msg = '';
    let exception = '';
    try {
        //step7 validations
        err_msg = isValidStep7();
        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, 'error');
            return false;
        }

        /////ovd forgery check
        //$('#tblOVDList tbody tr').each(function (i, row)
        //{
        //    let refNo = $($(this).find('td')[4]).find('input');
        //    if (!$.isEmptyObject(refNo) && refNo.length > 0 && !$.isEmptyObject(refNo.val()))
        //        err_msg += OVD_Ref_Verification(refNo);
        //});
        //if (!$.isEmptyObject(err_msg))
        //{
        //    return false;
        //}

        //step save
        let investorDetailSaveStruct = {};
        investorDetailSaveStruct = getStep7Data();
        investorDetailSaveStruct.Investor_Other_Dtl = getStep2Data();


        if (!$('#tblOVDList tbody').hasClass('clear_tbody')) {
            ExtendedAjaxCall('RenewInvestorDetailsSave/SubmitStep7', investorDetailSaveStruct, 'POST', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.Status == 1)
                        BTP_OBJECT.OVDSave = true;
                    else if (!$.isEmptyObject(result) && !$.isEmptyObject(result.Msg && result.Status == 0))
                        err_msg += '<p>' + result[0].Msg + '</p>';
                    else
                        err_msg += '<p>Something went wrong..!</p>';

                    $('#preloader').hide();

                } catch (e) {
                    err_msg = 'Something went wrong..!';
                    fnException(e); return false;
                }
            }, null, true, false, false, ErrorFunction);
        }
        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, 'error');
            return false;
        }

    } catch (e) {
        fnException(e); return false;
    }



    return true;

}

//step7 validations
const isValidStep7 = function () {
    let err_msg = '';

    try {
        //Document Uploaded
        let msgDocUpload = IsDocUploaded();
        if (!$.isEmptyObject(msgDocUpload))
            err_msg += msgDocUpload;

        //OVD
        $('#tblOVDList tbody tr').each(function (i, row) {
            let $row = $(this);
            let refNo = $($row.find('td')[4]).find('input');
            let expDate = $($row.find('td')[5]).find('input');
            if (!$.isEmptyObject(refNo) && refNo.length > 0
                && $.isEmptyObject(refNo.val())) {

                err_msg += "<p>" + $row.find('td')[1].innerHTML + "'s " + $row.find('td')[3].innerHTML + " Ref. No. is required..!</p>";
                $($row.find('td')[4]).find('input').addClass('InputBorderRed');
            }
            if (!$.isEmptyObject(refNo) && refNo.length > 0
                && !$.isEmptyObject(refNo.val())
                && refNo.hasClass('AADHARCARD')
                && refNo.val().length != 4) {

                err_msg += "<p>Please enter last 4 digit of aadhaar card number..!</p>";
                $($row.find('td')[4]).find('input').addClass('InputBorderRed');
            }
            else if (!$.isEmptyObject(refNo) && refNo.hasClass('OVDPAN')) {
                if (!IsValidPAN($($row.find('td')[4]).find('input').val())) {
                    err_msg += "<p>Please enter valid PAN number..!</p>";
                    $($row.find('td')[4]).find('input').addClass('InputBorderRed');
                }
            }
            else
                $($row.find('td')[4]).find('input').removeClass('InputBorderRed');

            if (!$.isEmptyObject(expDate) && expDate.length > 0 && $.isEmptyObject(expDate.val())) {
                err_msg += "<p>" + $row.find('td')[1].innerText + "'s " + $row.find('td')[3].innerText + " Expiry Date is required..!</p>";
                $($row.find('td')[5]).find('input').parent().addClass('InputBorderRed');
            }
            else
                $($row.find('td')[5]).find('input').parent().removeClass('InputBorderRed');
        });

        if (BTP_OBJECT.IND_NIND == 'HUF' && $.isEmptyObject($('#lblFolioNumber').text()) && $('#tblCoparceners > tbody > tr').length == 0) {
            err_msg += 'Member details are required..!'
        }

    } catch (e) {
        err_msg = 'Something went wrong..!';
        fnException(e);
    }
    return err_msg;
}

//get step7 data for save 
const getStep7Data = function () {
    let InvestorDetailSaveStruct = {};
    let OVDDtls = [];
    let MemberDtls = [];
    try {

        $('#tblOVDList > tbody tr').each(function (i, tr) {
            let $this = $(this);
            let doc_id = tr.children[0].innerHTML
            let ref_No = "";
            let exp_No = null;
            if (!$.isEmptyObject($($(this).find('td')[4]).find('input').val()))
                ref_No = $($(this).find('td')[4]).find('input').val();
            if (!$.isEmptyObject($($(this).find('td')[5]).find('input').val()))
                exp_No = $($(this).find('td')[5]).find('input').val();

            let OVDBO = {
                Doc_ID: doc_id,
                Doc_RefNO: ref_No,
                Doc_ExpDate: exp_No
            }
            OVDDtls.push(OVDBO);
        });

        InvestorDetailSaveStruct.OVDDtls = OVDDtls;

        if (BTP_OBJECT.IND_NIND == 'HUF' && $('#tblCoparceners > tbody > tr').length > 0) {
            $('#tblCoparceners > tbody tr').each(function (i, tr) {
                let id = tr.children[0].innerHTML
                let full_name = tr.children[1].innerHTML
                let relation = tr.children[2].innerHTML
                let dob = tr.children[3].innerHTML
                let mobile = tr.children[4].innerHTML

                let MemberBO = {
                    ID: id,
                    Full_Name: full_name,
                    Relation: relation,
                    DOB: dob,
                    Mobile: mobile
                }
                MemberDtls.push(MemberBO);
            });

            InvestorDetailSaveStruct.MemberDtls = MemberDtls;

        }


    } catch (e) {
        fnException(e); return null;
    }
    return InvestorDetailSaveStruct;
}

//reset step7
const Reset_step7 = function () {
    $('.errorbox').text('').hide();
    $('#ddlDocHolderType,#ddlDocType').val('select').change();
    $('#flvApplicationFormUpload,#flvDocUpload').val('');
}

const SaveMember = function () {
    try {
        let isError = false;
        let txtMemberName = $('#txtMemberName');
        let txtMemberRelation = $('#txtMemberRelation');
        let txtMemberDOB = $('#txtMemberDOB');
        let txtMemberMobile = $('#txtMemberMobile');

        $('#txtMemberName').next().text('').hide();
        $('#txtMemberRelation').next().text('').hide();
        $('#txtMemberDOB').parent().next().text('').hide();
        $('#txtMemberMobile').next().text('').hide();

        if ($.isEmptyObject(txtMemberName.val())) {
            isError = true;
            $('#txtMemberName').next().text('Name is required').show();
        }

        if ($.isEmptyObject(txtMemberRelation.val())) {
            isError = true;
            $('#txtMemberRelation').next().text('Relation is required').show();
        }

        if ($.isEmptyObject(txtMemberDOB.val())) {
            isError = true;
            $('#txtMemberDOB').parent().next().text('DOB is required').show();
        }

        if ($.isEmptyObject(txtMemberMobile.val())) {
            isError = true;
            $('#txtMemberMobile').next().text('Mobile is required').show();
        }

        if (!isError) {
            let html = '<tr>';
            html += '<td>' + ($('#tblCoparceners > tbody > tr').length + 1) + '</span></td>';
            html += '<td>' + txtMemberName.val() + '</td>';
            html += '<td>' + txtMemberRelation.val() + '</td>';
            html += '<td>' + txtMemberDOB.val() + '</td>';
            html += '<td>' + txtMemberMobile.val() + '</td>';
            html += '<td style="text-align:center;"><button id="btnDeleteMember" type="button" class="comnBtn2" style="margin:0;" onclick="DeleteMember(this)">Delete</button></td>';
            html += '</tr>';

            $('#tblCoparceners').append(html);
            $('#Model_HUF_Add_Member').modal('hide');
            txtMemberName.val('');
            txtMemberRelation.val('');
            txtMemberDOB.val('');
            txtMemberMobile.val('');
        }

    } catch (e) {
        fnException(e);
    }
}

const DeleteMember = function (btn) {
    try {
        $(btn).closest('tr').remove();
    } catch (e) {
        fnException(e);
    }
}

const BindAddProof_DatePicker = function (t) {
    $(t).datetextentry({
        min_date: function () { return this.get_today(); },
        min_date_message: 'Date cannot be past date',
    });

    $('.jq-dte-day, .jq-dte-month, .jq-dte-year').css('width', '30%');
}

$('#txtMemberDOB').datetextentry({
    max_date: function () { return this.get_today(); },
    max_date_message: 'Date cannot be future date',
});

//step7 click
$('#IdBtnTabSwit07').click(function () {
    try {
        $('#lblMemberPAN').text($('#txtInvPan').val());
        let name = $('#txtInvFirstName').val().trim() + ' ' + $('#txtInvMiddleName').val().trim() + ' ' + $('#txtInvLastName').val().trim();
        $('#txtHUFName').text(name);
    } catch (e) {
        fnException(e);
    }
});

//holder type change
$('#ddlDocHolderType').change(function () {
    try {
        let $HolderType = $(this);
        let ddlDepositorsStatus = $('#ddlDepositorsStatus').val();
        $('#flvDocUpload').val('');

        if (!$.isEmptyObject(ddlDepositorsStatus)) {
            let Appl_No = '';
            if ($HolderType.val() == '01' && BTP_OBJECT.FH_DATA_SOURCE == 'CKYC') {
                Appl_No = $('#lblApplicationNumber').text();
            }
            else if ($HolderType.val() == '02' && BTP_OBJECT.SH_DATA_SOURCE == 'CKYC') {
                Appl_No = $('#lblApplicationNumber').text();
            }
            else if ($HolderType.val() == '03' && BTP_OBJECT.TH_DATA_SOURCE == 'CKYC') {
                Appl_No = $('#lblApplicationNumber').text();
            }
            BindDDLExtendedAjaxCall('#ddlDocType', 'DocumentUpload/Get_DocType_MstAsync?_HolderType=' + $HolderType.val() + '&DepositorStatus=' + ddlDepositorsStatus + '&Appl_No=' + Appl_No, null, 'GET', null, null, true, false, false, ErrorFunction);

            $('#ddlDocType option[value="ADDITIONAL|INTRNL_1"]').hide();
            $('#ddlDocType option[value="ADDITIONAL|INTRNL_2"]').hide();
        }
    }
    catch (e) {
        fnException(e); return false;
    }
});

//doc/sub doc type change
$('#ddlDocType').change(function () {
    try {
        $('#flvDocUpload').val('');
        if (this.value == 'select')
            return false;

        ExtendedAjaxCall('DocumentUpload/Get_Ismultiple?_DocSubType=' + $(this).val(), null, 'GET', function (result) {
            try {

                if (result != null && result[0].IsMultiple) {
                    $('#flvDocUpload').prop("multiple", true);
                }
                else {
                    $('#flvDocUpload').prop("multiple", false);

                }
            } catch (e) {
                fnException(e);
            }

            $('#preloader').hide();
        }, null, true, true, false, ErrorFunction);
    }
    catch (e) {
        fnException(e); return false;
    }
});

//Application form file upload control
$('#flvApplicationFormUpload').on('change', function (e) {
    try {
        let fileNameSplit = $(this)[0].files[0].name.split('.');
        if (!$.isEmptyObject(fileNameSplit)) {
            let isValidFileName = fileNameSplit.length != 2 ? false : true;
            if (isValidFileName) {
                let type = $(this)[0].files[0].type;
                let ext = $(this)[0].files[0].name.split('.')[1];

                if ($.inArray(type, ['image/jpg', 'image/jpeg', 'image/tiff', 'image/tif', 'application/pdf']) == -1
                    || $.inArray(ext.toLowerCase(), ['jpg', 'jpeg', 'pdf', 'tiff', 'tif']) == -1) {

                    $('#flvApplicationFormUpload').val('');
                    BtpMessagePopup('<p>File should be jpg, jpeg, pdf, tiff, tif</p>', 'error');

                }
                else if (FileSizeValidation($(this).get(0).files)) {
                    $('#flvApplicationFormUpload').text('');
                    let filename = '';
                    if (!$.isEmptyObject($(this)[0].files)) {
                        filename = $(this)[0].files['0'].name;
                    }
                }
            }
            else {
                $('#flvApplicationFormUpload').val('');
                BtpMessagePopup('<p>Incorrect file name, Please upload valid file</p>', 'error');
            }
        }
    }
    catch (e) {
        fnException(e); return false;
    }
});

//KYC files upload control
$('#flvDocUpload').on('change', function (e) {
    try {
        $.each(this.files, function (i, file) {
            let err_msg = ''
            let ext = file.name.split('.')[1];

            if (file.name.split('.').length == 2) {

                if ($.inArray(file.type.toLowerCase(), ['image/jpg', 'image/jpeg', 'application/pdf', 'image/tiff', 'image/tif']) == -1
                    || $.inArray(ext.toLowerCase(), ['jpg', 'jpeg', 'pdf', 'tiff', 'tif']) == -1) {

                    $('#flvDocUpload').val('');
                    BtpMessagePopup('<p>File should be jpg, jpeg, pdf, tiff, tif</p>', 'error');
                    return false;
                }
                else if (!FileSizeValidation(file)) {
                    $('#flvDocUpload').val('');
                    return false;
                }
            }
            else {
                $('#flvDocUpload').val('');
                BtpMessagePopup('<p>Incorrect file name, Please upload valid file</p>', 'error');
                return false;
            }

        });
    }
    catch (e) {
        fnException(e); return false;
    }
});

//Application form upload button
$('#btnUploadApplicationForm').click(function () {
    this.disabled = true;

    try {
        $('#msgFormUpload').text('');

        if (ValidateFileUploadApplicationForm()) {
            let App_No = $('#lblApplicationNumber').text();
            let flvUpload = $('#flvApplicationFormUpload').get(0).files;
            let FDRNo = $('#lblExistingFDRNumber').text();
            let FolioNo = $('#lblFolioNumber').text();
            let LastInvDate = $('#lblLastInvestmentDate').text();

            let _DocUpload = new FormData();
            _DocUpload.append("App_No", App_No)
            _DocUpload.append("Doc_File", flvUpload[0])
            _DocUpload.append("DocName", "");
            _DocUpload.append("DocPath", "");
            _DocUpload.append("formCode", "");
            _DocUpload.append("Session_ID", "");
            _DocUpload.append("CreatedBy", "");
            _DocUpload.append("CreatedByUName", "");
            _DocUpload.append("CreatedIP", "");
            _DocUpload.append("State", State);
            _DocUpload.append("Status", Status);
            _DocUpload.append("FolioNo", FolioNo);
            _DocUpload.append("FDRNo", FDRNo);
            _DocUpload.append("LastInvDate", LastInvDate);
            _DocUpload.append("Source", "CPTP_UNI_RW");

            //document upload request log
            DocumentUploadLog('Request', $('#ddlDepositorsStatus').val(), App_No, '01', 'APPFRM', 'APPLICATIONFRM', FDRNo, FolioNo);

            $.ajax({
                url: WA_FD_BTP + 'DocumentUpload/Save_ApplicationForm',
                type: "POST",
                data: _DocUpload,
                async: true,
                contentType: false,
                processData: false,
                beforeSend: OnBeforeSendCall,
                success: function (result) {
                    if (!$.isEmptyObject(result) && result.validResponse)
                        $('#msgFormUpload').hide().text(result.msg).fadeIn('slow').delay(5000).hide(1);
                    else if (!$.isEmptyObject(result) && !result.validResponse) {
                        var htmlMsg = '<p>' + result.msg + '</p>';
                        BtpMessagePopup(htmlMsg, 'error');
                        $('#flvApplicationFormUpload').focus();
                    }
                    else {
                        BtpMessagePopup('<p>Something went wrong, Please upload again..!</p>', 'error');
                        $('#flvApplicationFormUpload').focus();
                    }

                    $('#flvApplicationFormUpload').val('');
                    $('#preloader').hide();
                    //refresh ovd details
                    BindOVD(App_No);
                    //document upload response log
                    DocumentUploadLog('Response', $('#ddlDepositorsStatus').val(), App_No, '01', 'APPFRM', 'APPLICATIONFRM', FDRNo, FolioNo);
                },
                error: ErrorFunction,
                complete: null
            });

        }

    } catch (e) {
        this.disabled = false;
        fnException(e); return false;
    }
    this.disabled = false;
});

//KYC files upload button
$('#btnUpload').click(function () {
    this.disabled = true;

    try {
        if (isValidateFileUploadData()) {
            let err_msg = ''

            $('#msgDocUpload').text('');
            let Depositor_Status_Code = $('#ddlDepositorsStatus').val();
            let App_No = $('#lblApplicationNumber').text();
            let HolderType = $('#ddlDocHolderType').val()
            let Doc_Type_SubType = $('#ddlDocType').val()
            let HolderTypeText = $('#ddlDocHolderType option:selected').text().replace(/ /g, '');
            let Doc_Type_SubType_Text = $('#ddlDocType option:selected').text().replace(/ /g, '').replace('-', '_');
            let FDRNo = $('#lblExistingFDRNumber').text();
            let FolioNo = $('#lblFolioNumber').text();
            let LastInvDate = $('#lblLastInvestmentDate').text();

            //OVD classification--------------------------------------------------------------------------------------------
            //$.each($('#flvDocUpload')[0].files, function (i, file)
            //{
            //    let ext = file.name.split('.')[1];

            //    //OVD Classification
            //    if ($.inArray(file.type.toLowerCase(), ['image/jpg', 'image/jpeg', 'application/pdf']) != -1
            //        && $.inArray(ext.toLowerCase(), ['jpg', 'jpeg', 'pdf']) != -1)
            //    {

            //        let objOVDBO = new FormData();
            //        if (!$.isEmptyObject(HolderType) && HolderType == '01')
            //        {
            //            objOVDBO.append("OVD_HolderFirstName", $('#txtInvFirstName').val().trim());
            //            objOVDBO.append("OVD_HolderMiddleName", $('#txtInvMiddleName').val().trim());
            //            objOVDBO.append("OVD_HolderLastName", $('#txtInvLastName').val().trim());
            //        }
            //        else if (!$.isEmptyObject(HolderType) && HolderType == '02')
            //        {
            //            objOVDBO.append("OVD_HolderFirstName", $('#DV_SH #txtFName').val().trim());
            //            objOVDBO.append("OVD_HolderMiddleName", $('#DV_SH #txtMName').val().trim());
            //            objOVDBO.append("OVD_HolderLastName", $('#DV_SH #txtLName').val().trim());
            //        }
            //        else if (!$.isEmptyObject(HolderType) && HolderType == '03')
            //        {
            //            objOVDBO.append("OVD_HolderFirstName", $('#DV_TH #txtFName').val().trim());
            //            objOVDBO.append("OVD_HolderMiddleName", $('#DV_TH #txtMName').val().trim());
            //            objOVDBO.append("OVD_HolderLastName", $('#DV_TH #txtLName').val().trim());
            //        }
            //        objOVDBO.append("OVD_FrontImageFileExtension", ext);
            //        objOVDBO.append("Appl_No", App_No);
            //        objOVDBO.append("OVD_Task", 'IC');
            //        objOVDBO.append("Source_Type", 'CPTP_UNI');
            //        objOVDBO.append("Source_Sub_Type", 'CPTP_UNI');
            //        objOVDBO.append("Holder_Type", HolderType);
            //        objOVDBO.append("File", file);

            //        err_msg += OVD_Classification(objOVDBO);
            //    }
            //});

            //if (!$.isEmptyObject(err_msg))
            //{
            //    this.disabled = false;
            //    BtpMessagePopup(err_msg, 'error');
            //    return false;
            //}
            //End OVD Classification-----------------------------------------------------------------------------------

            $.each($('#flvDocUpload')[0].files, function (i, file) {
                let ext = file.name.split('.')[1];

                let _DocUpload = new FormData();
                _DocUpload.append("Depositor_Status_Code", Depositor_Status_Code);
                _DocUpload.append("App_No", App_No);
                _DocUpload.append("KYCDocValue", "");
                _DocUpload.append("formCode", "");
                _DocUpload.append("Session_ID", "");
                _DocUpload.append("CreatedBy", "");
                _DocUpload.append("CreatedByUName", "");
                _DocUpload.append("CreatedIP", "");
                _DocUpload.append("HolderType", HolderType);
                _DocUpload.append("DocType", "");
                _DocUpload.append("DocSubType", "");
                _DocUpload.append("Doc_Type_SubType", Doc_Type_SubType);
                _DocUpload.append("Doc_File", file)
                _DocUpload.append("DocName", "");
                _DocUpload.append("DocPath", "");
                _DocUpload.append("HolderTypeText", HolderTypeText);
                _DocUpload.append("Doc_Type_SubType_Text", Doc_Type_SubType_Text);
                _DocUpload.append("State", State);
                _DocUpload.append("Status", Status);
                _DocUpload.append("FolioNo", FolioNo);
                _DocUpload.append("FDRNo", FDRNo);
                _DocUpload.append("LastInvDate", LastInvDate);
                _DocUpload.append("DocSequenceNo", (i + 1));
                _DocUpload.append("Source", "CPTP_UNI_RW");

                //document upload Request log
                DocumentUploadLog('Request', Depositor_Status_Code, App_No, HolderType, Doc_Type_SubType.split('|')[0], Doc_Type_SubType.split('|')[1], FDRNo, FolioNo);

                $.ajax({
                    url: WA_FD_BTP + 'DocumentUpload/Save_KYCDocs',
                    type: "POST",
                    data: _DocUpload,
                    async: true,
                    contentType: false,
                    processData: false,
                    beforeSend: OnBeforeSendCall,
                    success: function (result) {
                        if (!$.isEmptyObject(result) && result.validResponse)
                            $('#msgDocUpload').show().text(result.msg).fadeIn('slow').delay(20000).hide(1);
                        else if (!$.isEmptyObject(result) && !result.validResponse) {
                            BtpMessagePopup(result.msg, 'error');
                            $('#flvDocUpload').focus();
                        }
                        else {
                            BtpMessagePopup('<p>Something went wrong, Please try again..!</p>', 'error');
                            $('#flvDocUpload').focus();
                        }

                        //Hide Preloader
                        if ($('#flvDocUpload')[0].files.length == (i + 1)) {
                            BindOVD(App_No);

                            $('#btnUpload').prop('disabled', false);
                            $('#preloader').hide();
                        }

                        $('#flvDocUpload').val('');

                        //document upload Request log
                        DocumentUploadLog('Request', Depositor_Status_Code, App_No, HolderType, Doc_Type_SubType.split('|')[0], Doc_Type_SubType.split('|')[1], FDRNo, FolioNo);
                    },
                    error: ErrorFunction,
                    complete: null
                });
            });


        }

        this.disabled = false;

    } catch (e) {
        this.disabled = false;
        fnException(e); return false;
    }

});

$('#btnCancel07').bind('click', Reset_step7);


$('#btnHUFAddMember').on('click', function () {

    $('#txtMemberName').val();
    $('#txtMemberRelation').val();
    $('#txtMemberDOB').val();
    $('#txtMemberMobile').val();

    $('#txtMemberName').next().text('').hide();
    $('#txtMemberRelation').next().text('').hide();
    $('#txtMemberDOB').parent().next().text('').hide();
    $('#txtMemberMobile').next().text('').hide();

    $('#Model_HUF_Add_Member').modal('show');
});

$('#txtMemberName,#txtMemberRelation,#txtMemberMobile')
    .keyup(function () {
        if (!$.isEmptyObject(this.value))
            $(this).next().text('').hide();

    })
    .change(function () {
        if (!$.isEmptyObject(this.value))
            $(this).next().text('').hide();

    });

$('#Model_HUF_Add_Member .jq-dte-day,#Model_HUF_Add_Member .jq-dte-month,#Model_HUF_Add_Member .jq-dte-year')
    .keyup(function () {
        if (!$.isEmptyObject($('#txtMemberDOB').val()))
            $('#txtMemberDOB').parent().next().text('').hide();
    })
    .change(function () {
        if (!$.isEmptyObject($('#txtMemberDOB').val()))
            $('#txtMemberDOB').parent().next().text('').hide();
    });

$('#IdBtnTabSwit08').click(function () {
    GET_APPL_DTLS($('#lblApplicationNumber').text());
});

function GET_APPL_DTLS(Appl_No) {
    try {

        ExtendedAjaxCall('ApplicationRenewal/GET_APPL_DTLS/' + Appl_No, null, 'GET', function (result) {
            $('.CustmTblTd2lbl, .CustmTblTd3lbl').text('');
            $('#tblInvestmentDtls tbody').html('');

            if (!$.isEmptyObject(result)) {
                $('#lblApplicationType').text(result.Table[0].ApplicationDeclarationType);
                $('#lblDepositorCategory').text(result.Table[0].DepositorStatus);
                $('#lblInvestorName').text(result.Table[0].InvestorFullName);
                $('#lblDOB').text(result.Table[0].Display_DOB);
                $('#lblPAN').text(result.Table[0].PAN);
                $('#lblModeOfPayment').text(result.Table[0].ModeOfPayment);
                $('#lblAmount').text(result.Table[0].Amount);
                $('#lblMobileNumber').text(result.Table[0].Mobile);
                $('#lblEmailID').text(result.Table[0].Email);

                $('#lblFolioNumber').text(result.Table[0].Folio_No);
                $('#lblExistingFDRNumber').text(result.Table[0].Existing_FDR_No);

                if (!$.isEmptyObject(result.Table2) && result.Table2.length > 0) {
                    var html = '';
                    html += '<tr>';
                    html += '<td>'
                    html += '<label class="lblText" id="lblTranID">' + result.Table2[0].Appl_No + '</label>'
                    html += '</td>'
                    html += '<td>'
                    html += ' '
                    html += '<label class="lblText" id="lblAmount">' + result.Table2[0].Amount + '</label>'
                    html += '</td>'
                    html += '<td>'
                    html += '<label class="lblText" id="lblCategory">' + result.Table2[0].Category + '</label>'
                    html += '</td>'
                    html += '<td>'
                    html += '<label class="lblText" id="lblScheme">' + result.Table2[0].Scheme + '</label>'
                    html += '</td>'
                    html += '<td>'
                    html += '<label class="lblText" id="lblInt_Freq">' + result.Table2[0].Int_Freq + '</label>'
                    html += '</td>'
                    html += '<td>'
                    html += '<label class="lblText" id="lblIntRate">' + result.Table2[0].Int_Rate + '</label>'
                    html += '</td>'
                    html += '<td>'
                    html += '<label class="lblText" id="lblTenure">' + result.Table2[0].Tenure + '</label>'
                    html += '</td>'
                    html += '</tr>'

                    $('#tblInvestmentDtls > tbody').html(html)
                }

                if (!$.isEmptyObject(result.Table4) && result.Table4.length > 0) {
                    $.each(result.Table4, function (i, row) {
                        if (row.Holder_Type == '01') {
                            $('#lblHdr1stHolderName').text(row.Kyc_FullName);
                            $('#lbl1stHolderName').text(row.Kyc_FullName);
                            $('#lbl1stHolderSalutation').text(row.Kyc_NamePrefix);
                            $('#lbl1stHolderFirstName').text(row.Kyc_FirstName);
                            $('#lbl1stHolderSecoundName').text(row.Kyc_MiddleName);
                            $('#lbl1stHolderThirdName').text(row.Kyc_LastName);

                            $('#lbl1stGender').text(row.Kyc_Gender);
                            $('#lbl1stGenderCode').text(row.Kyc_Gender);
                            $('#lbl1stDOB').text(row.Display_Kyc_DOB);
                            $('#lbl1stMaritalStatus').text(row.Kyc_MaritalStatus_Desc);
                            $('#lbl1stMaritalStatusCode').text(row.Kyc_MaritalStatus);
                            $('#lbl1stPan').text(row.Kyc_PAN);
                            $('#lblPAN').text(row.Kyc_PAN);
                            $('#lbl1stOccupation').text(row.Kyc_Occupation_Desc);
                            $('#lbl1stOccupationCode').text(row.Kyc_Occupation_Code);

                            $('#lbl1stFatherFullName').text(row.Kyc_FatherFullName);
                            $('#lbl1stHolderFatherSalutation').text(row.Kyc_FatherNamePrefix);
                            $('#lbl1stHolderFatherFirstName').text(row.Kyc_FatherFirstName);
                            $('#lbl1stHolderFatherSecoundName').text(row.Kyc_FatherMiddleName);
                            $('#lbl1stHolderFatherThirdName').text(row.Kyc_FatherLastName);

                            $('#lbl1stMotherFullName').text(row.Kyc_MotherFullName);
                            $('#lbl1stHolderMotherSalutation').text(row.Kyc_MotherNamePrefix);
                            $('#lbl1stHolderMotherFirstName').text(row.Kyc_MotherFirstName);
                            $('#lbl1stHolderMotherSecoundName').text(row.Kyc_MotherMiddleName);
                            $('#lbl1stHolderMotherThirdName').text(row.Kyc_MotherLastName);

                            $('#lbl1stSpouseFullName').text(row.Kyc_SpouseFullName);
                            $('#lbl1stHolderSpouseSalutation').text(row.Kyc_SpouseNamePrefix);
                            $('#lbl1stHolderSpouseFirstName').text(row.Kyc_SpouseFirstName);
                            $('#lbl1stHolderSpouseSecoundName').text(row.Kyc_SpouseMiddleName);
                            $('#lbl1stHolderSpouseThirdName').text(row.Kyc_SpouseLastName);

                            $('#lbl1stGuardianFullName').text(row.Kyc_GuardianFullName);
                            $('#lbl1stHolderGuardianSalutation').text(row.Kyc_GuardianNamePrefix);
                            $('#lbl1stHolderGuardianFirstName').text(row.Kyc_GuardianFirstName);
                            $('#lbl1stHolderGuardianSecoundName').text(row.Kyc_GuardianMiddleName);
                            $('#lbl1stHolderGuardianThirdName').text(row.Kyc_GuardianLastName);
                            $('#lbl1stGuardianPAN').text(row.Kyc_Guardian_PAN);

                            $('#lbl1stAddress1').text(row.PER_Address1);
                            $('#lbl1stAddress2').text(row.PER_Address2);
                            $('#lbl1stAddress3').text(row.PER_Address3);
                            $('#lbl1stCountryDec').text(row.PER_AddCountry_Desc);
                            $('#lbl1stCountryCode').text(row.PER_AddCountry_Code);
                            $('#lbl1stState').text(row.PER_AddState_Desc);
                            $('#lbl1stDistrict').text(row.PER_Address_District_Desc);
                            $('#lbl1stCity').text(row.PER_Address_City_Desc);
                            $('#lbl1stPin').text(row.PER_AddPin);

                            $('#lbl1stCKYCNumber').text(row.Kyc_Number);
                            $('#lbl1stTelNo').text(row.PER_ResTelNumber);
                            $('#lbl1stMobieNumber').text(row.PER_MobileNumber);
                            $('#lbl1stEmail').text(row.PER_EmailAdd);

                            //mail
                            $('#lbl1stMAddress1').text(row.MAIL_Address1);
                            $('#lbl1stMAddress2').text(row.MAIL_Address2);
                            $('#lbl1stMAddress3').text(row.MAIL_Address3);
                            $('#lbl1stMCountryDec').text(row.MAIL_AddCountry_Desc);
                            $('#lbl1stMCountryCode').text(row.MAIL_AddCountry_Code);
                            $('#lbl1stMState').text(row.MAIL_AddState_Desc);
                            $('#lbl1stMDistrict').text(row.MAIL_Address_District_Desc);
                            $('#lbl1stMCity').text(row.MAIL_Address_City_Desc);
                            $('#lbl1stMPin').text(row.MAIL_AddPin);

                            $('#dv1stHolder').show();
                        }

                        if (row.Holder_Type == '02' && $('#chkSHApplicable').prop('checked')) {
                            $('#lblHdrHldrName').text(row.Kyc_FullName);
                            $('#lblHdr2ndHolderName').text(row.Kyc_FullName);
                            $('#lbl2ndHolderName').text(row.Kyc_FullName);
                            $('#lbl2ndHolderSalutation').text(row.Kyc_NamePrefix);
                            $('#lbl2ndHolderFirstName').text(row.Kyc_FirstName);
                            $('#lbl2ndHolderSecoundName').text(row.Kyc_MiddleName);
                            $('#lbl2ndHolderThirdName').text(row.Kyc_LastName);

                            $('#lbl2ndGender').text(row.Kyc_Gender);
                            $('#lbl2ndGenderCode').text(row.Kyc_Gender);
                            $('#lbl2ndDOB').text(row.Display_Kyc_DOB);
                            $('#lbl2ndMaritalStatus').text(row.Kyc_MaritalStatus_Desc);
                            $('#lbl2ndMaritalStatusCode').text(row.Kyc_MaritalStatus);
                            $('#lbl2ndPan').text(row.Kyc_PAN);
                            $('#lbl2ndOccupation').text(row.Kyc_Occupation_Desc);
                            $('#lbl2ndOccupationCode').text(row.Kyc_Occupation_Code);

                            $('#lbl2ndFatherFullName').text(row.Kyc_FatherFullName);
                            $('#lbl2ndHolderFatherSalutation').text(row.Kyc_FatherNamePrefix);
                            $('#lbl2ndHolderFatherFirstName').text(row.Kyc_FatherFirstName);
                            $('#lbl2ndHolderFatherSecoundName').text(row.Kyc_FatherMiddleName);
                            $('#lbl2ndHolderFatherThirdName').text(row.Kyc_FatherLastName);

                            $('#lbl2ndMotherFullName').text(row.Kyc_MotherFullName);
                            $('#lbl2ndHolderMotherSalutation').text(row.Kyc_MotherNamePrefix);
                            $('#lbl2ndHolderMotherFirstName').text(row.Kyc_MotherFirstName);
                            $('#lbl2ndHolderMotherSecoundName').text(row.Kyc_MotherMiddleName);
                            $('#lbl2ndHolderMotherThirdName').text(row.Kyc_MotherLastName);

                            $('#lbl2ndSpouseFullName').text(row.Kyc_SpouseFullName);
                            $('#lbl2ndHolderSpouseSalutation').text(row.Kyc_SpouseNamePrefix);
                            $('#lbl2ndHolderSpouseFirstName').text(row.Kyc_SpouseFirstName);
                            $('#lbl2ndHolderSpouseSecoundName').text(row.Kyc_SpouseMiddleName);
                            $('#lbl2ndHolderSpouseThirdName').text(row.Kyc_SpouseLastName);

                            $('#lbl2ndGuardianFullName').text(row.Kyc_GuardianFullName);
                            $('#lbl2ndHolderGuardianSalutation').text(row.Kyc_GuardianNamePrefix);
                            $('#lbl2ndHolderGuardianFirstName').text(row.Kyc_GuardianFirstName);
                            $('#lbl2ndHolderGuardianSecoundName').text(row.Kyc_GuardianMiddleName);
                            $('#lbl2ndHolderGuardianThirdName').text(row.Kyc_GuardianLastName);
                            $('#lbl2ndGuardianPAN').text(row.Kyc_Guardian_PAN);

                            //per
                            $('#lbl2ndAddress1').text(row.PER_Address1);
                            $('#lbl2ndAddress2').text(row.PER_Address2);
                            $('#lbl2ndAddress3').text(row.PER_Address3);
                            $('#lbl2ndCountryDec').text(row.PER_AddCountry_Desc);
                            $('#lbl2ndCountryCode').text(row.PER_AddCountry_Code);
                            $('#lbl2ndState').text(row.PER_AddState_Desc);
                            $('#lbl2ndDistrict').text(row.PER_Address_District_Desc);
                            $('#lbl2ndCity').text(row.PER_Address_City_Desc);
                            $('#lbl2ndPin').text(row.PER_AddPin);

                            $('#lbl2ndCKYCNumber').text(row.Kyc_Number);
                            $('#lbl2ndTelNo').text(row.PER_ResTelNumber);
                            $('#lbl2ndMobieNumber').text(row.PER_MobileNumber);
                            $('#lbl2ndEmail').text(row.PER_EmailAdd);

                            //mail
                            $('#lbl2ndMAddress1').text(row.MAIL_Address1);
                            $('#lbl2ndMAddress2').text(row.MAIL_Address2);
                            $('#lbl2ndMAddress3').text(row.MAIL_Address3);
                            $('#lbl2ndMCountryDec').text(row.MAIL_AddCountry_Desc);
                            $('#lbl2ndMCountryCode').text(row.MAIL_AddCountry_Code);
                            $('#lbl2ndMState').text(row.MAIL_AddState_Desc);
                            $('#lbl2ndMDistrict').text(row.MAIL_Address_District_Desc);
                            $('#lbl2ndMCity').text(row.MAIL_Address_City_Desc);
                            $('#lbl2ndMPin').text(row.MAIL_AddPin);

                            $('.dv2ndHolder').show();
                            $('#dvHolders').show();
                        }

                        if (row.Holder_Type == '03' && $('#chkSHApplicable').prop('checked') && $('#chkTHApplicable').prop('checked')) {
                            $('#lblHdrHldrName').text($('#lblHdrHldrName').text() + ' / ' + row.Kyc_FullName);
                            $('#lblHdr3rdHolderName').text(row.Kyc_FullName);
                            $('#lbl3rdHolderName').text(row.Kyc_FullName);
                            $('#lbl3rdHolderSalutation').text(row.Kyc_NamePrefix);
                            $('#lbl3rdHolderFirstName').text(row.Kyc_FirstName);
                            $('#lbl3rdHolderSecoundName').text(row.Kyc_MiddleName);
                            $('#lbl3rdHolderThirdName').text(row.Kyc_LastName);

                            $('#lbl3rdGender').text(row.Kyc_Gender);
                            $('#lbl3rdGenderCode').text(row.Kyc_Gender);
                            $('#lbl3rdDOB').text(row.Display_Kyc_DOB);
                            $('#lbl3rdMaritalStatus').text(row.Kyc_MaritalStatus_Desc);
                            $('#lbl3rdMaritalStatusCode').text(row.Kyc_MaritalStatus);
                            $('#lbl3rdPan').text(row.Kyc_PAN);
                            $('#lbl3rdOccupation').text(row.Kyc_Occupation_Desc);
                            $('#lbl3rdOccupationCode').text(row.Kyc_Occupation_Code);

                            $('#lbl3rdFatherFullName').text(row.Kyc_FatherFullName);
                            $('#lbl3rdHolderFatherSalutation').text(row.Kyc_FatherNamePrefix);
                            $('#lbl3rdHolderFatherFirstName').text(row.Kyc_FatherFirstName);
                            $('#lbl3rdHolderFatherSecoundName').text(row.Kyc_FatherMiddleName);
                            $('#lbl3rdHolderFatherThirdName').text(row.Kyc_FatherLastName);

                            $('#lbl3rdMotherFullName').text(row.Kyc_MotherFullName);
                            $('#lbl3rdHolderMotherSalutation').text(row.Kyc_MotherNamePrefix);
                            $('#lbl3rdHolderMotherFirstName').text(row.Kyc_MotherFirstName);
                            $('#lbl3rdHolderMotherSecoundName').text(row.Kyc_MotherMiddleName);
                            $('#lbl3rdHolderMotherThirdName').text(row.Kyc_MotherLastName);

                            $('#lbl3rdSpouseFullName').text(row.Kyc_SpouseFullName);
                            $('#lbl3rdHolderSpouseSalutation').text(row.Kyc_SpouseNamePrefix);
                            $('#lbl3rdHolderSpouseFirstName').text(row.Kyc_SpouseFirstName);
                            $('#lbl3rdHolderSpouseSecoundName').text(row.Kyc_SpouseMiddleName);
                            $('#lbl3rdHolderSpouseThirdName').text(row.Kyc_SpouseLastName);

                            $('#lbl3rdGuardianFullName').text(row.Kyc_GuardianFullName);
                            $('#lbl3rdHolderGuardianSalutation').text(row.Kyc_GuardianNamePrefix);
                            $('#lbl3rdHolderGuardianFirstName').text(row.Kyc_GuardianFirstName);
                            $('#lbl3rdHolderGuardianSecoundName').text(row.Kyc_GuardianMiddleName);
                            $('#lbl3rdHolderGuardianThirdName').text(row.Kyc_GuardianLastName);
                            $('#lbl3rdGuardianPAN').text(row.Kyc_Guardian_PAN);

                            $('#lbl3rdAddress1').text(row.PER_Address1);
                            $('#lbl3rdAddress2').text(row.PER_Address2);
                            $('#lbl3rdAddress3').text(row.PER_Address3);
                            $('#lbl3rdCountryDec').text(row.PER_AddCountry_Desc);
                            $('#lbl3rdCountryCode').text(row.PER_AddCountry_Code);
                            $('#lbl3rdState').text(row.PER_AddState_Desc);
                            $('#lbl3rdDistrict').text(row.PER_Address_District_Desc);
                            $('#lbl3rdCity').text(row.PER_Address_City_Desc);
                            $('#lbl3rdPin').text(row.PER_AddPin);

                            $('#lbl3rdCKYCNumber').text(row.Kyc_Number);
                            $('#lbl3rdTelNo').text(row.PER_ResTelNumber);
                            $('#lbl3rdMobieNumber').text(row.PER_MobileNumber);
                            $('#lbl3rdEmail').text(row.PER_EmailAdd);

                            //mail
                            $('#lbl3rdMAddress1').text(row.MAIL_Address1);
                            $('#lbl3rdMAddress2').text(row.MAIL_Address2);
                            $('#lbl3rdMAddress3').text(row.MAIL_Address3);
                            $('#lbl3rdMCountryDec').text(row.MAIL_AddCountry_Desc);
                            $('#lbl3rdMCountryCode').text(row.MAIL_AddCountry_Code);
                            $('#lbl3rdMState').text(row.MAIL_AddState_Desc);
                            $('#lbl3rdMDistrict').text(row.MAIL_Address_District_Desc);
                            $('#lbl3rdMCity').text(row.MAIL_Address_City_Desc);
                            $('#lbl3rdMPin').text(row.MAIL_AddPin);

                            $('.dv3ndHolder').show();
                            $('#dvHolders').show();
                        }

                        if (row.Holder_Type == '04' && $('#chkNomApplicable').prop('checked')) {
                            $('#lblHdrNomineeName').text(row.Kyc_FullName);
                            $('#lblNomineeFullName').text(row.Kyc_FullName);
                            $('#lblNomineeSalutation').text(row.Kyc_NamePrefix);
                            $('#lblNomineeFirstName').text(row.Kyc_FirstName);
                            $('#lblNomineeSecoundName').text(row.Kyc_MiddleName);
                            $('#lblNomineeThirdName').text(row.Kyc_LastName);

                            //$('#lblNomineeGender').text(row.Kyc_Gender);
                            //$('#lblNomineeGenderCode').text(row.Kyc_Gender);
                            $('#lblNominee_DOB').text(row.Display_Kyc_DOB);
                            $('#lblNomineeRelations').text(row.Nominee_Relations);
                            $('#lblNomineeRelationsCode').text(row.Nominee_Relations);
                            //$('#lblNomineeMaritalStatus').text(row.Kyc_LastName);
                            //$('#lblNomineeMaritalStatusCode').text(row.Kyc_LastName);
                            //$('#lblNomineePan').text(row.Kyc_LastName);
                            //$('#lblNomineeOccupation').text(row.Kyc_LastName);
                            //$('#lblNomineeOccupationCode').text(row.Kyc_LastName);                        

                            $('#lblGuardianFullName').text(row.Kyc_GuardianFullName);
                            $('#lblGuardianSalutation').text(row.Kyc_GuardianNamePrefix);
                            $('#lblGuardianFirstName').text(row.Kyc_GuardianFirstName);
                            $('#lblGuardianSecoundName').text(row.Kyc_GuardianMiddleName);
                            $('#lblGuardianThirdName').text(row.Kyc_GuardianLastName);
                            //$('#lblGuardianPAN').text(row.Kyc_Guardian_PAN);

                            $('#lblAddress1').text(row.PER_Address1);
                            $('#lblAddress2').text(row.PER_Address2);
                            $('#lblAddress3').text(row.PER_Address3);
                            $('#lblCountryName').text(row.PER_AddCountry_Desc);
                            $('#lblCountryCode').text(row.PER_AddCountry_Code);
                            $('#lblStateName').text(row.PER_AddState_Desc);
                            $('#lblStateCode').text(row.PER_AddState_Code);
                            $('#lblDistrictName').text(row.PER_Address_District_Desc);
                            $('#lblCity').text(row.PER_Address_City_Desc);
                            $('#lblPinCode').text(row.PER_AddPin);

                            $('#lblCKYCNumber').text(row.Kyc_Number);
                            $('#lblTelephoneNumber').text(row.PER_ResTelNumber);
                            $('#lblMobileNo').text(row.PER_MobileNumber);
                            $('#lblNomineeEmailID').text(row.PER_EmailAdd);


                            $('#dvNominee').show();
                        }
                    });
                }
            }

            $('#preloader').hide();
        }, null, true, false, false, ErrorFunction);

    } catch (e) {
        fnException(e);
    }
}

$('#btnsubmit08').click(function () {
    try {
        let InvestorDetailSaveStruct = {};
        if (IsValidSubmitStep8()) {
            //step1-----------------------------------------------------------------------------------
            InvestorDetailSaveStruct.FrontOfficeSave = getStep1Data();

            //step2------------------------------------------------------------------------------           
            InvestorDetailSaveStruct.Investor_Other_Dtl = getStep2Data();

            //step3--------------------------------------------------------------------------------------         
            InvestorDetailSaveStruct.Investment_Dtl = getStep3Data();

            //step4-------------------------------------------------------------------------------------------------------
            InvestorDetailSaveStruct.Investor_Bank_Dtl = getStep4Data();

            //step5-----------------------------------------------------------------------------------------------------------
            let KYCList = [];
            let All_Kyc_Address = [];
            let FATCA_DTLS = [];
            InvestorDetailSaveStruct.IsFATCAApplicable = "N";

            //FH details
            let FH_GET_DATA = FH_GET_DATA_FOR_SAVE();
            KYCList.push(FH_GET_DATA);

            //FH permanent address
            let FH_GET_PER_ADDR = FH_GET_PER_ADDR_FOR_SAVE();
            All_Kyc_Address.push(FH_GET_PER_ADDR);

            //FH mailing address
            let FH_GET_MAIL_ADDR = FH_GET_MAIL_ADDR_FOR_SAVE();
            All_Kyc_Address.push(FH_GET_MAIL_ADDR);

            //FH overseas address
            if ($('#chkIdOverSeasAddress').prop('checked') && $('#txtOAdd1').val() != '') {
                let FH_GET_OVR_ADDR = FH_GET_OVR_ADDR_FOR_SAVE();
                All_Kyc_Address.push(FH_GET_OVR_ADDR);
            }

            //FH FATCA Details
            if ($('#btnsldFatca').hasClass('active') || $('#btnsldGreen').hasClass('active')) {
                InvestorDetailSaveStruct.IsFATCAApplicable = "Y";
                let FH_GET_FATCA_DTLS = FH_GET_FATCA_DTLS_FOR_SAVE();
                FATCA_DTLS.push(FH_GET_FATCA_DTLS);
            }

            //second holder
            if ($('#chkSHApplicable').prop('checked')) {
                //details
                let SH_GET_DATA = SH_GET_DATA_FOR_SAVE();
                KYCList.push(SH_GET_DATA);

                //permanent address
                let SH_GET_PER_ADDR = SH_GET_PER_ADDR_FOR_SAVE();
                All_Kyc_Address.push(SH_GET_PER_ADDR);

                //mailing address
                let SH_GET_MAIL_ADDR = SH_GET_MAIL_ADDR_FOR_SAVE();
                All_Kyc_Address.push(SH_GET_MAIL_ADDR);

                //FATCA Details
                if ($('#btnSHsldFatca').hasClass('active') || $('#btnSHsldGreen').hasClass('active')) {
                    InvestorDetailSaveStruct.IsFATCAApplicable = "Y";
                    let SH_GET_FATCA_DTLS = SH_GET_FATCA_DTLS_FOR_SAVE();
                    FATCA_DTLS.push(SH_GET_FATCA_DTLS);
                }
            }

            //third holder
            if ($('#chkTHApplicable').prop('checked')) {
                //details
                let TH_GET_DATA = TH_GET_DATA_FOR_SAVE();
                KYCList.push(TH_GET_DATA);

                //permanent address
                let TH_GET_PER_ADDR = TH_GET_PER_ADDR_FOR_SAVE();
                All_Kyc_Address.push(TH_GET_PER_ADDR);

                //mailing address
                let TH_GET_MAIL_ADDR = TH_GET_MAIL_ADDR_FOR_SAVE();
                All_Kyc_Address.push(TH_GET_MAIL_ADDR);

                //FATCA Details
                if ($('#btnTHsldFatca').hasClass('active') || $('#btnTHsldGreen').hasClass('active')) {
                    InvestorDetailSaveStruct.IsFATCAApplicable = "Y";
                    let TH_GET_FATCA_DTLS = TH_GET_FATCA_DTLS_FOR_SAVE();
                    FATCA_DTLS.push(TH_GET_FATCA_DTLS);
                }
            }

            InvestorDetailSaveStruct.KYCDataDetails = KYCList;
            InvestorDetailSaveStruct.InvestorAddresses = All_Kyc_Address;
            InvestorDetailSaveStruct.FATCA_DTLS = FATCA_DTLS;

            //step6---------------------------------------------------------------------------------------------------------------
            if ($('#chkNomApplicable').prop('checked'))
                InvestorDetailSaveStruct.Nominee_Dtl = getStep6Data();

            //step7-----------------------------------------------------------------------------------------------------------------------------
            if (!$('#tblOVDList > tbody').hasClass('clear_tbody')) {
                let OVDDtls = [];
                let MemberDtls = [];

                $('#tblOVDList > tbody tr').each(function (i, tr) {
                    let $this = $(this);
                    let doc_id = tr.children[0].innerHTML
                    let ref_No = "";
                    let exp_No = null;
                    if (!$.isEmptyObject($($(this).find('td')[4]).find('input').val()))
                        ref_No = $($(this).find('td')[4]).find('input').val();
                    if (!$.isEmptyObject($($(this).find('td')[5]).find('input').val()))
                        exp_No = $($(this).find('td')[5]).find('input').val();

                    let OVDBO = {
                        Doc_ID: doc_id,
                        Doc_RefNO: ref_No,
                        Doc_ExpDate: exp_No
                    }
                    OVDDtls.push(OVDBO);
                });

                InvestorDetailSaveStruct.OVDDtls = OVDDtls;

                if (BTP_OBJECT.IND_NIND == 'HUF' && $('#tblCoparceners > tbody > tr').length > 0) {
                    $('#tblCoparceners > tbody tr').each(function (i, tr) {
                        let id = tr.children[0].innerHTML
                        let full_name = tr.children[1].innerHTML
                        let relation = tr.children[2].innerHTML
                        let dob = tr.children[3].innerHTML
                        let mobile = tr.children[4].innerHTML

                        let MemberBO = {
                            ID: id,
                            Full_Name: full_name,
                            Relation: relation,
                            DOB: dob,
                            Mobile: mobile
                        }
                        MemberDtls.push(MemberBO);
                    });

                    InvestorDetailSaveStruct.MemberDtls = MemberDtls;

                }
            }

            var isError = true;
            ExtendedAjaxCall('RenewInvestorDetailsSave/SubmitStep8', InvestorDetailSaveStruct, 'POST', function (result) {
                try {
                    if (!$.isEmptyObject(result) && result.Status == 1) {

                        $('#DV_STEP1 select, #DV_STEP1 input').prop('disabled', true);
                        $('#DV_STEP2 button, #DV_STEP2 input').prop('disabled', true);
                        $('#DV_STEP3 button, #DV_STEP3 select, #DV_STEP3 input').prop('disabled', true);
                        $('#DV_STEP4 button, #DV_STEP4 select, #DV_STEP4 input').prop('disabled', true);
                        $('#DV_STEP5 button, #DV_STEP5 select, #DV_STEP5 input').prop('disabled', true);
                        $('#DV_NOM button, #DV_NOM select, #DV_NOM input').prop('disabled', true);
                        $('#DV_STEP7 button, #DV_STEP7 select, #DV_STEP7 input').prop('disabled', true);
                        $('#btnCancel01,#btnCancel02,#btnCancel03,#btnCancel04,#btnCancel05,#btnCancel06,#btnCancel07,#btnCancel08').hide();
                        $('#btnsubmit01,#btnsubmit02,#btnsubmit03,#btnsubmit04,#btnsubmit05,#btnsubmit06,#btnsubmit07,#btnsubmit08').hide();
                        $('#lnkCMSBranchSearch, #DV_FATCA_DETAILS').hide();
                        $('#DV_APPL_UPLOAD, #DV_HOLDER_DOC_UPLOAD, .OVD_DELETE').hide();
                        $('.BIND_DETAIL, .CLEAR_DETAIL, .btnTblEdit, .btnTblDelete').hide();
                        $('#ddlHolderType').prop('disabled', false);
                        $('#IdBtnTabSwit08').css('border-color', '#047904');


                        let msg = '<p>Application ' + $('#lblApplicationNumber').text() + ' saved successfully..!</p>';

                        if ($('#rdoPhysical').prop('checked') && ($('#ddlInvPayment_Mode').val() == '3' || $('#ddlInvPayment_Mode').val() == '4' || $('#ddlInvPayment_Mode').val() == 'Cheque/DD' || $('#ddlInvPayment_Mode').val() == "Cheque" || $('#ddlInvPayment_Mode').val() == "Demand Draft")) {
                            msg = '<p style="font-size: 16px;margin: 10px 0 10px;font-weight: 600;">Entry for application number ' + $('#lblApplicationNumber').text() + ' completed successfully.</p>'
                            msg += '<p style="color: #000;"> Proceed for payinslip generation, submit the investment cheque along with payinslip to the  nearest HDFC Bank CMS center.</p>';
                            msg += '<p style="color: #000;"> Please qoute above application number on physical FD application and dispatch the same to the adress mentioned below.</p>';
                            msg += '<p style="color: #000;font-size: 12px;"><b>Address:</b> Mahindra & Mahindra Financial Services Limited,';
                            msg += ' 2nd Floor, sadhana House,';
                            msg += ' Behind Mahindra Towers,';
                            msg += ' 570, P.B Marg, worli Mumbai 400018.</p>';
                        }
                        else {
                            if (result.URL_Status == 1) {
                                //msg = '<p> The investment acceptance/payment link for application number ' + $('#lblApplicationNumber').text() + ' has been successfully sent to registered email ID & mobile number of the Depositor. You may proceed to enter new application, if available.Thank you. </p>';
                                msg = '<p> Fixed Deposit Renewal acceptance link for application number ' + $('#lblApplicationNumber').text() + ' has been sent the registered Email ID & Mobile number of the Depositor. Kindly request the Depositor to accept the registration by clicking on the link for renewal of Fixed Deposit. </p>';
                            }
                            else if (result.URL_Status == 0) {
                                msg += '<p>' + result.Msg + '</p>'
                            }
                        }

                        BtpMessagePopup(msg, 'success');
                    }
                    else if (!$.isEmptyObject(result) && result.Status == 0 && !$.isEmptyObject(result.Msg)) {
                        isError = true;
                        BtpMessagePopup(result.Msg, "error");
                    }
                    else {
                        isError = true;
                        BtpMessagePopup('Something went wrong..!', "error");
                    }

                    $('#preloader').hide();

                } catch (e) {
                    fnException(e);
                }
            }, null, true, false, false, ErrorFunction);

            if (isError) {
                return false;
            }

            return true;
        }
        else {
            return false;
        }
    } catch (e) {
        fnException(e); return false;
    }
});

function IsValidSubmitStep8() {
    try {
        let errMessage = "";

        //step1-----------------------------------------------------------
        errMessage += isValidStep1();

        //step3--------------------------------------------------
        errMessage += isValidStep3();

        //step4---------------------------------------------------
        errMessage += isValidStep4();

        //step5----------------------------------------------------------

        //first holder
        errMessage += FH_Save_Validations();

        //second holder
        if ($('#chkSHApplicable').prop('checked'))
            errMessage += SH_Save_Validations();

        //third holder
        if ($('#chkTHApplicable').prop('checked'))
            errMessage += TH_Save_Validations();

        //all holder pan validation - 1:2
        if ($('#txtInvPan').val() == $('#DV_SH #txtPAN').val() && $('#txtInvDOB').val() == $('#DV_SH #txtDOB').val() && $('#txtInvPan').val() != '' && $('#txtInvDOB').val() != '') {
            errMessage += "<p>Second Holder's PAN number can not be same as Investor's PAN..!</p>";
        }

        //all holder pan validation - 1:3
        if ($('#txtInvPan').val() == $('#DV_TH #txtPAN').val() && $('#txtInvDOB').val() == $('#DV_TH #txtDOB').val() && $('#txtInvPan').val() != '' && $('#DV_TH #txtDOB').val() != '') {
            errMessage += "<p>Third Holder's PAN number can not be same as Investor's PAN..!</p>";
        }

        //all holder pan validation - 2:3
        if ($('#DV_SH #txtPAN').val() == $('#DV_TH #txtPAN').val() && $('#DV_SH #txtDOB').val() == $('#DV_TH #txtDOB').val() && $('#DV_SH #txtPAN').val() != '' && $('#DV_SH #txtDOB').val() != '') {
            errMessage += "<p>Third Holder's PAN number can not be same Second Holder's PAN..!</p>";
        }


        //step6------------------------------------------------
        if ($('#chkNomApplicable').prop('checked'))
            errMessage += isValidStep6();

        //step7-------------------------------------------------
        errMessage += isValidStep7();

        if (!$.isEmptyObject(errMessage)) {
            BtpMessagePopup(errMessage, 'error');
            return false;
        }

        return true;

    } catch (e) {
        fnException(e); return false;
    }

}
var FH_CNT = 1;
var FH_Action = 'ADD';
var SH_CNT = 1;
var SH_Action = 'ADD';
var TH_CNT = 1;
var TH_Action = 'ADD';

$('input[name="TRC_EXP_DATE"]').datetextentry({
    min_date: function () { return this.get_today(); },
    min_date_message: 'Date cannot be past date'
});

//FH-------------------------------------------------------------------------
$('#DV_FH_FATCA #btnBind').on('click', function (result)
{
    try
    {

        $('#preloader').show();
        if (iSFHFATCAValidate())
        {

            if ($('#DV_FH_FATCA #tblDetailList tbody tr').hasClass('empty_table'))
            {
                $('#DV_FH_FATCA #tblDetailList tbody').empty();
            }

            var $trs = $('#DV_FH_FATCA #tblDetailList').children("tr");
            var ddlCountryOfTax = $('#DV_FH_FATCA #ddlCountryOfTax').val();
            var ddlCountryOfTaxDesc = $('#DV_FH_FATCA #ddlCountryOfTax :selected').text();
            var ddlTaxIndentityType = $('#DV_FH_FATCA #ddlTaxIndentityType').val();
            var ddlTaxIndentityTypeDesc = $('#DV_FH_FATCA #ddlTaxIndentityType :selected').text();
            var txttaxIdentityNo = $('#DV_FH_FATCA #txttaxIdentityNo').val();
            var txtexpTRCDate = $('#DV_FH_FATCA #txtexpTRCDate').val();
            var ddlAddressType = $('#DV_FH_FATCA #ddlAddressType').val();
            var ddlAddressTypeDesc = $('#DV_FH_FATCA #ddlAddressType :selected').text();
            var txtFatcaAdd1 = $('#DV_FH_FATCA #txtFatcaAdd1').val();
            var txtFatcaAdd2 = $('#DV_FH_FATCA #txtFatcaAdd2').val();
            var txtFatcaLandmark = $('#DV_FH_FATCA #txtFatcaLandmark').val();
            var ddlFatcaState = $('#DV_FH_FATCA #ddlFatcaState').val();
            var ddlFatcaStateDesc = $('#DV_FH_FATCA #ddlFatcaState :selected').text();
            var txtFatcaCity = $('#DV_FH_FATCA #txtFatcaCity').val();
            var txtFatcaPostalcode = $('#DV_FH_FATCA #txtFatcaPostalcode').val();
            var txtSTDCodePrimary = $('#DV_FH_FATCA #txtSTDCodePrimary').val();
            var txtTelephoneNumberPrimary = $('#DV_FH_FATCA #txtTelephoneNumberPrimary').val();
            var txtMobileNumberPrimary = $('#DV_FH_FATCA #txtMobileNumberPrimary').val();
            var txtSTDCodeOther = $('#DV_FH_FATCA #txtSTDCodeOther').val();
            var txtTelephoneNumberOther = $('#DV_FH_FATCA #txtTelephoneNumberOther').val();
            var txtMobileNumberOther = $('#DV_FH_FATCA #txtMobileNumberOther').val();

            if (FH_Action == 'ADD')
            {
                var htmlstr = ''
                htmlstr += '<tr class="Key" id="' + FH_CNT + '">';

                htmlstr += '<td class="text-center"><button type="button" id="FH_btnedit' + FH_CNT + '" class="btn btn-orange btn-small btnTblEdit" onclick="FH_tbledit(this,' + FH_CNT + ')">Edit</button></td>';
                htmlstr += "<td class='text-center'><button type='button'  class='btn btn-orange btn-small btnTblDelete' onclick='FH_Delete(this)'>Delete</button></td>";
                htmlstr += '<td id="country' + FH_CNT + '" code="' + ddlCountryOfTax + '">' + ddlCountryOfTaxDesc + '</td>';
                htmlstr += '<td id="taxIdentity' + FH_CNT + '"  code="' + ddlTaxIndentityType + '">' + ddlTaxIndentityTypeDesc + '</td>';
                htmlstr += '<td id="tax' + FH_CNT + '">' + txttaxIdentityNo + '</td>';
                htmlstr += '<td id="trcDate' + FH_CNT + '">' + txtexpTRCDate + '</td>';
                htmlstr += '<td id="addressType' + FH_CNT + '" code="' + ddlAddressType + '" >' + ddlAddressTypeDesc + '</td>';
                htmlstr += '<td id="address1' + FH_CNT + '">' + txtFatcaAdd1 + '</td>';
                htmlstr += '<td id="address2' + FH_CNT + '">' + txtFatcaAdd2 + '</td>';
                htmlstr += '<td id="Landmark' + FH_CNT + '">' + txtFatcaLandmark + '</td>';
                htmlstr += '<td id="state' + FH_CNT + '" code="' + ddlFatcaState + '">' + ddlFatcaStateDesc + '</td>';
                htmlstr += '<td id="city' + FH_CNT + '">' + txtFatcaCity + '</td>';
                htmlstr += '<td id="postalcode' + FH_CNT + '">' + txtFatcaPostalcode + '</td>';
                htmlstr += '<td id="stdCodePrimary' + FH_CNT + '">' + txtSTDCodePrimary + '</td>';
                htmlstr += '<td id="telNumberpriamry' + FH_CNT + '">' + txtTelephoneNumberPrimary + '</td>';
                htmlstr += '<td id="MobNumberprimary' + FH_CNT + '">' + txtMobileNumberPrimary + '</td>';
                htmlstr += '<td id="stdCodeother' + FH_CNT + '">' + txtSTDCodeOther + '</td>';
                htmlstr += '<td id="telNumberother' + FH_CNT + '">' + txtTelephoneNumberOther + '</td>';
                htmlstr += '<td id="mobNumberother' + FH_CNT + '">' + txtMobileNumberOther + '</td>';
                htmlstr += '</tr>';
                $('#DV_FH_FATCA #tblDetailList>tbody').append(htmlstr);

                FH_CNT += 1;

            }
            else if (FH_Action == 'Update')
            {

                var value = $('#DV_FH_FATCA #currentRow').text();

                $('#DV_FH_FATCA #country' + value).text(ddlCountryOfTaxDesc);
                $('#DV_FH_FATCA #country' + value).attr('code', ddlCountryOfTax);
                $('#DV_FH_FATCA #taxIdentity' + value).text(ddlTaxIndentityTypeDesc);
                $('#DV_FH_FATCA #taxIdentity' + value).attr('code', ddlTaxIndentityType);
                $('#DV_FH_FATCA #tax' + value).text(txttaxIdentityNo);
                $('#DV_FH_FATCA #trcDate' + value).text(txtexpTRCDate);
                $('#DV_FH_FATCA #address1' + value).text(txtFatcaAdd1);
                $('#DV_FH_FATCA #address2' + value).text(txtFatcaAdd2);
                $('#DV_FH_FATCA #Landmark' + value).text(txtFatcaLandmark);
                $('#DV_FH_FATCA #state' + value).text(ddlFatcaStateDesc);
                $('#DV_FH_FATCA #state' + value).attr('code', ddlFatcaState);
                $('#DV_FH_FATCA #addressType' + value).text(ddlAddressTypeDesc);
                $('#DV_FH_FATCA #addressType' + value).attr('code', ddlAddressType);
                $('#DV_FH_FATCA #city' + value).text(txtFatcaCity);
                $('#DV_FH_FATCA #postalcode' + value).text(txtFatcaPostalcode);
                $('#DV_FH_FATCA #stdCodePrimary' + value).text(txtSTDCodePrimary);
                $('#DV_FH_FATCA #telNumberpriamry' + value).text(txtTelephoneNumberPrimary);
                $('#DV_FH_FATCA #MobNumberprimary' + value).text(txtMobileNumberPrimary);
                $('#DV_FH_FATCA #stdCodeother' + value).text(txtSTDCodeOther);
                $('#DV_FH_FATCA #telNumberother' + value).text(txtTelephoneNumberOther);
                $('#DV_FH_FATCA #mobNumberother' + value).text(txtMobileNumberOther);
         
            }
            FH_clear();
            FH_Action = 'ADD';
        }
        $('#preloader').hide();


    } catch (e)
    {
        fnException(e);
    }
});

function FH_tbledit(btn, cnt)
{
    try
    {
        $('#preloader').show();
        FH_Action = 'Update';

        $('#DV_FH_FATCA #currentRow').text(cnt)
        $('#DV_FH_FATCA #ddlCountryOfTax').val($('#DV_FH_FATCA #country' + cnt).attr('code'));
        $('#DV_FH_FATCA #ddlCountryOfTax').change();
        $('#DV_FH_FATCA #ddlTaxIndentityType').val($('#DV_FH_FATCA #taxIdentity' + cnt).attr('code'));
        $('#DV_FH_FATCA #txttaxIdentityNo').val($('#DV_FH_FATCA #tax' + cnt).html());
        $('#DV_FH_FATCA #txtexpTRCDate').datetextentry('set_date', $('#DV_FH_FATCA #trcDate' + cnt).html());
        $('#DV_FH_FATCA #ddlAddressType').val($('#DV_FH_FATCA #addressType' + cnt).attr('code'));
        $('#DV_FH_FATCA #txtFatcaAdd1').val($('#DV_FH_FATCA #address1' + cnt).html());
        $('#DV_FH_FATCA #txtFatcaAdd2').val($('#DV_FH_FATCA #address2' + cnt).html());
        $('#DV_FH_FATCA #txtFatcaLandmark').val($('#DV_FH_FATCA #Landmark' + cnt).html());
        $('#DV_FH_FATCA #ddlFatcaState').val($('#DV_FH_FATCA #state' + cnt).attr('code'));
        $('#DV_FH_FATCA #txtFatcaCity').val($('#DV_FH_FATCA #city' + cnt).html());
        $('#DV_FH_FATCA #txtFatcaPostalcode').val($('#DV_FH_FATCA #postalcode' + cnt).html());
        $('#DV_FH_FATCA #txtSTDCodePrimary').val($('#DV_FH_FATCA #stdCodePrimary' + cnt).html());
        $('#DV_FH_FATCA #txtTelephoneNumberPrimary').val($('#DV_FH_FATCA #telNumberpriamry' + cnt).html());
        $('#DV_FH_FATCA #txtMobileNumberPrimary').val($('#DV_FH_FATCA #MobNumberprimary' + cnt).html());
        $('#DV_FH_FATCA #txtSTDCodeOther').val($('#DV_FH_FATCA #stdCodeother' + cnt).html());
        $('#DV_FH_FATCA #txtTelephoneNumberOther').val($('#DV_FH_FATCA #telNumberother' + cnt).html());
        $('#DV_FH_FATCA #txtMobileNumberOther').val($('#DV_FH_FATCA #mobNumberother' + cnt).html());
        //$('#ddlCountry option:selected').text($('#country' + cnt).text()));
        $("#DV_FH_FATCA #tblDetailList_default td").val($(btn).closest('tr')).length;
        $('#DV_FH_FATCA #txtSTDCodeOther').val($('#DV_FH_FATCA #stdCodeother' + cnt).html());
        $('#DV_FH_FATCA #currentRow').val($('#DV_FH_FATCA #Key' + cnt).html());

        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

function FH_Delete(btn)
{
    try
    {
        $('#preloader').show();

        $(btn).closest("tr").remove();

        if ($('#DV_FH_FATCA #tblDetailList tbody tr').length == 0)
        {
            $('#DV_FH_FATCA #tblDetailList tbody').html("<tr class='empty_table'><td colspan='19'>No Records Found..!</td></tr>");
        }
        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

function FH_clear()
{
    try
    {
        $('#preloader').show();

        $('#DV_FH_FATCA .fatca').removeClass('InputBorderRed');
        $('#DV_FH_FATCA .fatca').parent().removeClass('InputBorderRed');

        $('#DV_FH_FATCA #ddlCountryOfTax').val('select');
        $('#DV_FH_FATCA #ddlTaxIndentityType').val('select');
        $('#DV_FH_FATCA #txttaxIdentityNo').val('');
        $('#DV_FH_FATCA #ddlAddressType').val('select');
        $('#DV_FH_FATCA #ddlFatcaState').val('select');
        $('#DV_FH_FATCA #txtFatcaAdd1').val('');
        $('#DV_FH_FATCA #txtAddress1_DetailModel').val();
        $('#DV_FH_FATCA #txtFatcaAdd2').val('');
        $('#DV_FH_FATCA #txtFatcaLandmark').val('');
        $('#DV_FH_FATCA #txtFatcaCity').val('');
        $('#DV_FH_FATCA #txtFatcaPostalcode').val('');
        $('#DV_FH_FATCA #txtSTDCodePrimary').val('');
        $('#DV_FH_FATCA #txtTelephoneNumberPrimary').val('');
        $('#DV_FH_FATCA #txtMobileNumberPrimary').val('');
        $('#DV_FH_FATCA #txtSTDCodeOther').val('');
        $('#DV_FH_FATCA #txtTelephoneNumberOther').val('');
        $('#DV_FH_FATCA #txtMobileNumberOther').val('');
        $('#DV_FH_FATCA #txtexpTRCDate').datetextentry('set_date', '');

        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

// validation
function iSFHFATCAValidate()
{
    try
    {
        $('#preloader').show();

        $('#DV_FH_FATCA .fatca').removeClass('InputBorderRed');
        $('#DV_FH_FATCA .fatca').parent().removeClass('InputBorderRed');

        var isError = false;
        var errMessage = "";

        $('#DV_FH_FATCA .fatca').each(function ()
        {
            var $this = $(this);
            if ($this.val() == "" || $this.val() == '-1' || $this.val() == 'Select' || $this.val() == 'select' || $this.val() == undefined)
            {
                if ($this.attr('errmsg') != '' && $this.attr('errmsg') != undefined)
                {
                    errMessage += "<p>" + $this.attr('errmsg'); +"</p>";
                }

                if ($this.hasClass('D_T_E'))
                {
                    $this.parent().addClass('InputBorderRed');
                }
                else
                {
                    $this.addClass('InputBorderRed');
                }
                isError = true;
            }           
        });


        $('#DV_FH_FATCA .mobileF').each(function ()
        {
            var $this = $(this);
            if ($this.val() != "" && !IsValidMobile($this.val()))
            {
                errMessage += "<p>Mobile Number is Not Valid.</p>";
                $this.addClass('InputBorderRed');
                isError = true;
            }           
        });


        if (isError)
        {
            //$('#dvErrorMsg').html(errMessage);
            //$('#btnOpenModalError').click();
            BtpMessagePopup(errMessage, 'error');
            return false;
        }

        $('#preloader').hide();

        return true;

       
    } catch (e)
    {
        fnException(e)
    }
}

$("#DV_FH_FATCA #btnOpenDetailModel").click(function ()
{
    $("#DV_FH_FATCA #DV_FATCA_DETAILS").toggle();
});

$('#DV_FH_FATCA #btnFatacClear').click(function ()
{
    FH_clear();
});

//SH-------------------------------------------------------------------------------------
$('#DV_SH_FATCA #btnBind').on('click', function (result)
{
    try
    {

        $('#preloader').show();
        if (iSSHFATCAValidate())
        {

            if ($('#DV_SH_FATCA #tblDetailList tbody tr').hasClass('empty_table'))
            {
                $('#DV_SH_FATCA #tblDetailList tbody').empty();
            }

            var $trs = $('#DV_SH_FATCA #tblDetailList').children("tr");
            var ddlCountryOfTax = $('#DV_SH_FATCA #ddlCountryOfTax').val();
            var ddlCountryOfTaxDesc = $('#DV_SH_FATCA #ddlCountryOfTax :selected').text();
            var ddlTaxIndentityType = $('#DV_SH_FATCA #ddlTaxIndentityType').val();
            var ddlTaxIndentityTypeDesc = $('#DV_SH_FATCA #ddlTaxIndentityType :selected').text();
            var txttaxIdentityNo = $('#DV_SH_FATCA #txttaxIdentityNo').val();
            var txtexpTRCDate = $('#DV_SH_FATCA #txtexpTRCDate').val();
            var ddlAddressType = $('#DV_SH_FATCA #ddlAddressType').val();
            var ddlAddressTypeDesc = $('#DV_SH_FATCA #ddlAddressType :selected').text();
            var txtFatcaAdd1 = $('#DV_SH_FATCA #txtFatcaAdd1').val();
            var txtFatcaAdd2 = $('#DV_SH_FATCA #txtFatcaAdd2').val();
            var txtFatcaLandmark = $('#DV_SH_FATCA #txtFatcaLandmark').val();
            var ddlFatcaState = $('#DV_SH_FATCA #ddlFatcaState').val();
            var ddlFatcaStateDesc = $('#DV_SH_FATCA #ddlFatcaState :selected').text();
            var txtFatcaCity = $('#DV_SH_FATCA #txtFatcaCity').val();
            var txtFatcaPostalcode = $('#DV_SH_FATCA #txtFatcaPostalcode').val();
            var txtSTDCodePrimary = $('#DV_SH_FATCA #txtSTDCodePrimary').val();
            var txtTelephoneNumberPrimary = $('#DV_SH_FATCA #txtTelephoneNumberPrimary').val();
            var txtMobileNumberPrimary = $('#DV_SH_FATCA #txtMobileNumberPrimary').val();
            var txtSTDCodeOther = $('#DV_SH_FATCA #txtSTDCodeOther').val();
            var txtTelephoneNumberOther = $('#DV_SH_FATCA #txtTelephoneNumberOther').val();
            var txtMobileNumberOther = $('#DV_SH_FATCA #txtMobileNumberOther').val();

            if (SH_Action == 'ADD')
            {
                var htmlstr = ''
                htmlstr += '<tr class="Key" id="' + SH_CNT + '">';

                htmlstr += '<td class="text-center"><button type="button" id="SH_btnedit' + SH_CNT + '" class="btn btn-orange btn-small btnTblEdit" onclick="SH_tbledit(this,' + SH_CNT + ')">Edit</button></td>';
                htmlstr += "<td class='text-center'><button type='button'  class='btn btn-orange btn-small' onclick='SH_Delete(this)'>Delete</button></td>";
                htmlstr += '<td id="country' + SH_CNT + '" code="' + ddlCountryOfTax + '">' + ddlCountryOfTaxDesc + '</td>';
                htmlstr += '<td id="taxIdentity' + SH_CNT + '"  code="' + ddlTaxIndentityType + '">' + ddlTaxIndentityTypeDesc + '</td>';
                htmlstr += '<td id="tax' + SH_CNT + '">' + txttaxIdentityNo + '</td>';
                htmlstr += '<td id="trcDate' + SH_CNT + '">' + txtexpTRCDate + '</td>';
                htmlstr += '<td id="addressType' + SH_CNT + '" code="' + ddlAddressType + '" >' + ddlAddressTypeDesc + '</td>';
                htmlstr += '<td id="address1' + SH_CNT + '">' + txtFatcaAdd1 + '</td>';
                htmlstr += '<td id="address2' + SH_CNT + '">' + txtFatcaAdd2 + '</td>';
                htmlstr += '<td id="Landmark' + SH_CNT + '">' + txtFatcaLandmark + '</td>';
                htmlstr += '<td id="state' + SH_CNT + '" code="' + ddlFatcaState + '">' + ddlFatcaStateDesc + '</td>';
                htmlstr += '<td id="city' + SH_CNT + '">' + txtFatcaCity + '</td>';
                htmlstr += '<td id="postalcode' + SH_CNT + '">' + txtFatcaPostalcode + '</td>';
                htmlstr += '<td id="stdCodePrimary' + SH_CNT + '">' + txtSTDCodePrimary + '</td>';
                htmlstr += '<td id="telNumberpriamry' + SH_CNT + '">' + txtTelephoneNumberPrimary + '</td>';
                htmlstr += '<td id="MobNumberprimary' + SH_CNT + '">' + txtMobileNumberPrimary + '</td>';
                htmlstr += '<td id="stdCodeother' + SH_CNT + '">' + txtSTDCodeOther + '</td>';
                htmlstr += '<td id="telNumberother' + SH_CNT + '">' + txtTelephoneNumberOther + '</td>';
                htmlstr += '<td id="mobNumberother' + SH_CNT + '">' + txtMobileNumberOther + '</td>';
                htmlstr += '</tr>';
                $('#DV_SH_FATCA #tblDetailList>tbody').append(htmlstr);

                SH_CNT += 1;

            }
            else if (SH_Action == 'Update')
            {

                var value = $('#DV_SH_FATCA #currentRow').text();

                $('#DV_SH_FATCA #country' + value).text(ddlCountryOfTaxDesc);
                $('#DV_SH_FATCA #country' + value).attr('code', ddlCountryOfTax);
                $('#DV_SH_FATCA #taxIdentity' + value).text(ddlTaxIndentityTypeDesc);
                $('#DV_SH_FATCA #taxIdentity' + value).attr('code', ddlTaxIndentityType);
                $('#DV_SH_FATCA #tax' + value).text(txttaxIdentityNo);
                $('#DV_SH_FATCA #trcDate' + value).text(txtexpTRCDate);
                $('#DV_SH_FATCA #address1' + value).text(txtFatcaAdd1);
                $('#DV_SH_FATCA #address2' + value).text(txtFatcaAdd2);
                $('#DV_SH_FATCA #Landmark' + value).text(txtFatcaLandmark);
                $('#DV_SH_FATCA #state' + value).text(ddlFatcaStateDesc);
                $('#DV_SH_FATCA #state' + value).attr('code', ddlFatcaState);
                $('#DV_SH_FATCA #addressType' + value).text(ddlAddressTypeDesc);
                $('#DV_SH_FATCA #addressType' + value).attr('code', ddlAddressType);
                $('#DV_SH_FATCA #city' + value).text(txtFatcaCity);
                $('#DV_SH_FATCA #postalcode' + value).text(txtFatcaPostalcode);
                $('#DV_SH_FATCA #stdCodePrimary' + value).text(txtSTDCodePrimary);
                $('#DV_SH_FATCA #telNumberpriamry' + value).text(txtTelephoneNumberPrimary);
                $('#DV_SH_FATCA #MobNumberprimary' + value).text(txtMobileNumberPrimary);
                $('#DV_SH_FATCA #stdCodeother' + value).text(txtSTDCodeOther);
                $('#DV_SH_FATCA #telNumberother' + value).text(txtTelephoneNumberOther);
                $('#DV_SH_FATCA #mobNumberother' + value).text(txtMobileNumberOther);
                
            }
            SH_clear();
            SH_Action = 'ADD';
        }
        $('#preloader').hide();


    } catch (e)
    {
        fnException(e);
    }
});

function SH_tbledit(btn, cnt)
{
    try
    {
        $('#preloader').show();
        SH_Action = 'Update';

        $('#DV_SH_FATCA #currentRow').text(cnt)
        $('#DV_SH_FATCA #ddlCountryOfTax').val($('#DV_SH_FATCA #country' + cnt).attr('code'));
        $('#DV_SH_FATCA #ddlCountryOfTax').change();
        $('#DV_SH_FATCA #ddlTaxIndentityType').val($('#DV_SH_FATCA #taxIdentity' + cnt).attr('code'));
        $('#DV_SH_FATCA #txttaxIdentityNo').val($('#DV_SH_FATCA #tax' + cnt).html());
        $('#DV_SH_FATCA #txtexpTRCDate').datetextentry('set_date', $('#DV_SH_FATCA #trcDate' + cnt).html());
        $('#DV_SH_FATCA #ddlAddressType').val($('#DV_SH_FATCA #addressType' + cnt).attr('code'));
        $('#DV_SH_FATCA #txtFatcaAdd1').val($('#DV_SH_FATCA #address1' + cnt).html());
        $('#DV_SH_FATCA #txtFatcaAdd2').val($('#DV_SH_FATCA #address2' + cnt).html());
        $('#DV_SH_FATCA #txtFatcaLandmark').val($('#DV_SH_FATCA #Landmark' + cnt).html());
        $('#DV_SH_FATCA #ddlFatcaState').val($('#DV_SH_FATCA #state' + cnt).attr('code'));
        $('#DV_SH_FATCA #txtFatcaCity').val($('#DV_SH_FATCA #city' + cnt).html());
        $('#DV_SH_FATCA #txtFatcaPostalcode').val($('#DV_SH_FATCA #postalcode' + cnt).html());
        $('#DV_SH_FATCA #txtSTDCodePrimary').val($('#DV_SH_FATCA #stdCodePrimary' + cnt).html());
        $('#DV_SH_FATCA #txtTelephoneNumberPrimary').val($('#DV_SH_FATCA #telNumberpriamry' + cnt).html());
        $('#DV_SH_FATCA #txtMobileNumberPrimary').val($('#DV_SH_FATCA #MobNumberprimary' + cnt).html());
        $('#DV_SH_FATCA #txtSTDCodeOther').val($('#DV_SH_FATCA #stdCodeother' + cnt).html());
        $('#DV_SH_FATCA #txtTelephoneNumberOther').val($('#DV_SH_FATCA #telNumberother' + cnt).html());
        $('#DV_SH_FATCA #txtMobileNumberOther').val($('#DV_SH_FATCA #mobNumberother' + cnt).html());
        //$('#ddlCountry option:selected').text($('#country' + cnt).text()));
        $("#DV_SH_FATCA #tblDetailList_default td").val($(btn).closest('tr')).length;
        $('#DV_SH_FATCA #txtSTDCodeOther').val($('#DV_SH_FATCA #stdCodeother' + cnt).html());
        $('#DV_SH_FATCA #currentRow').val($('#DV_SH_FATCA #Key' + cnt).html());

        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

function SH_Delete(btn)
{
    try
    {
        $('#preloader').show();

        $(btn).closest("tr").remove();

        if ($('#DV_SH_FATCA #tblDetailList tbody tr').length == 0)
        {
            $('#DV_SH_FATCA #tblDetailList tbody').html("<tr class='empty_table'><td colspan='19'>No Records Found..!</td></tr>");
        }
        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

function SH_clear()
{
    try
    {
        $('#preloader').show();

        $('#DV_SH_FATCA .fatca').removeClass('InputBorderRed');
        $('#DV_SH_FATCA .fatca').parent().removeClass('InputBorderRed');

        $('#DV_SH_FATCA #ddlCountryOfTax').val('select');
        $('#DV_SH_FATCA #ddlTaxIndentityType').val('select');
        $('#DV_SH_FATCA #txttaxIdentityNo').val('');
        $('#DV_SH_FATCA #ddlAddressType').val('select');
        $('#DV_SH_FATCA #ddlFatcaState').val('select');
        $('#DV_SH_FATCA #txtFatcaAdd1').val('');
        $('#DV_SH_FATCA #txtAddress1_DetailModel').val();
        $('#DV_SH_FATCA #txtFatcaAdd2').val('');
        $('#DV_SH_FATCA #txtFatcaLandmark').val('');
        $('#DV_SH_FATCA #txtFatcaCity').val('');
        $('#DV_SH_FATCA #txtFatcaPostalcode').val('');
        $('#DV_SH_FATCA #txtSTDCodePrimary').val('');
        $('#DV_SH_FATCA #txtTelephoneNumberPrimary').val('');
        $('#DV_SH_FATCA #txtMobileNumberPrimary').val('');
        $('#DV_SH_FATCA #txtSTDCodeOther').val('');
        $('#DV_SH_FATCA #txtTelephoneNumberOther').val('');
        $('#DV_SH_FATCA #txtMobileNumberOther').val('');
        $('#DV_SH_FATCA #txtexpTRCDate').datetextentry('set_date', '');

        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

// validation
function iSSHFATCAValidate()
{
    try
    {
        $('#preloader').show();

        $('#DV_SH_FATCA .fatca').removeClass('InputBorderRed');
        $('#DV_SH_FATCA .fatca').parent().removeClass('InputBorderRed');

        var isError = false;
        var errMessage = "";

        $('#DV_SH_FATCA .fatca').each(function ()
        {
            var $this = $(this);
            if ($this.val() == "" || $this.val() == '-1' || $this.val() == 'Select' || $this.val() == 'select' || $this.val() == undefined)
            {
                if ($this.attr('errmsg') != '' && $this.attr('errmsg') != undefined)
                {
                    errMessage += "<p>" + $this.attr('errmsg'); +"</p>";
                }

                if ($this.hasClass('D_T_E'))
                {
                    $this.parent().addClass('InputBorderRed');
                }
                else
                {
                    $this.addClass('InputBorderRed');
                }
                isError = true;
            }
        });


        $('#DV_SH_FATCA .mobileF').each(function ()
        {
            var $this = $(this);
            if ($this.val() != "" && !IsValidMobile($this.val()))
            {
                errMessage += "<p>Mobile Number is Not Valid.</p>";
                $this.addClass('InputBorderRed');
                isError = true;
            }
        });


        if (isError)
        {
            //$('#dvErrorMsg').html(errMessage);
            //$('#btnOpenModalError').click();
            BtpMessagePopup(errMessage, 'error');
            return false;
        }

        $('#preloader').hide();

        return true;


    } catch (e)
    {
        fnException(e)
    }
}

$("#DV_SH_FATCA #btnOpenDetailModel").click(function ()
{
    $("#DV_SH_FATCA #DV_FATCA_DETAILS").toggle();
});

$('#DV_SH_FATCA #btnFatacClear').click(function ()
{
    SH_clear();
});


//TH------------------------------------------------------------------------------------
$('#DV_TH_FATCA #btnBind').on('click', function (result)
{
    try
    {

        $('#preloader').show();
        if (iSTHFATCAValidate())
        {

            if ($('#DV_TH_FATCA #tblDetailList tbody tr').hasClass('empty_table'))
            {
                $('#DV_TH_FATCA #tblDetailList tbody').empty();
            }

            var $trs = $('#DV_TH_FATCA #tblDetailList').children("tr");
            var ddlCountryOfTax = $('#DV_TH_FATCA #ddlCountryOfTax').val();
            var ddlCountryOfTaxDesc = $('#DV_TH_FATCA #ddlCountryOfTax :selected').text();
            var ddlTaxIndentityType = $('#DV_TH_FATCA #ddlTaxIndentityType').val();
            var ddlTaxIndentityTypeDesc = $('#DV_TH_FATCA #ddlTaxIndentityType :selected').text();
            var txttaxIdentityNo = $('#DV_TH_FATCA #txttaxIdentityNo').val();
            var txtexpTRCDate = $('#DV_TH_FATCA #txtexpTRCDate').val();
            var ddlAddressType = $('#DV_TH_FATCA #ddlAddressType').val();
            var ddlAddressTypeDesc = $('#DV_TH_FATCA #ddlAddressType :selected').text();
            var txtFatcaAdd1 = $('#DV_TH_FATCA #txtFatcaAdd1').val();
            var txtFatcaAdd2 = $('#DV_TH_FATCA #txtFatcaAdd2').val();
            var txtFatcaLandmark = $('#DV_TH_FATCA #txtFatcaLandmark').val();
            var ddlFatcaState = $('#DV_TH_FATCA #ddlFatcaState').val();
            var ddlFatcaStateDesc = $('#DV_TH_FATCA #ddlFatcaState :selected').text();
            var txtFatcaCity = $('#DV_TH_FATCA #txtFatcaCity').val();
            var txtFatcaPostalcode = $('#DV_TH_FATCA #txtFatcaPostalcode').val();
            var txtSTDCodePrimary = $('#DV_TH_FATCA #txtSTDCodePrimary').val();
            var txtTelephoneNumberPrimary = $('#DV_TH_FATCA #txtTelephoneNumberPrimary').val();
            var txtMobileNumberPrimary = $('#DV_TH_FATCA #txtMobileNumberPrimary').val();
            var txtSTDCodeOther = $('#DV_TH_FATCA #txtSTDCodeOther').val();
            var txtTelephoneNumberOther = $('#DV_TH_FATCA #txtTelephoneNumberOther').val();
            var txtMobileNumberOther = $('#DV_TH_FATCA #txtMobileNumberOther').val();

            if (TH_Action == 'ADD')
            {
                var htmlstr = ''
                htmlstr += '<tr class="Key" id="' + TH_CNT + '">';

                htmlstr += '<td class="text-center"><button type="button" id="TH_btnedit' + TH_CNT + '" class="btn btn-orange btn-small btnTblEdit" onclick="TH_tbledit(this,' + TH_CNT + ')">Edit</button></td>';
                htmlstr += "<td class='text-center'><button type='button'  class='btn btn-orange btn-small' onclick='TH_Delete(this)'>Delete</button></td>";
                htmlstr += '<td id="country' + TH_CNT + '" code="' + ddlCountryOfTax + '">' + ddlCountryOfTaxDesc + '</td>';
                htmlstr += '<td id="taxIdentity' + TH_CNT + '"  code="' + ddlTaxIndentityType + '">' + ddlTaxIndentityTypeDesc + '</td>';
                htmlstr += '<td id="tax' + TH_CNT + '">' + txttaxIdentityNo + '</td>';
                htmlstr += '<td id="trcDate' + TH_CNT + '">' + txtexpTRCDate + '</td>';
                htmlstr += '<td id="addressType' + TH_CNT + '" code="' + ddlAddressType + '" >' + ddlAddressTypeDesc + '</td>';
                htmlstr += '<td id="address1' + TH_CNT + '">' + txtFatcaAdd1 + '</td>';
                htmlstr += '<td id="address2' + TH_CNT + '">' + txtFatcaAdd2 + '</td>';
                htmlstr += '<td id="Landmark' + TH_CNT + '">' + txtFatcaLandmark + '</td>';
                htmlstr += '<td id="state' + TH_CNT + '" code="' + ddlFatcaState + '">' + ddlFatcaStateDesc + '</td>';
                htmlstr += '<td id="city' + TH_CNT + '">' + txtFatcaCity + '</td>';
                htmlstr += '<td id="postalcode' + TH_CNT + '">' + txtFatcaPostalcode + '</td>';
                htmlstr += '<td id="stdCodePrimary' + TH_CNT + '">' + txtSTDCodePrimary + '</td>';
                htmlstr += '<td id="telNumberpriamry' + TH_CNT + '">' + txtTelephoneNumberPrimary + '</td>';
                htmlstr += '<td id="MobNumberprimary' + TH_CNT + '">' + txtMobileNumberPrimary + '</td>';
                htmlstr += '<td id="stdCodeother' + TH_CNT + '">' + txtSTDCodeOther + '</td>';
                htmlstr += '<td id="telNumberother' + TH_CNT + '">' + txtTelephoneNumberOther + '</td>';
                htmlstr += '<td id="mobNumberother' + TH_CNT + '">' + txtMobileNumberOther + '</td>';
                htmlstr += '</tr>';
                $('#DV_TH_FATCA #tblDetailList>tbody').append(htmlstr);

                TH_CNT += 1;

            }
            else if (TH_Action == 'Update')
            {

                var value = $('#DV_TH_FATCA #currentRow').text();

                $('#DV_TH_FATCA #country' + value).text(ddlCountryOfTaxDesc);
                $('#DV_TH_FATCA #country' + value).attr('code', ddlCountryOfTax);
                $('#DV_TH_FATCA #taxIdentity' + value).text(ddlTaxIndentityTypeDesc);
                $('#DV_TH_FATCA #taxIdentity' + value).attr('code', ddlTaxIndentityType);
                $('#DV_TH_FATCA #tax' + value).text(txttaxIdentityNo);
                $('#DV_TH_FATCA #trcDate' + value).text(txtexpTRCDate);
                $('#DV_TH_FATCA #address1' + value).text(txtFatcaAdd1);
                $('#DV_TH_FATCA #address2' + value).text(txtFatcaAdd2);
                $('#DV_TH_FATCA #Landmark' + value).text(txtFatcaLandmark);
                $('#DV_TH_FATCA #state' + value).text(ddlFatcaStateDesc);
                $('#DV_TH_FATCA #state' + value).attr('code', ddlFatcaState);
                $('#DV_TH_FATCA #addressType' + value).text(ddlAddressTypeDesc);
                $('#DV_TH_FATCA #addressType' + value).attr('code', ddlAddressType);
                $('#DV_TH_FATCA #city' + value).text(txtFatcaCity);
                $('#DV_TH_FATCA #postalcode' + value).text(txtFatcaPostalcode);
                $('#DV_TH_FATCA #stdCodePrimary' + value).text(txtSTDCodePrimary);
                $('#DV_TH_FATCA #telNumberpriamry' + value).text(txtTelephoneNumberPrimary);
                $('#DV_TH_FATCA #MobNumberprimary' + value).text(txtMobileNumberPrimary);
                $('#DV_TH_FATCA #stdCodeother' + value).text(txtSTDCodeOther);
                $('#DV_TH_FATCA #telNumberother' + value).text(txtTelephoneNumberOther);
                $('#DV_TH_FATCA #mobNumberother' + value).text(txtMobileNumberOther);
                
            }
            TH_clear();
            TH_Action = 'ADD';
        }
        $('#preloader').hide();


    } catch (e)
    {
        fnException(e);
    }
});

function TH_tbledit(btn, cnt)
{
    try
    {
        $('#preloader').show();
        TH_Action = 'Update';

        $('#DV_TH_FATCA #currentRow').text(cnt)
        $('#DV_TH_FATCA #ddlCountryOfTax').val($('#DV_TH_FATCA #country' + cnt).attr('code'));
        $('#DV_TH_FATCA #ddlCountryOfTax').change();
        $('#DV_TH_FATCA #ddlTaxIndentityType').val($('#DV_TH_FATCA #taxIdentity' + cnt).attr('code'));
        $('#DV_TH_FATCA #txttaxIdentityNo').val($('#DV_TH_FATCA #tax' + cnt).html());
        $('#DV_TH_FATCA #txtexpTRCDate').datetextentry('set_date', $('#DV_TH_FATCA #trcDate' + cnt).html());
        $('#DV_TH_FATCA #ddlAddressType').val($('#DV_TH_FATCA #addressType' + cnt).attr('code'));
        $('#DV_TH_FATCA #txtFatcaAdd1').val($('#DV_TH_FATCA #address1' + cnt).html());
        $('#DV_TH_FATCA #txtFatcaAdd2').val($('#DV_TH_FATCA #address2' + cnt).html());
        $('#DV_TH_FATCA #txtFatcaLandmark').val($('#DV_TH_FATCA #Landmark' + cnt).html());
        $('#DV_TH_FATCA #ddlFatcaState').val($('#DV_TH_FATCA #state' + cnt).attr('code'));
        $('#DV_TH_FATCA #txtFatcaCity').val($('#DV_TH_FATCA #city' + cnt).html());
        $('#DV_TH_FATCA #txtFatcaPostalcode').val($('#DV_TH_FATCA #postalcode' + cnt).html());
        $('#DV_TH_FATCA #txtSTDCodePrimary').val($('#DV_TH_FATCA #stdCodePrimary' + cnt).html());
        $('#DV_TH_FATCA #txtTelephoneNumberPrimary').val($('#DV_TH_FATCA #telNumberpriamry' + cnt).html());
        $('#DV_TH_FATCA #txtMobileNumberPrimary').val($('#DV_TH_FATCA #MobNumberprimary' + cnt).html());
        $('#DV_TH_FATCA #txtSTDCodeOther').val($('#DV_TH_FATCA #stdCodeother' + cnt).html());
        $('#DV_TH_FATCA #txtTelephoneNumberOther').val($('#DV_TH_FATCA #telNumberother' + cnt).html());
        $('#DV_TH_FATCA #txtMobileNumberOther').val($('#DV_TH_FATCA #mobNumberother' + cnt).html());
        //$('#ddlCountry option:selected').text($('#country' + cnt).text()));
        $("#DV_TH_FATCA #tblDetailList_default td").val($(btn).closest('tr')).length;
        $('#DV_TH_FATCA #txtSTDCodeOther').val($('#DV_TH_FATCA #stdCodeother' + cnt).html());
        $('#DV_TH_FATCA #currentRow').val($('#DV_TH_FATCA #Key' + cnt).html());

        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

function TH_Delete(btn)
{
    try
    {
        $('#preloader').show();

        $(btn).closest("tr").remove();

        if ($('#DV_TH_FATCA #tblDetailList tbody tr').length == 0)
        {
            $('#DV_TH_FATCA #tblDetailList tbody').html("<tr class='empty_table'><td colspan='19'>No Records Found..!</td></tr>");
        }
        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

function TH_clear()
{
    try
    {
        $('#preloader').show();

        $('#DV_TH_FATCA .fatca').removeClass('InputBorderRed');
        $('#DV_TH_FATCA .fatca').parent().removeClass('InputBorderRed');

        $('#DV_TH_FATCA #ddlCountryOfTax').val('select');
        $('#DV_TH_FATCA #ddlTaxIndentityType').val('select');
        $('#DV_TH_FATCA #txttaxIdentityNo').val('');
        $('#DV_TH_FATCA #ddlAddressType').val('select');
        $('#DV_TH_FATCA #ddlFatcaState').val('select');
        $('#DV_TH_FATCA #txtFatcaAdd1').val('');
        $('#DV_TH_FATCA #txtAddress1_DetailModel').val();
        $('#DV_TH_FATCA #txtFatcaAdd2').val('');
        $('#DV_TH_FATCA #txtFatcaLandmark').val('');
        $('#DV_TH_FATCA #txtFatcaCity').val('');
        $('#DV_TH_FATCA #txtFatcaPostalcode').val('');
        $('#DV_TH_FATCA #txtSTDCodePrimary').val('');
        $('#DV_TH_FATCA #txtTelephoneNumberPrimary').val('');
        $('#DV_TH_FATCA #txtMobileNumberPrimary').val('');
        $('#DV_TH_FATCA #txtSTDCodeOther').val('');
        $('#DV_TH_FATCA #txtTelephoneNumberOther').val('');
        $('#DV_TH_FATCA #txtMobileNumberOther').val('');
        $('#DV_TH_FATCA #txtexpTRCDate').datetextentry('set_date', '');

        $('#preloader').hide();
    } catch (e)
    {
        fnException(e);
    }
}

// validation
function iSTHFATCAValidate()
{
    try
    {
        $('#preloader').show();

        $('#DV_TH_FATCA .fatca').removeClass('InputBorderRed');
        $('#DV_TH_FATCA .fatca').parent().removeClass('InputBorderRed');

        var isError = false;
        var errMessage = "";

        $('#DV_TH_FATCA .fatca').each(function ()
        {
            var $this = $(this);
            if ($this.val() == "" || $this.val() == '-1' || $this.val() == 'Select' || $this.val() == 'select' || $this.val() == undefined)
            {
                if ($this.attr('errmsg') != '' && $this.attr('errmsg') != undefined)
                {
                    errMessage += "<p>" + $this.attr('errmsg'); +"</p>";
                }

                if ($this.hasClass('D_T_E'))
                {
                    $this.parent().addClass('InputBorderRed');
                }
                else
                {
                    $this.addClass('InputBorderRed');
                }
                isError = true;
            }
        });


        $('#DV_TH_FATCA .mobileF').each(function ()
        {
            var $this = $(this);
            if ($this.val() != "" && !IsValidMobile($this.val()))
            {
                errMessage += "<p>Mobile Number is Not Valid.</p>";
                $this.addClass('InputBorderRed');
                isError = true;
            }
        });


        if (isError)
        {
            //$('#dvErrorMsg').html(errMessage);
            //$('#btnOpenModalError').click();
            BtpMessagePopup(errMessage, 'error');
            return false;
        }

        $('#preloader').hide();

        return true;


    } catch (e)
    {
        fnException(e)
    }
}

$("#DV_TH_FATCA #btnOpenDetailModel").click(function ()
{
    $("#DV_TH_FATCA #DV_FATCA_DETAILS").toggle();
});

$('#DV_TH_FATCA #btnFatacClear').click(function ()
{
    TH_clear();
});




var issumo = false;

$(document).ready(function ()
{
    try
    {
        //$(document).on("keydown", disableF5);

        ExtendedAjaxCall('CMS/GET_EXC_CMS_MAPPING_FLAG', null, 'GET', function (result)
        {
            if (!$.isEmptyObject(result) && result[0].status == 1)
            {
                $('#lnkCMSBranchSearch').show();

            } else if (!$.isEmptyObject(result) && result[0].status == 0)
            {
                $('#lnkCMSBranchSearch').hide();

            } else
            {
                BtpMessagePopup('Something went weong.', 'error');
            }
        }, null, null, false, false, ErrorFunction);


        ExtendedAjaxCall('HolderDetails/GetBusinessBrockerCode', null, 'GET', function (result)
        {

            try
            {
                if (!$.isEmptyObject(result))
                {
                    $('#lblBrokerCode').text(result);
                }

                $('#preloader').hide();
            } catch (e)
            {
                fnException(e);
            }
        }, null, true, false, false, ErrorFunction);

        //depositor status
        BindDDLExtendedAjaxCall('#ddlDepositorsStatus', 'FDConfiguration/Get_Depositor_StatusAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        //Search By
        BindDDLExtendedAjaxCall('#ddlInvSearchBy,select[name="SEARCH_BY"]', 'AdditionalPurchase/Get_Folio_Search_Type_MstAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        //branch
        BindDDLExtendedAjaxCall('#ddlBranch', 'HolderDetails/GetBranch', null, 'GET', null, null, true, false, false, ErrorFunction);

        //title
        BindDDLExtendedAjaxCall('select[name="TITLE"]', 'HolderDetails/Get_Salutation_MstAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        //payment mode
        BindDDLExtendedAjaxCall('#ddlInvPayment_Mode', 'FDConfiguration/GetPaymentOptionAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('#ddlDepositPayable', 'DataEntry/Get_DepositPayableAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('#ddlFdrDispatchMode', 'FDConfiguration/Get_FDR_Dispatch_ModeAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('#ddlHNG', 'DataEntry/Get_HNGAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('select[name="GENDER"]', 'DataEntry/Get_Gender_StatusAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('select[name="COUNTRY"]', 'FATCA/Get_ddl_FATCA_CountryAsync', null, 'GET', null, null, true, false, false, ErrorFunction);
        $('select[name="COUNTRY"]').val('IN').change();

        BindDDLExtendedAjaxCall('select[name="MARITAL_STATUS"]', 'DataEntry/Get_Marital_StatusAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('select[name="OCCUPATION"]', 'FATCA/Get_ddl_FATCA_OccupationAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('#ddlNomRelation', 'DataEntry/Get_Investor_Nominee_RelationAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('#ddlHolderType,#ddlDocHolderType', 'DocumentUpload/Get_HolderTypeAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('select[name="NATIONALITY"]', 'FATCA/Get_ddl_FATCA_NationalityAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('#ddlOCountry,select[name="COUNTRY_OF_TAX"]', 'FATCA/Get_ddl_FATCA_CountryOfTaxAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('select[name="TAX_IDENTIFICATION_TYPE"]', 'FATCA/Get_ddl_FATCA_TaxIdentificationTypeAsync', null, 'GET', null, null, true, false, false, ErrorFunction);


        BindDDLExtendedAjaxCall('select[name="ADDRESS_TYPE"]', 'FATCA/Get_ddl_FATCA_AddressTypeAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        BindDDLExtendedAjaxCall('select[name="ANNUAL_INCOME"]', 'DataEntry/Get_Annual_IncomeAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        //BindDDLExtendedAjaxCall('#ddlFilterDocType', 'DocumentUpload_v2/Get_FilterDocTypeAsync', null, 'GET', null, null, true, false, false, ErrorFunction);

        ExtendedAjaxCall('FATCA/Get_ddl_FATCA_CountryAsync', null, 'GET', function (result)
        {
            $('#preloader').hide();

            if (issumo == false)
            {
                var $DD = $('select[name="CITIZENSHIP"]');
                $DD.empty();//.append('<option value="select">Select</option>');

                //BindDropdown1('ddlCitizenShip_CitizenShip', result.data);
                if (result != null && result != undefined && result.length > 0)
                {
                    var html = '';
                    for (var i = 0; i < result.length; i++)
                    {
                        html += '<option value="' + result[i].Code + '">' + result[i].Desc + '</option>';
                    }
                    $DD.append(html);
                }


                $DD.SumoSelect({ search: true, selectAll: true, csvDispCount: 5 });
                issumo = true
            }
        }, null, true, false, false, ErrorFunction);
        ////ddlCitizenShip_CitizenShip multi select

        var data = {
            "SCHEME": null,
            "PERIOD": null,
            "INTEREST_FREQ": null,
            "CATEGORY": null,
            "Mode_Status": 'AF'
        };
        BindDDLExtendedAjaxCall('#ddlCategory', 'FDConfiguration/Get_CategoryAsync', data, 'POST', null, null, true, false, false, ErrorFunction);

        ////$('#show_pan_details_residence').val('YES').change();

        //avinash added Occupation / sub - occupation changes
        BindDDLExtendedAjaxCall('#ddlCustSegType', 'DataEntry/Get_ddl_Occ_CustomerSegType', null, 'GET', null, null, true, false, false, ErrorFunction);

       

        Reset();
    } catch (e)
    {
        fnException(e);
    }
});

function Reset()
{
    try
    {      

        BTP_OBJECT = new BTP();
        $('#lblApplicationType,#lblApplicationNumber,#lblDepositorCategory,#lblInvestorName,#lblDOB,#lblPAN,#lblModeOfPayment,#lblAmount,#lblMobileNumber,#lblEmailID,#lblFolioNumber,#lblExistingFDRNumber,#lblLastInvestmentDate').text();
        $('#hdnApplicationNumber').val('');
        $('select').val('select').change();
        $('input[type="text"]').val('');
        $('input[type="hidden"]').val('');
        $('input[type="radio"]').prop('checked', false);

        BTP_OBJECT.mode = 'R';
        $('#chkSHApplicable').prop('checked', false).change();
        BTP_OBJECT.mode = 'R';
        $('#chkTHApplicable').prop('checked', false).change();
        BTP_OBJECT.mode = 'R';
        $('#chkNomApplicable').prop('checked', false).change();
        $('#chkTDFFlag').prop('checked', false).change();


        BTP_OBJECT.mode = 'R';
        $('#chkFHEdit').prop('checked', false).change();
        BTP_OBJECT.mode = 'R';
        $('#chkSHEdit').prop('checked', false).change();
        BTP_OBJECT.mode = 'R';
        $('#chkTHEdit').prop('checked', false).change();
        BTP_OBJECT.mode = 'R';
        $('#chkNomAddrSameAsFH').prop('checked', false).change();

        $('#btnfreshcutomer').hide();
        $('#addfreshInv').hide();

        Reset_step1();
        Reset_step2();
        Reset_step3();
        Reset_step4();
        //Reset_step5();
        Reset_step6();
        Reset_step7();
        //Reset_step8();

        //Employee categoy not applicable for CPTP
        $('#ddlCategory option[value="EMPLOYEE"]').hide();

        //fdrr dispatch mode option hide
        $('#ddlFdrDispatchMode option[value="D001"]').hide();
        $('#ddlFdrDispatchMode option[value="D002"]').hide();
        $('#ddlFdrDispatchMode option[value="D003"]').hide();
        $('#ddlFdrDispatchMode option[value="REGIS"]').hide();
        $('#ddlFdrDispatchMode option[value="RB"]').hide();

        $('#ddlHolderType').val('01').change();
        //default ONLINE mode
        $('#rdoDigital').prop('checked', true);

        //disable depositor category
        //$('#ddlDepositorsStatus').val('IND').prop('disabled', true).addClass('DisabledControl').change();
        $('#ddlDepositorsStatus option[value="HUF"]').hide();
        $('#ddlDepositorsStatus option[value="TRS"]').hide();
        $('#ddlDepositorsStatus option[value="COM"]').hide();
        $('#ddlDepositorsStatus option[value="PTF"]').hide();
        $('#ddlDepositorsStatus option[value="ASSN"]').hide();

        $('#ddlHolderType option[value="select"]').hide();

        $('.CustmTblTd2lbl, .CustmTblTd3lbl').text('');
        $('#tblInvestmentDtls tbody').html('');


        if (PaymentMode == '1')
        {
            $('#ddlInvPayment_Mode option[value="3"]').hide();
            $('#ddlInvPayment_Mode option[value="4"]').hide();
            $('#ddlInvPayment_Mode option[value="Cheque/DD"]').hide();
            $('#ddlInvPayment_Mode option[value="Cheque"]').hide();
            $('#ddlInvPayment_Mode option[value="Demand Draft"]').hide();
        }
        else if (PaymentMode == '2')
        {
            $('#ddlInvPayment_Mode option[value="1"]').hide()
            $('#ddlInvPayment_Mode option[value="2"]').hide()
            $('#ddlInvPayment_Mode option[value="RTGS/NEFT"]').hide();
            $('#ddlInvPayment_Mode option[value="RTGS / NEFT"]').hide();
            $('#ddlInvPayment_Mode option[value="Online"]').hide();
            $('#ddlInvPayment_Mode').val('Cheque');
        }

        //disable step7
        //$('#IdBtnTabSwit07').prop('disabled', true).addClass('DisabledControl');
        //set India as default country
        $('select[name="COUNTRY"]').val('IN').change();
        BTP_OBJECT.mode = 'A';


    } catch (e)
    {
        fnException(e);
    }
}

$('#ddlBranch').change(function ()
{
    if ($(this).val() == 'select')
    {
        $('#ddlCMSBranch').empty().append('<option value="select">Select</option>');
        return;
    }

    BindDDLExtendedAjaxCall('#ddlCMSBranch', 'CMS/GetCMSBankDetail/' + this.value, null, 'GET', null, null, true, false, false, ErrorFunction);
});

$('#DV_FH_FATCA #ddlCountryOfTax').change(function ()
{
    try
    {

        if ($(this).val() == 'select')
        {
            $('#DV_FH_FATCA #ddlFatcaState').empty().append('<option value="select">Select</option>').change();
            return;
        }

        BindDDLExtendedAjaxCall('#DV_FH_FATCA #ddlFatcaState', 'FATCA/Get_ddl_FATCA_StateAsync?countrycode=' + $(this).val(), null, 'GET', null, null, true, false, false, ErrorFunction);
    } catch (e)
    {
        throw fnException(e);
    }
});

$('#DV_SH_FATCA #ddlCountryOfTax').change(function ()
{
    try
    {

        if ($(this).val() == 'select')
        {
            $('#DV_SH_FATCA #ddlFatcaState').empty().append('<option value="select">Select</option>').change();
            return;
        }

        BindDDLExtendedAjaxCall('#DV_SH_FATCA #ddlFatcaState', 'FATCA/Get_ddl_FATCA_StateAsync?countrycode=' + $(this).val(), null, 'GET', null, null, true, false, false, ErrorFunction);
    } catch (e)
    {
        throw fnException(e);
    }
});

$('#DV_TH_FATCA #ddlCountryOfTax').change(function ()
{
    try
    {

        if ($(this).val() == 'select')
        {
            $('#DV_TH_FATCA #ddlFatcaState').empty().append('<option value="select">Select</option>').change();
            return;
        }

        BindDDLExtendedAjaxCall('#DV_TH_FATCA #ddlFatcaState', 'FATCA/Get_ddl_FATCA_StateAsync?countrycode=' + $(this).val(), null, 'GET', null, null, true, false, false, ErrorFunction);
    } catch (e)
    {
        throw fnException(e);
    }
});


const Renew = function (btn) {
    try {
        BTP_OBJECT.mode = 'R';
        var fdr_no = $(btn).val();

        ExtendedAjaxCall('ApplicationRenewal/GET_APPL_DTLS_FOR_RenewalAsync/' + fdr_no, null, 'GET', function (result) {
            try {

                //document.getElementById('#txtAmount').setAttribute("readonly", "true");
                if (!$.isEmptyObject(result)) {
                    var Appl_No = result.Table[0].Appl_No;
                    // ---------------------------------  Renew Data ------------------- //
                    $('#ddlDepositorsStatus').val('IND').change();
                    $('#hdnApplicationNumber').val(Appl_No);
                    stepper.maxTabIndex = 1;
                    BTP_OBJECT.FH_DATA_SOURCE = result.Table[0].Data_Source;
                    $('#lblAmount').text(result.Table[0].Amount);
                    $('#txtAmount').val(result.Table[0].Amount).focusout()
                    $('#hdnPrincAmount').val(result.Table[0].PRINC_AMT);
                    $('#hdnMatuAmount').val(result.Table[0].MATU_AMT);
                    //$('#lblDepositorCategory').text(result.Table[0].DepositorStatusDesc);

                    InvSearch(result.Table[0].DepositorStatusCode, 'FDR', fdr_no, null, Appl_No);


                    BTP_OBJECT.ApplicationType = 'A';
                    //BTP_OBJECT.IND_NIND = result.Table[0].Ind_Nind;

                    $('#lblApplicationType').text(result.Table[0].ApplicationDeclarationType);
                    //$('#lblInvestorName').text(result.Table[0].InvestorFullName);
                    //$('#lblDOB').text(result.Table[0].Display_DOB);
                    //$('#lblPAN').text(result.Table[0].PAN);

                    //$('#txtInvPan').val(result.Table[0].PAN).change();
                    $('#txtInvCKYCNumber').val(result.Table[0].CKYCNumber);
                    //$('#lblModeOfPayment').text(result.Table[0].ModeOfPayment);

                    // ----- changes done by Gajaan as per shiv communication ----------- //
                    //$('#lblAmount').text(result.Table[0].Amount);



                    //$('#lblMobileNumber').text(result.Table[0].Mobile);
                    //$('#lblEmailID').text(result.Table[0].Email);

                    if (result.Table[0].ApplicationDeclarationType == 'PHYSICAL') {
                        $('#rdoPhysical').prop('checked', true).change();
                    }
                    else if (result.Table[0].ApplicationDeclarationType == 'DIGITAL') {
                        $('#rdoDigital').prop('checked', true).change();
                    }
                    else {
                        $('#rdoDigital').prop('checked', true).change();
                    }
                    $('#txtPhysicalApplNo').val(result.Table[0].Physical_App_No);

                    $('#ddlBranch').val(result.Table[0].Agency_Usr_Branch_Cd).change()

                    $('#txtSubBrokerCode').val('')
                    $('#txtRemark').val(result.Table[0].Remarks)

                    //other details
                    if (!$.isEmptyObject(result.Table1) && result.Table1.length > 0) {
                        $('#txtSubBrokerCode').val(result.Table1[0].Sub_Broker_Code)
                        if (result.Table1[0].IsSecondHolderApplicable == 1)
                            $('#chkSHApplicable').prop('checked', true).change();
                        else
                            $('#chkSHApplicable').prop('checked', false).change();
                        if (result.Table1[0].IsThirdHolderApplicable == 1)
                            $('#chkTHApplicable').prop('checked', true).change();
                        else
                            $('#chkTHApplicable').prop('checked', false).change();
                        if (result.Table1[0].IsNomineeApplicable == 1)
                            $('#chkNomApplicable').prop('checked', true).change();
                        else
                            $('#chkNomApplicable').prop('checked', false).change();
                        if (result.Table1[0].Is_FH_Tax_Resident)
                            $('#btnsldFatca').addClass('active').change();
                        if (result.Table1[0].Is_FH_Green_Card_Holder)
                            $('#btnsldGreen').addClass('active').change();
                        if (result.Table1[0].Is_SH_Tax_Resident)
                            $('#btnSHsldFatca').addClass('active').change();
                        if (result.Table1[0].Is_SH_Green_Card_Holder)
                            $('#btnSHsldGreen').addClass('active').change();
                        if (result.Table1[0].Is_TH_Tax_Resident)
                            $('#btnTHsldFatca').addClass('active').change();
                        if (result.Table1[0].Is_TH_Green_Card_Holder)
                            $('#btnTHsldGreen').addClass('active').change();
                    }

                    //investment
                    if (!$.isEmptyObject(result.Table2) && result.Table2.length > 0) {
                        $('#hdnOldScheme').val(result.Table2[0].Scheme);
                        if (result.Table2[0].Scheme == 'N' || result.Table2[0].Scheme == 'NON-CUMULATIVE') {
                            $('#ddlRenewalFor option[value="F"]').hide();
                        }
                        else {
                            $('#ddlRenewalFor option[value="F"]').show();
                        }

                        $('#spnOldScheme').text(result.Table2[0].Scheme);
                        $('#spnOldIntFreq').text(result.Table2[0].Int_Freq);
                        $('#spnOldTenure').text(result.Table2[0].Tenure);
                        $('#spnOldIntRate').text(result.Table2[0].Int_Rate);



                    }

                    //bank
                    if (!$.isEmptyObject(result.Table3) && result.Table3.length > 0) {
                        BTP_OBJECT.IsProvBank = $.isEmptyObject(result.Table3[0].IsProvBank) ? 0 : result.Table3[0].IsProvBank;
                        $('#txtBankName').val(result.Table3[0].BankName);
                        $('#txtBranchName').val(result.Table3[0].BranchName);
                        $('#txtMICRCode').val(result.Table3[0].MICRCode);
                        $('#txtNEFTCode').val(result.Table3[0].NEFTCode);
                        $('#txtBankAccountNo').val(result.Table3[0].BankAccountNo);
                        $('#txtConfirmBankAccountNo').val(result.Table3[0].BankAccountNo);
                        $('#DV_PROV_BANK').hide();
                        $('#DV_BANK_DTLS').show();
                        $('#DV_OR_ADD_NEW').show();
                    }

                    //KYC Dtl
                    if (!$.isEmptyObject(result.Table4) && result.Table4 != undefined && result.Table4.length > 0) {
                        $.each(result.Table4, function (i, row) {

                            if ($.isEmptyObject(IsDocUploaded()) && BTP_OBJECT.OVDSave == false)
                                $('#IdBtnTabSwit07').prop('disabled', false).removeClass('DisabledControl');

                            //if (row.Holder_Type == '01') {
                            //    if ($.isEmptyObject(IsDocUploaded()) && BTP_OBJECT.OVDSave == false)
                            //        $('#IdBtnTabSwit07').prop('disabled', false).removeClass('DisabledControl');

                            //    $('#DV_FH #ddlMaritalStatus').val(row.Kyc_MaritalStatus).change();
                            //    $('#txtInvCKYC').val(row.Kyc_Number);
                            //    $('#DV_FH #txtCKYCNumber').val(row.Kyc_Number);
                            //    if (!$.isEmptyObject(row.Kyc_FatherFirstName)) {
                            //        $('#DV_FH #ddlFatherTitle').val(row.Kyc_FatherNamePrefix);
                            //        $('#DV_FH #txtFatherFName').val(row.Kyc_FatherFirstName);
                            //        $('#DV_FH #txtFatherMName').val(row.Kyc_FatherMiddleName);
                            //        $('#DV_FH #txtFatherLName').val(row.Kyc_FatherLastName);
                            //    }
                            //    if (!$.isEmptyObject(row.Kyc_MotherFirstName)) {
                            //        $('#DV_FH #ddlMotherTitle').val(row.Kyc_MotherNamePrefix);
                            //        $('#DV_FH #txtMotherFName').val(row.Kyc_MotherFirstName);
                            //        $('#DV_FH #txtMotherMName').val(row.Kyc_MotherMiddletName);
                            //        $('#DV_FH #txtMotherLName').val(row.Kyc_MotherLastName);
                            //    }
                            //    if (!row.IsMinor && row.Kyc_MaritalStatus == '01' && !$.isEmptyObject(row.Kyc_SpouseFirstName)) {
                            //        $('#DV_FH #ddlSpouseTitle').val(row.Kyc_SpouseNamePrefix);
                            //        $('#DV_FH #txtSpouseFName').val(row.Kyc_SpouseFirstName);
                            //        $('#DV_FH #txtSpouseMName').val(row.Kyc_SpouseMiddleName);
                            //        $('#DV_FH #txtSpouseLName').val(row.Kyc_SpouseLastName);
                            //    }
                            //    if (row.IsMinor && row.Kyc_MaritalStatus != '01' && !$.isEmptyObject(row.Kyc_GuardianFirstName)) {
                            //        $('#DV_FH #ddlGuardianTitle').val(row.Kyc_GuardianNamePrefix);
                            //        $('#DV_FH #txtGuardianFName').val(row.Kyc_GuardianFirstName);
                            //        $('#DV_FH #txtGuardianMName').val(row.Kyc_GuardianMiddleName);
                            //        $('#DV_FH #txtGuardianLName').val(row.Kyc_GuardianLastName);
                            //        $('#DV_FH #txtGuardianPAN').val(row.Kyc_Guardian_PAN);
                            //    }
                            //    $('#DV_FH #ddlGender').val(row.Kyc_Gender).change()
                            //    $('#DV_FH #ddlOccupation').val(row.Kyc_Occupation_Code);
                            //    $('#DV_FH #hdnMobilisationMode').val(row.MobilisationMode);
                            //    $('#DV_FH_P_ADDR #txtAdd1').val(row.PER_Address1);
                            //    $('#DV_FH_P_ADDR #txtAdd2').val(row.PER_Address2);
                            //    $('#DV_FH_P_ADDR #txtAdd3').val(row.PER_Address3);
                            //    $('#DV_FH_P_ADDR #ddlCountry').val(row.PER_AddCountry_Code).change();
                            //    $('#DV_FH_P_ADDR #txtCity').val(row.PER_Address_City_Desc);
                            //    $('#DV_FH_P_ADDR #txtPin').val(row.PER_AddPin).keyup();
                            //    $('#DV_FH_P_ADDR #txtState').val(row.PER_AddState_Desc);
                            //    $('#DV_FH_P_ADDR #txtDistrict').val(row.PER_Address_District_Desc);
                            //    $('#DV_FH_P_ADDR #txtTelephone').val(row.PER_ResTelNumber);
                            //    $('#DV_FH #ddlAnnualIncome').val(row.Kyc_AnnualIncome_Code);

                            //    if (!$.isEmptyObject(row.MAIL_Address1)) {
                            //        $('#DV_FH_M_ADDR #txtAdd1').val(row.MAIL_Address1);
                            //        $('#DV_FH_M_ADDR #txtAdd2').val(row.MAIL_Address2);
                            //        $('#DV_FH_M_ADDR #txtAdd3').val(row.MAIL_Address3);
                            //        $('#DV_FH_M_ADDR #ddlCountry').val(row.MAIL_AddCountry_Code).change();
                            //        $('#DV_FH_M_ADDR #txtCity').val(row.MAIL_Address_City_Desc);
                            //        $('#DV_FH_M_ADDR #txtPin').val(row.MAIL_AddPin).keyup();
                            //        $('#DV_FH_M_ADDR #txtState').val(row.MAIL_AddState_Desc);
                            //        $('#DV_FH_M_ADDR #txtDistrict').val(row.MAIL_Address_District_Desc);
                            //    }

                            //    if (!$.isEmptyObject(row.OVR_Address1)) {
                            //        $('#chkIdOverSeasAddress').prop('checked', true).change();
                            //        $('#txtOAdd1').val(row.OVR_Address1);
                            //        $('#txtOAdd2').val(row.OVR_Address2);
                            //        $('#txtOAdd3').val(row.OVR_Address3);
                            //        $('#ddlOCountry').val(row.OVR_AddCountry_Code).change();
                            //        $('#txtOState').val(row.OVR_AddState_Code);
                            //        $('#txtOCity').val(row.OVR_Address_City_Desc);
                            //        $('#txtOPin').val(row.OVR_AddPin);

                            //    }
                            //}

                            ////Second holder
                            //if (row.Holder_Type == '02' && $('#chkSHApplicable').prop('checked')) {
                            //    BTP_OBJECT.SH_DATA_SOURCE = result.Table[0].Data_Source;

                            //    if (!$.isEmptyObject(row.SourceTableId))
                            //        GetProvSH(row.SourceTableId)
                            //    else if (!$.isEmptyObject(row.FolioNo))
                            //        SHSearch('Folio', row.FolioNo, null, Appl_No);
                            //    $('#DV_SH #ddlMaritalStatus').val(row.Kyc_MaritalStatus).change();
                            //    $('#txtSHDOB').datetextentry('set_date', row.Kyc_DOB);
                            //    SHDOBChange();
                            //    $('#DV_SH #txtCKYCNumber').val(row.Kyc_Number);
                            //    $('#DV_SH #ddlTitle').val(row.Kyc_NamePrefix);
                            //    $('#DV_SH #txtFName').val(row.Kyc_FirstName).change();
                            //    $('#DV_SH #txtMName').val(row.Kyc_MiddleName);
                            //    $('#DV_SH #txtLName').val(row.Kyc_LastName);
                            //    if (!$.isEmptyObject(row.Kyc_FatherFirstName)) {
                            //        $('#DV_SH #ddlFatherTitle').val(row.Kyc_FatherNamePrefix);
                            //        $('#DV_SH #txtFatherFName').val(row.Kyc_FatherFirstName);
                            //        $('#DV_SH #txtFatherMName').val(row.Kyc_FatherMiddleName);
                            //        $('#DV_SH #txtFatherLName').val(row.Kyc_FatherLastName);
                            //    }
                            //    if (!$.isEmptyObject(row.Kyc_MotherFirstName)) {
                            //        $('#DV_SH #ddlMotherTitle').val(row.Kyc_MotherNamePrefix);
                            //        $('#DV_SH #txtMotherFName').val(row.Kyc_MotherFirstName).change();
                            //        $('#DV_SH #txtMotherMName').val(row.Kyc_MotherMiddletName);
                            //        $('#DV_SH #txtMotherLName').val(row.Kyc_MotherLastName);
                            //    }
                            //    if (!row.IsMinor && row.Kyc_MaritalStatus == '01' && !$.isEmptyObject(row.Kyc_SpouseFirstName)) {
                            //        $('#DV_SH #ddlSpouseTitle').val(row.Kyc_SpouseNamePrefix);
                            //        $('#DV_SH #txtSpouseFName').val(row.Kyc_SpouseFirstName);
                            //        $('#DV_SH #txtSpouseMName').val(row.Kyc_SpouseMiddleName);
                            //        $('#DV_SH #txtSpouseLName').val(row.Kyc_SpouseLastName);
                            //    }
                            //    if (row.IsMinor && row.Kyc_MaritalStatus != '01' && !$.isEmptyObject(row.Kyc_GuardianFirstName)) {
                            //        $('#DV_SH #ddlGuardianTitle').val(row.Kyc_GuardianNamePrefix);
                            //        $('#DV_SH #txtGuardianFName').val(row.Kyc_GuardianFirstName);
                            //        $('#DV_SH #txtGuardianMName').val(row.Kyc_GuardianMiddleName);
                            //        $('#DV_SH #txtGuardianLName').val(row.Kyc_GuardianLastName);
                            //        $('#DV_SH #txtGuardianPAN').val(row.Kyc_Guardian_PAN);
                            //    }
                            //    $('#DV_SH #ddlGender').val(row.Kyc_Gender);
                            //    $('#DV_SH #ddlOccupation').val(row.Kyc_Occupation_Code);
                            //    $('#DV_SH #txtPAN').val(row.Kyc_PAN);
                            //    $('#DV_SH #hdnMobilisationMode').val(row.MobilisationMode);
                            //    $('#DV_SH_P_ADDR #txtAdd1').val(row.PER_Address1);
                            //    $('#DV_SH_P_ADDR #txtAdd2').val(row.PER_Address2);
                            //    $('#DV_SH_P_ADDR #txtAdd3').val(row.PER_Address3);
                            //    $('#DV_SH_P_ADDR #ddlCountry').val(row.PER_AddCountry_Code).change();
                            //    $('#DV_SH_P_ADDR #txtCity').val(row.PER_Address_City_Desc);
                            //    $('#DV_SH_P_ADDR #txtPin').val(row.PER_AddPin).keyup();
                            //    $('#DV_SH_P_ADDR #txtState').val(row.PER_AddState_Desc);
                            //    $('#DV_SH_P_ADDR #txtDistrict').val(row.PER_Address_District_Desc);
                            //    $('#DV_SH_P_ADDR #txtTelephone').val(row.PER_ResTelNumber);
                            //    $('#DV_SH_P_ADDR #txtMobileNo').val(row.PER_MobileNumber);
                            //    $('#DV_SH_P_ADDR #txtEmailId').val(row.PER_EmailAdd);
                            //    $('#DV_SH #ddlAnnualIncome').val(row.Kyc_AnnualIncome_Code);

                            //    if (!$.isEmptyObject(row.MAIL_Address1)) {
                            //        $('#DV_SH_M_ADDR #txtAdd1').val(row.MAIL_Address1);
                            //        $('#DV_SH_M_ADDR #txtAdd2').val(row.MAIL_Address2);
                            //        $('#DV_SH_M_ADDR #txtAdd3').val(row.MAIL_Address3);
                            //        $('#DV_SH_M_ADDR #ddlCountry').val(row.MAIL_AddCountry_Code).change();
                            //        $('#DV_SH_M_ADDR #txtCity').val(row.MAIL_Address_City_Desc);
                            //        $('#DV_SH_M_ADDR #txtPin').val(row.MAIL_AddPin).keyup();
                            //        $('#DV_SH_M_ADDR #txtState').val(row.MAIL_AddState_Desc);
                            //        $('#DV_SH_M_ADDR #txtDistrict').val(row.MAIL_Address_District_Desc);
                            //    }

                            //    if (BTP_OBJECT.SH_DATA_SOURCE == 'CKYC')
                            //        SH_CKYC_Validations();
                            //    $('#DV_PROV_SH').hide();
                            //    $('#DV_SH_SEARCH').hide();
                            //    $('#DV_SH_DTLS').show();
                            //}

                            ////Third holder
                            //if ($('#chkSHApplicable').prop('checked') && row.Holder_Type == '03' && $('#chkTHApplicable').prop('checked')) {
                            //    BTP_OBJECT.TH_DATA_SOURCE = result.Table[0].Data_Source;

                            //    if (!$.isEmptyObject(row.SourceTableId))
                            //        GetProvTH(row.SourceTableId)
                            //    else if (!$.isEmptyObject(row.FolioNo))
                            //        THSearch('Folio', row.FolioNo, null, Appl_No);
                            //    $('#DV_TH #ddlMaritalStatus').val(row.Kyc_MaritalStatus).change();
                            //    $('#DV_TH #txtDOB').datetextentry('set_date', row.Kyc_DOB);
                            //    THDOBChange();
                            //    $('#DV_TH #txtCKYCNumber').val(row.Kyc_Number);
                            //    $('#DV_TH #ddlTitle').val(row.Kyc_NamePrefix);
                            //    $('#DV_TH #txtFName').val(row.Kyc_FirstName);
                            //    $('#DV_TH #txtMName').val(row.Kyc_MiddleName);
                            //    $('#DV_TH #txtLName').val(row.Kyc_LastName);
                            //    if (!$.isEmptyObject(row.Kyc_FatherFirstName)) {
                            //        $('#DV_TH #ddlFatherTitle').val(row.Kyc_FatherNamePrefix);
                            //        $('#DV_TH #txtFatherFName').val(row.Kyc_FatherFirstName);
                            //        $('#DV_TH #txtFatherMName').val(row.Kyc_FatherMiddleName);
                            //        $('#DV_TH #txtFatherLName').val(row.Kyc_FatherLastName);
                            //    }
                            //    if (!$.isEmptyObject(row.Kyc_MotherFirstName)) {
                            //        $('#DV_TH #ddlMotherTitle').val(row.Kyc_MotherNamePrefix);
                            //        $('#DV_TH #txtMotherFName').val(row.Kyc_MotherFirstName);
                            //        $('#DV_TH #txtMotherMName').val(row.Kyc_MotherMiddletName);
                            //        $('#DV_TH #txtMotherLName').val(row.Kyc_MotherLastName);
                            //    }
                            //    if (!row.IsMinor && row.Kyc_MaritalStatus == '01' && !$.isEmptyObject(row.Kyc_SpouseFirstName)) {
                            //        $('#DV_TH #ddlSpouseTitle').val(row.Kyc_SpouseNamePrefix);
                            //        $('#DV_TH #txtSpouseFName').val(row.Kyc_SpouseFirstName);
                            //        $('#DV_TH #txtSpouseMName').val(row.Kyc_SpouseMiddleName);
                            //        $('#DV_TH #txtSpouseLName').val(row.Kyc_SpouseLastName);
                            //    }
                            //    if (row.IsMinor && row.Kyc_MaritalStatus != '01' && !$.isEmptyObject(row.Kyc_GuardianFirstName)) {
                            //        $('#DV_TH #ddlGuardianTitle').val(row.Kyc_GuardianNamePrefix);
                            //        $('#DV_TH #txtGuardianFName').val(row.Kyc_GuardianFirstName);
                            //        $('#DV_TH #txtGuardianMName').val(row.Kyc_GuardianMiddleName);
                            //        $('#DV_TH #txtGuardianLName').val(row.Kyc_GuardianLastName);
                            //        $('#DV_TH #txtGuardianPAN').val(row.Kyc_Guardian_PAN);
                            //    }
                            //    $('#DV_TH #ddlGender').val(row.Kyc_Gender);
                            //    $('#DV_TH #ddlOccupation').val(row.Kyc_Occupation_Code);
                            //    $('#DV_TH #txtPAN').val(row.Kyc_PAN);
                            //    $('#DV_TH #hdnMobilisationMode').val(row.MobilisationMode);
                            //    $('#DV_TH_P_ADDR #txtAdd1').val(row.PER_Address1);
                            //    $('#DV_TH_P_ADDR #txtAdd2').val(row.PER_Address2);
                            //    $('#DV_TH_P_ADDR #txtAdd3').val(row.PER_Address3);
                            //    $('#DV_TH_P_ADDR #ddlCountry').val(row.PER_AddCountry_Code).change();
                            //    $('#DV_TH_P_ADDR #txtCity').val(row.PER_Address_City_Desc);
                            //    $('#DV_TH_P_ADDR #txtPin').val(row.PER_AddPin).keyup();
                            //    $('#DV_TH_P_ADDR #txtState').val(row.PER_AddState_Desc);
                            //    $('#DV_TH_P_ADDR #txtDistrict').val(row.PER_Address_District_Desc);
                            //    $('#DV_TH_P_ADDR #txtTelephone').val(row.PER_ResTelNumber);
                            //    $('#DV_TH_P_ADDR #txtMobileNo').val(row.PER_MobileNumber);
                            //    $('#DV_TH_P_ADDR #txtEmailId').val(row.PER_EmailAdd);
                            //    $('#DV_TH #ddlAnnualIncome').val(row.Kyc_AnnualIncome_Code);

                            //    if (!$.isEmptyObject(row.MAIL_Address1)) {
                            //        $('#DV_TH_M_ADDR #txtAdd1').val(row.MAIL_Address1);
                            //        $('#DV_TH_M_ADDR #txtAdd2').val(row.MAIL_Address2);
                            //        $('#DV_TH_M_ADDR #txtAdd3').val(row.MAIL_Address3);
                            //        $('#DV_TH_M_ADDR #ddlCountry').val(row.MAIL_AddCountry_Code).change();
                            //        $('#DV_TH_M_ADDR #txtCity').val(row.MAIL_Address_City_Desc);
                            //        $('#DV_TH_M_ADDR #txtPin').val(row.MAIL_AddPin).keyup();
                            //        $('#DV_TH_M_ADDR #txtState').val(row.MAIL_AddState_Desc);
                            //        $('#DV_TH_M_ADDR #txtDistrict').val(row.MAIL_Address_District_Desc);
                            //    }

                            //    if (BTP_OBJECT.TH_DATA_SOURCE == 'CKYC')
                            //        TH_CKYC_Validations();
                            //    $('#DV_PROV_TH').hide();
                            //    $('#DV_TH_SEARCH').hide();
                            //    $('#DV_TH_DTLS').show();
                            //}

                            //Nominee
                            if (row.Holder_Type == '04' && $('#chkNomApplicable').prop('checked')) {
                                if ($.isEmptyObject(IsDocUploaded()) && BTP_OBJECT.OVDSave == false)
                                    $('#IdBtnTabSwit07').prop('disabled', false).removeClass('DisabledControl');

                                $("#ddlNomTitle").val(row.Kyc_NamePrefix);
                                $("#txtNomFName").val(row.Kyc_FirstName);
                                $("#txtNomMName").val(row.Kyc_MiddleName);
                                $("#txtNomLName").val(row.Kyc_LastName);
                                $("#ddlNomRelation").val(row.Nominee_Relations);
                                if (row.Kyc_DOB != null)
                                    $("#txtNomDOB").datetextentry('set_date', row.Kyc_DOB);
                                $('#DV_NOM #txtAdd1').val(row.PER_Address1);
                                $('#DV_NOM #txtAdd2').val(row.PER_Address2);
                                $('#DV_NOM #txtAdd3').val(row.PER_Address3);
                                $('#DV_NOM #ddlCountry').val(row.PER_AddCountry_Code).change();
                                $('#DV_NOM #txtCity').val(row.PER_Address_City_Desc);
                                $('#DV_NOM #txtPin').val(row.PER_AddPin).change();
                                $('#DV_NOM #txtState').val(row.PER_AddState_Desc).change();
                                $('#DV_NOM #txtDistrict').val(row.PER_Address_District_Desc).change();
                                $('#DV_NOM #txtTelephone').val(row.PER_ResTelNumber);
                                $('#DV_NOM #txtMobileNo').val(row.PER_MobileNumber);
                                $('#DV_NOM #txtEmailId').val(row.PER_EmailAdd);
                                if (row.IsMinor && !$.isEmptyObject(row.Kyc_GuardianFirstName)) {
                                    $('#chkIsNomMinor').prop('checked', true)
                                        .change();
                                    $("#ddlNomGuardianTitle").val(row.Kyc_GuardianNamePrefix);
                                    $("#txtNomGuardianFName").val(row.Kyc_GuardianFirstName);
                                    $("#txtNomGuardianMName").val(row.Kyc_GuardianMiddleName);
                                    $("#txtNomGuardianLName").val(row.Kyc_GuardianLastName);
                                }

                                $('#DV_PROV_NOM').hide();
                                $('#DV_NOM_DTLS').show();
                            }
                        });
                    }

                    //Fatca Citizenship
                    if (!$.isEmptyObject(result.Table5) && result.Table5.length > 0) {
                        $.each(result.Table5, function (i, row) {
                            if (row.HolderType == '01')
                                $('#DV_FH_FATCA #ddlCitizenShip_CitizenShip')[0].sumo.selectItem(row.Citizen_Country_Code);
                            if (row.HolderType == '02')
                                $('#DV_SH_FATCA #ddlCitizenShip_CitizenShip')[0].sumo.selectItem(row.Citizen_Country_Code);
                            if (row.HolderType == '03')
                                $('#DV_TH_FATCA #ddlCitizenShip_CitizenShip')[0].sumo.selectItem(row.Citizen_Country_Code);
                        });
                    }

                    //Fatca Hdr
                    if (!$.isEmptyObject(result.Table6) && result.Table6.length > 0) {
                        $.each(result.Table6, function (i, FatcaHeader) {
                            var FatcaHeader = result.Table6[0];

                            if (FatcaHeader.HolderType == '01') {
                                $('#DV_FH_FATCA #ddlNationalityH').val(FatcaHeader.Nationality_Code);
                                $('#DV_FH_FATCA #ddlcountryBirthHead').val(FatcaHeader.CountryOfBirth_Code);
                                $('#DV_FH_FATCA #txtcityBirthHead').val(FatcaHeader.CityOfBirth_Name);
                                $('#DV_FH_FATCA #txtFathernameHead').val(FatcaHeader.Father_Name);
                                $('#DV_FH_FATCA #txtSpousenameHead').val(FatcaHeader.Spouse_Name);
                                $('#DV_FH_FATCA #ddloccupationHead').val(FatcaHeader.Occupation_code);
                            }

                            if (FatcaHeader.HolderType == '02') {
                                $('#DV_SH_FATCA #ddlNationalityH').val(FatcaHeader.Nationality_Code);
                                $('#DV_SH_FATCA #ddlcountryBirthHead').val(FatcaHeader.CountryOfBirth_Code);
                                $('#DV_SH_FATCA #txtcityBirthHead').val(FatcaHeader.CityOfBirth_Name);
                                $('#DV_SH_FATCA #txtFathernameHead').val(FatcaHeader.Father_Name);
                                $('#DV_SH_FATCA #txtSpousenameHead').val(FatcaHeader.Spouse_Name);
                                $('#DV_SH_FATCA #ddloccupationHead').val(FatcaHeader.Occupation_code);
                            }

                            if (FatcaHeader.HolderType == '03') {
                                $('#DV_TH_FATCA #ddlNationalityH').val(FatcaHeader.Nationality_Code);
                                $('#DV_TH_FATCA #ddlcountryBirthHead').val(FatcaHeader.CountryOfBirth_Code);
                                $('#DV_TH_FATCA #txtcityBirthHead').val(FatcaHeader.CityOfBirth_Name);
                                $('#DV_TH_FATCA #txtFathernameHead').val(FatcaHeader.Father_Name);
                                $('#DV_TH_FATCA #txtSpousenameHead').val(FatcaHeader.Spouse_Name);
                                $('#DV_TH_FATCA #ddloccupationHead').val(FatcaHeader.Occupation_code);
                            }
                        });
                    }

                    //Fatca Dtl
                    if (!$.isEmptyObject(result.Table7) && result.Table7.length > 0) {

                        var FH_counter = 1;
                        var SH_counter = 1;
                        var TH_counter = 1;
                        $('#DV_FH_FATCA #tblDetailList > tbody').empty();
                        $('#DV_SH_FATCA #tblDetailList > tbody').empty();
                        $('#DV_TH_FATCA #tblDetailList > tbody').empty();

                        $.each(result.Table7, function (i, row) {
                            var FH_htmlstr = ''
                            var SH_htmlstr = ''
                            var TH_htmlstr = ''

                            if (row.HolderType == '01') {
                                FH_htmlstr += '<tr class="Key" id="' + FH_counter + '">';

                                FH_htmlstr += '<td class="text-center"><button type="button" id="btnedit' + FH_counter + '" class="btn btn-orange btn-small btnTblEdit" onclick="FH_tbledit(this,' + FH_counter + ')">Edit</button></td>';
                                FH_htmlstr += "<td class='text-center'><button type='button'  class='btn btn-orange btn-small' onclick='Delete(this)'>Delete</button></td>";
                                FH_htmlstr += '<td id="country' + FH_counter + '" code="' + row.TaxResident_CountryCode + '">' + row.TaxResident_CountryName + '</td>';
                                FH_htmlstr += '<td id="taxIdentity' + FH_counter + '"  code="' + row.TaxIdentificationTypeCode + '">' + row.TaxIdentificationTypeDec + '</td>';
                                FH_htmlstr += '<td id="tax' + FH_counter + '">' + row.TaxIdentificationNumber + '</td>';
                                FH_htmlstr += '<td id="trcDate' + FH_counter + '">' + row.TRCExpiryDate + '</td>';
                                FH_htmlstr += '<td id="addressType' + FH_counter + '" code="' + row.Address_TypeCode + '" >' + row.Address_TypeDesc + '</td>';
                                FH_htmlstr += '<td id="address1' + FH_counter + '">' + row.Address1 + '</td>';
                                FH_htmlstr += '<td id="address2' + FH_counter + '">' + row.Address2 + '</td>';
                                FH_htmlstr += '<td id="Landmark' + FH_counter + '">' + row.Landmark + '</td>';
                                FH_htmlstr += '<td id="state' + FH_counter + '" code="' + row.State_Code + '">' + row.State_Name + '</td>';
                                FH_htmlstr += '<td id="city' + FH_counter + '">' + row.City + '</td>';
                                FH_htmlstr += '<td id="postalcode' + FH_counter + '">' + row.Postalcode + '</td>';
                                FH_htmlstr += '<td id="stdCodePrimary' + FH_counter + '">' + row.STD_Code_Primary + '</td>';
                                FH_htmlstr += '<td id="telNumberpriamry' + FH_counter + '">' + row.Telephone_Number_Primary + '</td>';
                                FH_htmlstr += '<td id="MobNumberprimary' + FH_counter + '">' + row.Mobile_Number_Primary + '</td>';
                                FH_htmlstr += '<td id="stdCodeother' + FH_counter + '">' + row.STD_Code_Other + '</td>';
                                FH_htmlstr += '<td id="telNumberother' + FH_counter + '">' + row.Telephone_Number_Other + '</td>';
                                FH_htmlstr += '<td id="mobNumberother' + FH_counter + '">' + row.Mobile_Number_Other + '</td>';
                                FH_htmlstr += '</tr>';
                                $('#DV_FH_FATCA #tblDetailList > tbody').append(FH_htmlstr);

                                FH_counter += 1;
                            }

                            if (row.HolderType == '02') {
                                SH_htmlstr += '<tr class="Key" id="' + SH_counter + '">';

                                SH_htmlstr += '<td class="text-center"><button type="button" id="btnedit' + SH_counter + '" class="btn btn-orange btn-small btnTblEdit" onclick="FH_tbledit(this,' + SH_counter + ')">Edit</button></td>';
                                SH_htmlstr += "<td class='text-center'><button type='button'  class='btn btn-orange btn-small' onclick='Delete(this)'>Delete</button></td>";
                                SH_htmlstr += '<td id="country' + SH_counter + '" code="' + row.TaxResident_CountryCode + '">' + row.TaxResident_CountryName + '</td>';
                                SH_htmlstr += '<td id="taxIdentity' + SH_counter + '"  code="' + row.TaxIdentificationTypeCode + '">' + row.TaxIdentificationTypeDec + '</td>';
                                SH_htmlstr += '<td id="tax' + SH_counter + '">' + row.TaxIdentificationNumber + '</td>';
                                SH_htmlstr += '<td id="trcDate' + SH_counter + '">' + row.TRCExpiryDate + '</td>';
                                SH_htmlstr += '<td id="addressType' + SH_counter + '" code="' + row.Address_TypeCode + '" >' + row.Address_TypeDesc + '</td>';
                                SH_htmlstr += '<td id="address1' + SH_counter + '">' + row.Address1 + '</td>';
                                SH_htmlstr += '<td id="address2' + SH_counter + '">' + row.Address2 + '</td>';
                                SH_htmlstr += '<td id="Landmark' + SH_counter + '">' + row.Landmark + '</td>';
                                SH_htmlstr += '<td id="state' + SH_counter + '" code="' + row.State_Code + '">' + row.State_Name + '</td>';
                                SH_htmlstr += '<td id="city' + SH_counter + '">' + row.City + '</td>';
                                SH_htmlstr += '<td id="postalcode' + SH_counter + '">' + row.Postalcode + '</td>';
                                SH_htmlstr += '<td id="stdCodePrimary' + SH_counter + '">' + row.STD_Code_Primary + '</td>';
                                SH_htmlstr += '<td id="telNumberpriamry' + SH_counter + '">' + row.Telephone_Number_Primary + '</td>';
                                SH_htmlstr += '<td id="MobNumberprimary' + SH_counter + '">' + row.Mobile_Number_Primary + '</td>';
                                SH_htmlstr += '<td id="stdCodeother' + SH_counter + '">' + row.STD_Code_Other + '</td>';
                                SH_htmlstr += '<td id="telNumberother' + SH_counter + '">' + row.Telephone_Number_Other + '</td>';
                                SH_htmlstr += '<td id="mobNumberother' + SH_counter + '">' + row.Mobile_Number_Other + '</td>';
                                SH_htmlstr += '</tr>';
                                $('#DV_SH_FATCA #tblDetailList > tbody').append(SH_htmlstr);

                                SH_counter += 1;
                            }

                            if (row.HolderType == '03') {
                                TH_htmlstr += '<tr class="Key" id="' + TH_counter + '">';

                                TH_htmlstr += '<td class="text-center"><button type="button" id="btnedit' + TH_counter + '" class="btn btn-orange btn-small btnTblEdit" onclick="FH_tbledit(this,' + TH_counter + ')">Edit</button></td>';
                                TH_htmlstr += "<td class='text-center'><button type='button'  class='btn btn-orange btn-small' onclick='Delete(this)'>Delete</button></td>";
                                TH_htmlstr += '<td id="country' + TH_counter + '" code="' + row.TaxResident_CountryCode + '">' + row.TaxResident_CountryName + '</td>';
                                TH_htmlstr += '<td id="taxIdentity' + TH_counter + '"  code="' + row.TaxIdentificationTypeCode + '">' + row.TaxIdentificationTypeDec + '</td>';
                                TH_htmlstr += '<td id="tax' + TH_counter + '">' + row.TaxIdentificationNumber + '</td>';
                                TH_htmlstr += '<td id="trcDate' + TH_counter + '">' + row.TRCExpiryDate + '</td>';
                                TH_htmlstr += '<td id="addressType' + TH_counter + '" code="' + row.Address_TypeCode + '" >' + row.Address_TypeDesc + '</td>';
                                TH_htmlstr += '<td id="address1' + TH_counter + '">' + row.Address1 + '</td>';
                                TH_htmlstr += '<td id="address2' + TH_counter + '">' + row.Address2 + '</td>';
                                TH_htmlstr += '<td id="Landmark' + TH_counter + '">' + row.Landmark + '</td>';
                                TH_htmlstr += '<td id="state' + TH_counter + '" code="' + row.State_Code + '">' + row.State_Name + '</td>';
                                TH_htmlstr += '<td id="city' + TH_counter + '">' + row.City + '</td>';
                                TH_htmlstr += '<td id="postalcode' + TH_counter + '">' + row.Postalcode + '</td>';
                                TH_htmlstr += '<td id="stdCodePrimary' + TH_counter + '">' + row.STD_Code_Primary + '</td>';
                                TH_htmlstr += '<td id="telNumberpriamry' + TH_counter + '">' + row.Telephone_Number_Primary + '</td>';
                                TH_htmlstr += '<td id="MobNumberprimary' + TH_counter + '">' + row.Mobile_Number_Primary + '</td>';
                                TH_htmlstr += '<td id="stdCodeother' + TH_counter + '">' + row.STD_Code_Other + '</td>';
                                TH_htmlstr += '<td id="telNumberother' + TH_counter + '">' + row.Telephone_Number_Other + '</td>';
                                TH_htmlstr += '<td id="mobNumberother' + TH_counter + '">' + row.Mobile_Number_Other + '</td>';
                                TH_htmlstr += '</tr>';
                                $('#DV_TH_FATCA #tblDetailList > tbody').append(TH_htmlstr);

                                TH_counter += 1;
                            }

                        });
                    }

                    if (!$.isEmptyObject(result.Table8) && result.Table8.length > 0)
                        BindOVD(Appl_No);

                    else {
                        $('#DV_FH_FATCA #tblDetailList tbody').html("");
                        $('#DV_SH_FATCA #tblDetailList tbody').html("");
                        $('#DV_TH_FATCA #tblDetailList tbody').html("");
                    }


                    $('.form-control').each(function myfunction() {
                        if (!$.isEmptyObject(this.value))
                            $(this).removeClass('InputBorderRed');
                        else if ($(this).prop('required'))
                            $(this).addClass('InputBorderRed');
                    });

                    if (BTP_OBJECT.FH_DATA_SOURCE == 'CKYC')
                        FH_CKYC_Validations();

                    $('#DV_APPL_EDIT').slideUp();
                    $('#btnfreshcutomer').hide();
                    $('#addfreshInv').hide();
                    $('#IdInfoDiv').slideDown();
                    $('#IdInvestorSearch').hide();
                    $('#DV_FH_CKYC_SEARCH').hide();
                    $('#DV_INV_DETAILS').show();
                    $('#IdInvestorInfo').slideDown();
                    $('#DV_DATAENTRY').slideDown();
                    $('#DV_IMPNote').slideUp();
                    $('#divSearch').slideUp();

                }

                else if (!$.isEmptyObject(result) && result.Table.length > 0 && result.Table[0].Status == 0) {
                    if (!$.isEmptyObject(result.Table[0].Msg)) {
                        BtpMessagePopup(result.Table[0].Msg, 'error');
                    }
                    else {
                        BtpMessagePopup('', 'error');
                    }
                }

                else {
                    BtpMessagePopup('', 'error');
                }

                $('#preloader').hide();

            }
            catch (e) {
                fnException(e)
            }
        }, null, null, false, false, ErrorFunction);

        BTP_OBJECT.mode = 'A';

    } catch (e) {
        fnException(e);
    }
}

const Clear = function () {
    $('#tblRequestData tbody').html('<tr style="text-align:center"><td colspan="11">No data available in table</td></tr>');
}

$(document).ready(function () {
    $('#DV_MSG_CENTER').show();
    $('#divGetDetails').hide();
    Clear();
});

function Reset_step1() {
    $('.errorbox').text('').hide();
    $('.form-control').removeClass('InputBorderRed');
    $('.D_T_E').removeClass('InputBorderRed');

    if (!$.isEmptyObject($('#lblApplicationNumber').text())) {
        if (BTP_OBJECT.ApplicationType == 'F') {
            $('#rdoPhysical,#rdoDigital').prop('checked', false);

            if (!$('#ddlInvtitle').prop('disabled')) {
                $('#ddlInvtitle').val('select').change();
            }

            if (!$('#txtInvFirstName').prop('disabled')) {
                $('#txtInvFirstName').val('').change();
            }

            if (!$('#txtInvMiddleName').prop('disabled')) {
                $('#txtInvMiddleName').val('').change();
            }

            if (!$('#txtInvLastName').prop('disabled')) {
                $('#txtInvLastName').val('').change();
            }

            if (!$('#txtInvPan').prop('disabled')) {
                $('#txtInvPan').val('').change();
            }

            if (!$('#txtMobile').prop('disabled')) {
                $('#txtMobile').val('').change();
            }

            if (!$('#txtEmail').prop('disabled')) {
                $('#txtEmail').val('').change();
            }
        }
        else {
            $('#txtInvDOB').datetextentry('set_date', null);
        }
    }
    else {

    }
    $('#txtInvDrawn_Bank_Search,#hdnDrawn_Bank_Name,#hdnBank_Branch_Name,#hdnBank_MICR,#hdnBank_NEFT,#txtInvCheque_DD_No,#txtPhysicalApplNo,#txtSubBrokerCode,#txtRemark').val('');
    $('#ddlBranch,#ddlCMSBranch').val('select').change();
    $('#txtChequeDate').datetextentry('set_date', null);
    //$('#txtamountinwords').text('');
    $('#txtPhysicalApplNo').val('0000');
}

//step1 submit
function SubmitStep1() {
    try {
        let err_msg = isValidStep1();
        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, 'error');
            return false;
        }

        let objFrontOffice = getStep1Data();

        ExtendedAjaxCall('RenewInvestorDetailsSave/SubmitStep1Copy', objFrontOffice, 'POST', function (result) {
            try {



                if (!$.isEmptyObject(result) && result[0].Status == 1 && !$.isEmptyObject(result[0].Msg)) {
                    BTP_OBJECT.FrontOfficeSave = true;
                    if ($.isEmptyObject($('#lblApplicationNumber').text().trim()))
                        BtpMessagePopup(result[0].Msg, "success");
                    $('#hdnApplicationNumber').val(result[0].Appl_No);
                    $('#lblApplicationNumber').text(result[0].Appl_No);
                }
                else if (!$.isEmptyObject(result) && result[0].Status == 0 && !$.isEmptyObject(result[0].Msg))
                    err_msg += '<p>' + result[0].Msg + '</p>';
                else
                    err_msg += '<p>Something went wrong..!</p>';

                $('#preloader').hide();

            } catch (e) {
                fnException(e);
            }
        }, null, true, false, false, ErrorFunction);

        if (!$.isEmptyObject(err_msg)) {
            BtpMessagePopup(err_msg, 'error');
            return false;
        }
        return true;


    } catch (e) {
        fnException(e); return false;
    }
};

//step1 save validations
function isValidStep1() {
    let err_msg = "";
    try {
        $('.FO_DTLS').removeClass('InputBorderRed');
        $('.D_T_E').removeClass('InputBorderRed');

        let regexNoSpecialChar = /^[a-zA-Z ]+$/;
        let regexNumberOnly = /[0-9]+/;
        let regexMob = /^[6789]\d{9}$/;

        let ddlDepositorsStatus = $('#lblDepositorCategory').text();
        let ApplicationType = $('[name="ApplicationType"]:Checked').val();
        let txtPhysicalApplNo = $('#txtPhysicalApplNo');
        let ddlInvtitle = $('#ddlInvtitle');
        let txtInvFirstName = $('#txtInvFirstName');
        let txtInvMiddleName = $('#txtInvMiddleName');
        let txtInvLastName = $('#txtInvLastName');
        let txtInvDOB = $('#txtInvDOB');
        let txtInvDOI = $('#txtInvDOI');
        let txtInvPan = $('#txtInvPan');
        let txtInvCKYCNumber = $('#txtInvCKYCNumber');
        let txtAmount = $('#txtAmount');
        let ddlBranch = $('#ddlBranch');

        let txtMobile = $('#txtMobile');
        let txtEmail = $('#txtEmail');
        let txtSubBrokerCode = $('#txtSubBrokerCode');
        let txtRemark = $('#txtRemark');

        if (ddlDepositorsStatus == '')
            err_msg += "<p>Depositor Status is required..!</p>";

        if ($.isEmptyObject(ApplicationType))
            err_msg += "<p>Application Type is required..!</p>";

        if ($.isEmptyObject(txtPhysicalApplNo.val())) {
            err_msg += "<p>Physical App No is required...!</p>";
            txtPhysicalApplNo.addClass('InputBorderRed');
        }

        if (ddlInvtitle.val() == 'select' || ddlInvtitle.val() == '' || ddlInvtitle.val() == null) {
            err_msg += "<p>Name Prefix is required...!</p>";
            ddlInvtitle.addClass('InputBorderRed');
        }

        if ($.isEmptyObject(txtInvFirstName.val())) {
            err_msg += "<p>First Name is required..!</p>";
            txtInvFirstName.addClass('InputBorderRed');
        }
        else if (!regexNoSpecialChar.test(txtInvFirstName.val())) {
            err_msg += "<p>First Name is not valid..!</p>";
            txtInvFirstName.addClass('InputBorderRed');
        }

        if (!$.isEmptyObject(txtInvMiddleName.val()) && !regexNoSpecialChar.test(txtInvMiddleName.val())) {
            err_msg += "<p>Middle Name is not valid..!</p>";
            txtInvMiddleName.addClass('InputBorderRed');
        }

        if (!$.isEmptyObject(txtInvLastName.val()) && !regexNoSpecialChar.test(txtInvLastName.val())) {
            err_msg += "<p>Last Name is not valid..!</p>";
            txtInvLastName.addClass('InputBorderRed');
        }

        //individual DOB
        if ($.isEmptyObject(txtInvDOB.val()) && ddlDepositorsStatus == 'INDIVIDUAL') {
            err_msg += "<p>DOB is required..!</p>";
            txtInvDOB.parent().addClass('InputBorderRed');
        }
        //non-individual DOI
        else if ($.isEmptyObject(txtInvDOI.val()) && ddlDepositorsStatus != 'INDIVIDUAL' && ddlDepositorsStatus != 'select') {
            err_msg += "<p>Date of Incorporation is required..!</p>";
            txtInvDOI.parent().addClass('InputBorderRed');
        }

        //PAN
        if (ddlDepositorsStatus == 'INDIVIDUAL' && $.isEmptyObject(txtInvPan.val()) && !IsMinor(txtInvDOB.val())) {
            err_msg += "<p>PAN is required..!</p>";
            txtInvPan.addClass('InputBorderRed');
        }
        else if (ddlDepositorsStatus != 'INDIVIDUAL' && $.isEmptyObject(txtInvPan.val())) {
            err_msg += "<p>PAN is required..!</p>";
            txtInvPan.addClass('InputBorderRed');
        }
        else if (!$.isEmptyObject(txtInvPan.val()) && !IsValidPAN(txtInvPan.val())) {
            err_msg += "<p>PAN is not valid..!</p>";
            txtInvPan.addClass('InputBorderRed');
        }
        else if (ddlDepositorsStatus == 'INDIVIDUAL' && IsValidPAN(txtInvPan.val()) && !IsMinor(txtInvDOB.val())) {
            err_msg += Check_PAN(txtInvPan.val(), txtInvDOB.val(), $('#lblApplicationNumber').text(), $('#lblFolioNumber').text().trim())
            txtInvPan.addClass('InputBorderRed');
        }
        else {
            txtInvPan.removeClass('InputBorderRed');
        }

        if (txtAmount.val().trim() == '') {
            err_msg += "<p>Amount is required..!</p>";
            txtAmount.addClass('InputBorderRed');
        }
        else if (!regexNumberOnly.test(txtAmount.val())) {
            err_msg += "<p>Amount is not valid..!</p>";
            txtAmount.addClass('InputBorderRed');
        }

        //ExtendedAjaxCall('FDConfiguration/ValidateAmount?amount=' + txtAmount.val(), null, 'GET', function (result) {

        //    if (!$.isEmptyObject(result) && result.toUpperCase() != 'SUCCESS') {
        //        err_msg += "<p>" + result + "</p>";
        //        txtAmount.addClass('InputBorderRed');
        //    }
        //}, null, null, false, false, ErrorFunction);

        if (!$.isEmptyObject(txtAmount.val()) && parseInt(txtAmount.val()) < parseInt(Min_Amount)) {
            err_msg += "<p>Amount cannot be less than " + Min_Amount + "..!</p>";
            txtAmount.addClass('InputBorderRed');
        }

        if (ddlBranch.val() == 'select') {
            err_msg += "<p>Branch is required..!</p>";
            ddlBranch.addClass('InputBorderRed');
        }

        if (txtMobile.val() == "") {
            err_msg += "<p>Please Enter Mobile Number..!</p>";
            txtMobile.addClass('InputBorderRed');
        }
        else if (!IsValidMobile(txtMobile.val())) {
            err_msg += "<p>Please Enter Valid Mobile Number..!</p>";
            txtMobile.addClass('InputBorderRed');
        }

        if (txtEmail.val() == "") {
            err_msg += "<p>Please Enter Email ID..!</p>";
            txtEmail.addClass('InputBorderRed');
        }
        else if (!IsValidEmail(txtEmail.val())) {
            err_msg += "<p>Please Enter Valid Email ID..!</p>";
            txtEmail.addClass('InputBorderRed');
        }


    } catch (e) {
        fnException(e);
    }
    return err_msg;
}

//get step1 data for save
function getStep1Data() {
    let objFrontOffice = {}
    try {
        let ddlDepositorsStatus = $('#ddlDepositorsStatus').val();
        let ApplicationType = $('[name="ApplicationType"]:Checked').val();
        let txtPhysicalApplNo = $('#txtPhysicalApplNo').val();
        let ddlInvtitle = $('#ddlInvtitle').val();
        let txtInvFirstName = $('#txtInvFirstName').val();
        let txtInvMiddleName = $('#txtInvMiddleName').val();
        let txtInvLastName = $('#txtInvLastName').val();
        let txtInvDOB = $('#txtInvDOB').val();
        let txtInvDOI = $('#txtInvDOI').val();
        let txtInvPan = $('#txtInvPan').val();
        let txtInvCKYCNumber = $('#txtInvCKYCNumber').val();
        let txtAmount = $('#txtAmount').val();
        let ddlBranch = $('#ddlBranch').val();
        //let ddlInvPayment_Mode = $('#ddlInvPayment_Mode').val();
        let txtInvDrawn_Bank_Search = $('#txtInvDrawn_Bank_Search').val();
        let hdnDrawn_Bank_Name = $('#hdnDrawn_Bank_Name').val();
        let hdnBank_Branch_Name = $('#hdnBank_Branch_Name').val();
        let hdnBank_MICR = $('#hdnBank_MICR').val();
        let hdnBank_NEFT = $('#hdnBank_NEFT').val();
        let txtInvCheque_DD_No = $('#txtInvCheque_DD_No').val();
        let txtChequeDate = $('#txtChequeDate').val();
        let ddlCMSBranch = $('#ddlCMSBranch').val();
        let txtMobile = $('#txtMobile').val();
        let txtEmail = $('#txtEmail').val();
        let txtSubBrokerCode = $('#txtSubBrokerCode').val();
        let txtRemark = $('#txtRemark').val();

        if (!$.isEmptyObject($('#lblApplicationNumber').text().trim()))
            objFrontOffice.Appl_No = $('#lblApplicationNumber').text().trim();
        else
            objFrontOffice.Copy_Appl_No = $('#hdnApplicationNumber').val();
        objFrontOffice.DepositorCategory = ddlDepositorsStatus == 'select' ? null : ddlDepositorsStatus.trim();
        objFrontOffice.ApplicationDeclarationType = ApplicationType;
        objFrontOffice.Physical = txtPhysicalApplNo.trim();
        objFrontOffice.Salutation = ddlInvtitle == 'select' ? null : ddlInvtitle.trim();
        objFrontOffice.FirstName = txtInvFirstName.trim();
        objFrontOffice.MiddleName = txtInvMiddleName.trim();
        objFrontOffice.LastName = txtInvLastName.trim();
        if (ddlDepositorsStatus == 'IND')
            objFrontOffice.DOB = txtInvDOB.trim();
        else
            objFrontOffice.DOB = txtInvDOI.trim();
        objFrontOffice.PAN = txtInvPan.trim();
        objFrontOffice.CKYCNumber = txtInvCKYCNumber.trim();
        objFrontOffice.Amount = txtAmount.trim();
        objFrontOffice.Agency_Usr_Branch_Name = ddlBranch == 'select' ? null : $('#ddlBranch option:selected').text().trim();
        objFrontOffice.Agency_Usr_Branch_Cd = ddlBranch == 'select' ? null : ddlBranch.trim();
        //objFrontOffice.ModeOfPayment = ddlInvPayment_Mode == 'select' ? null : ddlInvPayment_Mode.trim();
        objFrontOffice.BankName = hdnDrawn_Bank_Name.trim();
        objFrontOffice.BranchName = hdnBank_Branch_Name.trim();
        objFrontOffice.IFSC_Code = hdnBank_NEFT.trim();
        objFrontOffice.MICR_Code = hdnBank_MICR.trim();
        objFrontOffice.Instrument_No = txtInvCheque_DD_No.trim();
        objFrontOffice.Cheque_Date = txtChequeDate.trim();
        if (!$.isEmptyObject(ddlCMSBranch)) {
            objFrontOffice.Cms_Location_Code = ddlCMSBranch == 'select' ? null : ddlCMSBranch.trim();
            objFrontOffice.Cms_Location_Name = ddlCMSBranch == 'select' ? null : $('#ddlCMSBranch :Selected').text().trim();
        }
        objFrontOffice.Mobile = txtMobile.trim();
        objFrontOffice.Email = txtEmail.trim();
        objFrontOffice.SubBrokerCode = txtSubBrokerCode.trim();
        objFrontOffice.Remarks = txtRemark.trim();
        objFrontOffice.Existing_FDR_No = $('#lblExistingFDRNumber').text().trim();
        objFrontOffice.Folio_No = $('#lblFolioNumber').text().trim();
        objFrontOffice.Data_Source = BTP_OBJECT.FH_DATA_SOURCE;
        objFrontOffice.ApplicationType = BTP_OBJECT.ApplicationType == 'A' ? 'Existing' : 'Fresh';

        //if (EXC_CMS_MAPPING_FLAG == 1)
        //{
        //    objFrontOffice.CMSBankLocationcode = $('#hdnEXCCMSbankCode').val().trim();
        //    objFrontOffice.CMSBankLocationname = $('#txtEXCCMSbankName').val().trim();
        //}
        //else if (EXC_CMS_MAPPING_FLAG == 0)
        //{
        //    objFrontOffice.CMSBankLocationcode = $('#ddlCMSbank').val().trim();
        //    objFrontOffice.CMSBankLocationname = $('#ddlCMSbank option:selected').text().trim();
        //}
    } catch (e) {
        fnException(e);
    }
    return objFrontOffice;
}

$('#btnSearchRenewalRequest').click(function () {
    try {
        if ($.isEmptyObject($('#txtSearchFDRNo').val())
            && $.isEmptyObject($('#txtSearchFolio').val())
            && $.isEmptyObject($('#txtSearchPAN').val())
            && $.isEmptyObject($('#txtSearchDOB').val())) {
            BtpMessagePopup('Please select search criteria', 'error');
            return false;
        }

        if (!$.isEmptyObject($('#txtSearchPAN').val())
            && $.isEmptyObject($('#txtSearchDOB').val())) {
            BtpMessagePopup('Please enter DOB', 'error');
            return false;
        }

        if ($.isEmptyObject($('#txtSearchPAN').val())
            && !$.isEmptyObject($('#txtSearchDOB').val())) {
            BtpMessagePopup('Please enter PAN', 'error');
            return false;
        }

        let requestBO = {
            FDR: $('#txtSearchFDRNo').val(),
            FOLIO: $('#txtSearchFolio').val(),
            PAN: $('#txtSearchPAN').val(),
            DOB: $('#txtSearchDOB').val()
        }

        ExtendedAjaxCall('ApplicationRenewal/GET_APPLS_FOR_SearchAsync', requestBO, 'POST', function (result) {
            try {
                let htmlstr = "";
                if (!$.isEmptyObject(result) && !$.isEmptyObject(result)) {
                    $.each(result, function (i, row) {
                        htmlstr += '<tr class="text-center">';
                        if (row.ref_renw_flg) {
                            htmlstr += '<td><button type="button" class="comnBtn2" style="margin:0" onclick="Renew(this)"  value="' + $.trim(row.fdr_no) + '">Renew</button></td>';
                        }
                        else {
                            htmlstr += '<td></td>';
                        }

                        htmlstr += '<td>' + row.fdr_no + '</td>';
                        htmlstr += '<td>' + row.display_fdr_date + '</td>';
                        htmlstr += '<td>' + row.amount + '</td>';
                        htmlstr += '<td>' + row.name + '</td>';
                        htmlstr += '<td>' + row.scheme + '</td>';
                        htmlstr += '<td>' + row.tenure + '</td>';
                        htmlstr += '<td>' + row.int_rate + '</td>';
                        htmlstr += '<td>' + row.maturity_amount + '</td>';
                        htmlstr += '<td>' + row.display_maturity_date + '</td>';
                        htmlstr += '<td>' + row.ref_renw_status + '</td>';
                        htmlstr += '</tr>';
                    });
                }
                else {
                    htmlstr = '<tr style="text-align:center"><td colspan="11">The select FDR/Folio is not due for renewal</td></tr>';
                }

                $('#tblRequestData tbody').html(htmlstr);
                $('#preloader').hide();

            } catch (e) {
                fnException(e);
            }
        }, null, true, true, false, ErrorFunction);

    } catch (e) {
        fnException(e);
    }
});


$('#btnClear').click(function () {
    $('#txtSearchFDRNo').val('');
    $('#txtSearchFolio').val('');
    $('#txtSearchPAN').val('');
    $('#txtSearchDOB').datetextentry('set_date', null);
    $('#tblRequestData tbody').html('<tr style="text-align:center"><td colspan="11">No data available in table</td></tr>');

    $('#divSearch').show();
    $('#divGetDetails').hide();
});

$('#btnBack01').click(function () {
    Reset();
    $('#DV_APPL_EDIT').slideDown();
    $('#DV_DATAENTRY').slideUp();

    BindApplicationEditGrid();
});
